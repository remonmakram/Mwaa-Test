/* TASK No. 1 */

/* NONE or SET VARIABLE STATEMENT FOUND, CHECK ODI TASK NO. 1 */




/*-----------------------------------------------*/
/* TASK No. 2 */

/* SELECT STATEMENT FOUND, CHECK ODI TASK NO. 2 */




/*-----------------------------------------------*/
/* TASK No. 3 */

/* SELECT STATEMENT FOUND, CHECK ODI TASK NO. 3 */




/*-----------------------------------------------*/
/* TASK No. 4 */
/* Drop work table */

-- drop table RAX_APP_USER.C$_0SHIP_NODE_STG purge

-- &


-- /*-----------------------------------------------*/
-- /* TASK No. 5 */
-- /* Create work table */

-- create table RAX_APP_USER.C$_0SHIP_NODE_STG
-- (
-- 	C1_SHIPNODE_KEY	CHAR(24) NULL,
-- 	C2_SHIP_NODE	CHAR(24) NULL,
-- 	C3_DESCRIPTION	VARCHAR2(100) NULL,
-- 	C4_SHIPNODE_TYPE	VARCHAR2(20) NULL,
-- 	C5_DCM_INTEGRATION_REAL_TIME	CHAR(1) NULL,
-- 	C6_SERIAL_TRACKING	CHAR(1) NULL,
-- 	C7_TAG_TRACKED_IN_INVENTORY	CHAR(1) NULL,
-- 	C8_TAG_TRACKED_AT_RECEIPT	CHAR(1) NULL,
-- 	C9_INTERFACE_TYPE	VARCHAR2(20) NULL,
-- 	C10_INTERFACE_SUB_TYPE	VARCHAR2(100) NULL,
-- 	C11_GLN	VARCHAR2(40) NULL,
-- 	C12_ACTIVATE_FLAG	CHAR(1) NULL,
-- 	C13_REQUIRES_CHANGE_REQUEST	CHAR(1) NULL,
-- 	C14_SHIP_NODE_ADDRESS_KEY	CHAR(24) NULL,
-- 	C15_SUPPLIER_KEY	CHAR(24) NULL,
-- 	C16_PICKLIST_TYPE	VARCHAR2(20) NULL,
-- 	C17_TIME_DIFF	NUMBER(14,4) NULL,
-- 	C18_LATITUDE	NUMBER(11,8) NULL,
-- 	C19_LONGITUDE	NUMBER(11,8) NULL,
-- 	C20_SHIP_NODE_CLASS	VARCHAR2(40) NULL,
-- 	C21_RETURN_CENTER_FLAG	CHAR(1) NULL,
-- 	C22_ACCEPTANCE_REQUIRED	CHAR(1) NULL,
-- 	C23_GENERATE_BOL_NUMBER	CHAR(1) NULL,
-- 	C24_CURRENT_BOL_NUMBER	CHAR(35) NULL,
-- 	C25_OWNER_TYPE	CHAR(20) NULL,
-- 	C26_RECEIVING_CALENDAR_KEY	CHAR(24) NULL,
-- 	C27_SHIPPING_CALENDAR_KEY	CHAR(24) NULL,
-- 	C28_OWNER_KEY	CHAR(24) NULL,
-- 	C29_EXPORT_TAXPAYER_ID	VARCHAR2(40) NULL,
-- 	C30_EXPORT_LICENSE_NO	VARCHAR2(40) NULL,
-- 	C31_EXPORT_LICENSE_EXP_DATE	DATE NULL,
-- 	C32_INVENTORYTYPE	VARCHAR2(20) NULL,
-- 	C33_DEFAULT_DECLARED_VALUE	NUMBER(15,2) NULL,
-- 	C34_MAINTAIN_INVENTORY_COST	CHAR(1) NULL,
-- 	C35_INVENTORY_TRACKED	CHAR(1) NULL,
-- 	C36_SHIPPING_NODE	CHAR(1) NULL,
-- 	C37_RECEIVING_NODE	CHAR(1) NULL,
-- 	C38_RETURNS_NODE	CHAR(1) NULL,
-- 	C39_THREE_PL_NODE	CHAR(1) NULL,
-- 	C40_LOCALECODE	VARCHAR2(20) NULL,
-- 	C41_CONTACT_ADDRESS_KEY	CHAR(24) NULL,
-- 	C42_RECEIPT_PROCESSING_TIME	NUMBER(14,4) NULL,
-- 	C43_INHERIT_CONFIG_FROM_SHIPNO	CHAR(24) NULL,
-- 	C44_NODE_ORG_CODE	CHAR(24) NULL,
-- 	C45_MAX_DAYS_TO_SCH_BEFORE	NUMBER(5) NULL,
-- 	C46_PROCURE_TO_SHIP_ALLOWED	CHAR(1) NULL,
-- 	C47_SUBSTITUTION_ALLOWED	CHAR(1) NULL,
-- 	C48_WORK_ORDER_CREATION_ALLOWE	CHAR(1) NULL,
-- 	C49_DELAYED_INV_ALLOC_SUPPORT	CHAR(1) NULL,
-- 	C50_X_DOC_NODE	CHAR(1) NULL,
-- 	C51_USE_END_OF_SHIFT_TIME	CHAR(1) NULL,
-- 	C52_CAN_SHIP_TO_OTHER_ADDRESSE	CHAR(1) NULL,
-- 	C53_CAN_SHIP_TO_ALL_NODES	CHAR(1) NULL,
-- 	C54_NODE_TYPE	VARCHAR2(40) NULL,
-- 	C55_IDENTIFIED_BY_PARENT_AS	CHAR(24) NULL,
-- 	C56_MAX_CONCURRENT_WAVES	NUMBER(5) NULL,
-- 	C57_AGENT_CRITERIA_GROUP	VARCHAR2(40) NULL,
-- 	C58_BOL_PREFIX	VARCHAR2(2) NULL,
-- 	C59_REQUIRE_TRANSFER_ACCEPTANC	CHAR(1) NULL,
-- 	C60_LOCKID	NUMBER(5) NULL,
-- 	C61_CREATETS	DATE NULL,
-- 	C62_MODIFYTS	DATE NULL,
-- 	C63_CREATEUSERID	VARCHAR2(40) NULL,
-- 	C64_MODIFYUSERID	VARCHAR2(40) NULL,
-- 	C65_CREATEPROGID	VARCHAR2(40) NULL,
-- 	C66_MODIFYPROGID	VARCHAR2(40) NULL,
-- 	C67_RECEIVE_ADJ_RSN_CODE	VARCHAR2(40) NULL,
-- 	C68_PACK_ADJ_RSN_CODE	VARCHAR2(40) NULL,
-- 	C69_SHIP_ADJ_RSN_CODE	VARCHAR2(40) NULL,
-- 	C70_SERIAL_TRCKD_ON_TRANSFER	CHAR(1) NULL,
-- 	C71_SERIAL_TRCKD_IN_SHIPPING	CHAR(1) NULL,
-- 	C72_SERIAL_TRCKD_RECEIVING	VARCHAR2(40) NULL,
-- 	C73_RCPT_PRCSSNG_TIME_FOR_FRWR	NUMBER(14,4) NULL,
-- 	C74_ALLOW_INV_OPS_WHILE_PHY_CN	CHAR(1) NULL,
-- 	C75_IS_IBA_ALLOWED	CHAR(1) NULL,
-- 	C76_RESOURCE_PLANNING_ENABLED	CHAR(1) NULL,
-- 	C77_RESOURCE_PLANNING_UOM	VARCHAR2(40) NULL,
-- 	C78_PLANNING_CALENDAR_KEY	CHAR(24) NULL,
-- 	C79_SUPPLY_DEMAND_DIFF_THRESHO	NUMBER(5,2) NULL,
-- 	C80_DEFAULT_PERSON_DAY_HOURS	NUMBER(2) NULL,
-- 	C81_WAVE_SHORTAGE_HANDLING_TYP	VARCHAR2(40) NULL,
-- 	C82_IS_FULFILLMENT_NODE	CHAR(1) NULL,
-- 	C83_IS_YARD	CHAR(1) NULL,
-- 	C84_DOCK_SCHEDULING	VARCHAR2(20) NULL,
-- 	C85_OVER_ALLOC_ADJ_RSN_CODE	VARCHAR2(40) NULL,
-- 	C86_VOICE_APPL_INSTANCE_KEY	CHAR(24) NULL,
-- 	C87_RCPT_PRCSSNG_TIME_FOR_FUTU	NUMBER(5) NULL,
-- 	C88_IGNORE_PENDING_ALLOCATION	CHAR(1) NULL,
-- 	C89_ALLOW_GIFT_WRAP	CHAR(1) NULL
-- )
-- NOLOGGING

-- &


-- /*-----------------------------------------------*/
-- /* TASK No. 6 */
-- /* Load data */

-- /* SOURCE CODE */


-- select	
-- 	TRIM(SHIP_NODE.SHIPNODE_KEY)	   C1_SHIPNODE_KEY,
-- 	SHIP_NODE.SHIP_NODE	   C2_SHIP_NODE,
-- 	SHIP_NODE.DESCRIPTION	   C3_DESCRIPTION,
-- 	SHIP_NODE.SHIPNODE_TYPE	   C4_SHIPNODE_TYPE,
-- 	SHIP_NODE.DCM_INTEGRATION_REAL_TIME	   C5_DCM_INTEGRATION_REAL_TIME,
-- 	SHIP_NODE.SERIAL_TRACKING	   C6_SERIAL_TRACKING,
-- 	SHIP_NODE.TAG_TRACKED_IN_INVENTORY	   C7_TAG_TRACKED_IN_INVENTORY,
-- 	SHIP_NODE.TAG_TRACKED_AT_RECEIPT	   C8_TAG_TRACKED_AT_RECEIPT,
-- 	SHIP_NODE.INTERFACE_TYPE	   C9_INTERFACE_TYPE,
-- 	SHIP_NODE.INTERFACE_SUB_TYPE	   C10_INTERFACE_SUB_TYPE,
-- 	SHIP_NODE.GLN	   C11_GLN,
-- 	SHIP_NODE.ACTIVATE_FLAG	   C12_ACTIVATE_FLAG,
-- 	SHIP_NODE.REQUIRES_CHANGE_REQUEST	   C13_REQUIRES_CHANGE_REQUEST,
-- 	SHIP_NODE.SHIP_NODE_ADDRESS_KEY	   C14_SHIP_NODE_ADDRESS_KEY,
-- 	SHIP_NODE.SUPPLIER_KEY	   C15_SUPPLIER_KEY,
-- 	SHIP_NODE.PICKLIST_TYPE	   C16_PICKLIST_TYPE,
-- 	SHIP_NODE.TIME_DIFF	   C17_TIME_DIFF,
-- 	SHIP_NODE.LATITUDE	   C18_LATITUDE,
-- 	SHIP_NODE.LONGITUDE	   C19_LONGITUDE,
-- 	SHIP_NODE.SHIP_NODE_CLASS	   C20_SHIP_NODE_CLASS,
-- 	SHIP_NODE.RETURN_CENTER_FLAG	   C21_RETURN_CENTER_FLAG,
-- 	SHIP_NODE.ACCEPTANCE_REQUIRED	   C22_ACCEPTANCE_REQUIRED,
-- 	SHIP_NODE.GENERATE_BOL_NUMBER	   C23_GENERATE_BOL_NUMBER,
-- 	SHIP_NODE.CURRENT_BOL_NUMBER	   C24_CURRENT_BOL_NUMBER,
-- 	SHIP_NODE.OWNER_TYPE	   C25_OWNER_TYPE,
-- 	SHIP_NODE.RECEIVING_CALENDAR_KEY	   C26_RECEIVING_CALENDAR_KEY,
-- 	SHIP_NODE.SHIPPING_CALENDAR_KEY	   C27_SHIPPING_CALENDAR_KEY,
-- 	SHIP_NODE.OWNER_KEY	   C28_OWNER_KEY,
-- 	SHIP_NODE.EXPORT_TAXPAYER_ID	   C29_EXPORT_TAXPAYER_ID,
-- 	SHIP_NODE.EXPORT_LICENSE_NO	   C30_EXPORT_LICENSE_NO,
-- 	SHIP_NODE.EXPORT_LICENSE_EXP_DATE	   C31_EXPORT_LICENSE_EXP_DATE,
-- 	SHIP_NODE.INVENTORYTYPE	   C32_INVENTORYTYPE,
-- 	SHIP_NODE.DEFAULT_DECLARED_VALUE	   C33_DEFAULT_DECLARED_VALUE,
-- 	SHIP_NODE.MAINTAIN_INVENTORY_COST	   C34_MAINTAIN_INVENTORY_COST,
-- 	SHIP_NODE.INVENTORY_TRACKED	   C35_INVENTORY_TRACKED,
-- 	SHIP_NODE.SHIPPING_NODE	   C36_SHIPPING_NODE,
-- 	SHIP_NODE.RECEIVING_NODE	   C37_RECEIVING_NODE,
-- 	SHIP_NODE.RETURNS_NODE	   C38_RETURNS_NODE,
-- 	SHIP_NODE.THREE_PL_NODE	   C39_THREE_PL_NODE,
-- 	SHIP_NODE.LOCALECODE	   C40_LOCALECODE,
-- 	SHIP_NODE.CONTACT_ADDRESS_KEY	   C41_CONTACT_ADDRESS_KEY,
-- 	SHIP_NODE.RECEIPT_PROCESSING_TIME	   C42_RECEIPT_PROCESSING_TIME,
-- 	SHIP_NODE.INHERIT_CONFIG_FROM_SHIPNODE	   C43_INHERIT_CONFIG_FROM_SHIPNO,
-- 	SHIP_NODE.NODE_ORG_CODE	   C44_NODE_ORG_CODE,
-- 	SHIP_NODE.MAX_DAYS_TO_SCH_BEFORE	   C45_MAX_DAYS_TO_SCH_BEFORE,
-- 	SHIP_NODE.PROCURE_TO_SHIP_ALLOWED	   C46_PROCURE_TO_SHIP_ALLOWED,
-- 	SHIP_NODE.SUBSTITUTION_ALLOWED	   C47_SUBSTITUTION_ALLOWED,
-- 	SHIP_NODE.WORK_ORDER_CREATION_ALLOWED	   C48_WORK_ORDER_CREATION_ALLOWE,
-- 	SHIP_NODE.DELAYED_INV_ALLOC_SUPPORT	   C49_DELAYED_INV_ALLOC_SUPPORT,
-- 	SHIP_NODE.X_DOC_NODE	   C50_X_DOC_NODE,
-- 	SHIP_NODE.USE_END_OF_SHIFT_TIME	   C51_USE_END_OF_SHIFT_TIME,
-- 	SHIP_NODE.CAN_SHIP_TO_OTHER_ADDRESSES	   C52_CAN_SHIP_TO_OTHER_ADDRESSE,
-- 	SHIP_NODE.CAN_SHIP_TO_ALL_NODES	   C53_CAN_SHIP_TO_ALL_NODES,
-- 	SHIP_NODE.NODE_TYPE	   C54_NODE_TYPE,
-- 	SHIP_NODE.IDENTIFIED_BY_PARENT_AS	   C55_IDENTIFIED_BY_PARENT_AS,
-- 	SHIP_NODE.MAX_CONCURRENT_WAVES	   C56_MAX_CONCURRENT_WAVES,
-- 	SHIP_NODE.AGENT_CRITERIA_GROUP	   C57_AGENT_CRITERIA_GROUP,
-- 	SHIP_NODE.BOL_PREFIX	   C58_BOL_PREFIX,
-- 	SHIP_NODE.REQUIRE_TRANSFER_ACCEPTANCE	   C59_REQUIRE_TRANSFER_ACCEPTANC,
-- 	SHIP_NODE.LOCKID	   C60_LOCKID,
-- 	SHIP_NODE.CREATETS	   C61_CREATETS,
-- 	SHIP_NODE.MODIFYTS	   C62_MODIFYTS,
-- 	SHIP_NODE.CREATEUSERID	   C63_CREATEUSERID,
-- 	SHIP_NODE.MODIFYUSERID	   C64_MODIFYUSERID,
-- 	SHIP_NODE.CREATEPROGID	   C65_CREATEPROGID,
-- 	SHIP_NODE.MODIFYPROGID	   C66_MODIFYPROGID,
-- 	SHIP_NODE.RECEIVE_ADJ_RSN_CODE	   C67_RECEIVE_ADJ_RSN_CODE,
-- 	SHIP_NODE.PACK_ADJ_RSN_CODE	   C68_PACK_ADJ_RSN_CODE,
-- 	SHIP_NODE.SHIP_ADJ_RSN_CODE	   C69_SHIP_ADJ_RSN_CODE,
-- 	SHIP_NODE.SERIAL_TRCKD_ON_TRANSFER	   C70_SERIAL_TRCKD_ON_TRANSFER,
-- 	SHIP_NODE.SERIAL_TRCKD_IN_SHIPPING	   C71_SERIAL_TRCKD_IN_SHIPPING,
-- 	SHIP_NODE.SERIAL_TRCKD_RECEIVING	   C72_SERIAL_TRCKD_RECEIVING,
-- 	SHIP_NODE.RCPT_PRCSSNG_TIME_FOR_FRWRDNG	   C73_RCPT_PRCSSNG_TIME_FOR_FRWR,
-- 	SHIP_NODE.ALLOW_INV_OPS_WHILE_PHY_CNT	   C74_ALLOW_INV_OPS_WHILE_PHY_CN,
-- 	SHIP_NODE.IS_IBA_ALLOWED	   C75_IS_IBA_ALLOWED,
-- 	SHIP_NODE.RESOURCE_PLANNING_ENABLED	   C76_RESOURCE_PLANNING_ENABLED,
-- 	SHIP_NODE.RESOURCE_PLANNING_UOM	   C77_RESOURCE_PLANNING_UOM,
-- 	SHIP_NODE.PLANNING_CALENDAR_KEY	   C78_PLANNING_CALENDAR_KEY,
-- 	SHIP_NODE.SUPPLY_DEMAND_DIFF_THRESHOLD	   C79_SUPPLY_DEMAND_DIFF_THRESHO,
-- 	SHIP_NODE.DEFAULT_PERSON_DAY_HOURS	   C80_DEFAULT_PERSON_DAY_HOURS,
-- 	SHIP_NODE.WAVE_SHORTAGE_HANDLING_TYPE	   C81_WAVE_SHORTAGE_HANDLING_TYP,
-- 	SHIP_NODE.IS_FULFILLMENT_NODE	   C82_IS_FULFILLMENT_NODE,
-- 	SHIP_NODE.IS_YARD	   C83_IS_YARD,
-- 	SHIP_NODE.DOCK_SCHEDULING	   C84_DOCK_SCHEDULING,
-- 	SHIP_NODE.OVER_ALLOC_ADJ_RSN_CODE	   C85_OVER_ALLOC_ADJ_RSN_CODE,
-- 	SHIP_NODE.VOICE_APPL_INSTANCE_KEY	   C86_VOICE_APPL_INSTANCE_KEY,
-- 	SHIP_NODE.RCPT_PRCSSNG_TIME_FOR_FUTURE	   C87_RCPT_PRCSSNG_TIME_FOR_FUTU,
-- 	SHIP_NODE.IGNORE_PENDING_ALLOCATION	   C88_IGNORE_PENDING_ALLOCATION,
-- 	SHIP_NODE.ALLOW_GIFT_WRAP	   C89_ALLOW_GIFT_WRAP
-- from	OMS3_OWN.YFS_SHIP_NODE   SHIP_NODE
-- where	(1=1)
-- And (SHIP_NODE.MODIFYTS >= TO_DATE(SUBSTR(:v_cdc_load_date, 1, 19), 'YYYY-MM-DD HH24:MI:SS')  -:v_cdc_oms_overlap
-- )







-- &

-- /* TARGET CODE */
-- insert /*+ append */ into RAX_APP_USER.C$_0SHIP_NODE_STG
-- (
-- 	C1_SHIPNODE_KEY,
-- 	C2_SHIP_NODE,
-- 	C3_DESCRIPTION,
-- 	C4_SHIPNODE_TYPE,
-- 	C5_DCM_INTEGRATION_REAL_TIME,
-- 	C6_SERIAL_TRACKING,
-- 	C7_TAG_TRACKED_IN_INVENTORY,
-- 	C8_TAG_TRACKED_AT_RECEIPT,
-- 	C9_INTERFACE_TYPE,
-- 	C10_INTERFACE_SUB_TYPE,
-- 	C11_GLN,
-- 	C12_ACTIVATE_FLAG,
-- 	C13_REQUIRES_CHANGE_REQUEST,
-- 	C14_SHIP_NODE_ADDRESS_KEY,
-- 	C15_SUPPLIER_KEY,
-- 	C16_PICKLIST_TYPE,
-- 	C17_TIME_DIFF,
-- 	C18_LATITUDE,
-- 	C19_LONGITUDE,
-- 	C20_SHIP_NODE_CLASS,
-- 	C21_RETURN_CENTER_FLAG,
-- 	C22_ACCEPTANCE_REQUIRED,
-- 	C23_GENERATE_BOL_NUMBER,
-- 	C24_CURRENT_BOL_NUMBER,
-- 	C25_OWNER_TYPE,
-- 	C26_RECEIVING_CALENDAR_KEY,
-- 	C27_SHIPPING_CALENDAR_KEY,
-- 	C28_OWNER_KEY,
-- 	C29_EXPORT_TAXPAYER_ID,
-- 	C30_EXPORT_LICENSE_NO,
-- 	C31_EXPORT_LICENSE_EXP_DATE,
-- 	C32_INVENTORYTYPE,
-- 	C33_DEFAULT_DECLARED_VALUE,
-- 	C34_MAINTAIN_INVENTORY_COST,
-- 	C35_INVENTORY_TRACKED,
-- 	C36_SHIPPING_NODE,
-- 	C37_RECEIVING_NODE,
-- 	C38_RETURNS_NODE,
-- 	C39_THREE_PL_NODE,
-- 	C40_LOCALECODE,
-- 	C41_CONTACT_ADDRESS_KEY,
-- 	C42_RECEIPT_PROCESSING_TIME,
-- 	C43_INHERIT_CONFIG_FROM_SHIPNO,
-- 	C44_NODE_ORG_CODE,
-- 	C45_MAX_DAYS_TO_SCH_BEFORE,
-- 	C46_PROCURE_TO_SHIP_ALLOWED,
-- 	C47_SUBSTITUTION_ALLOWED,
-- 	C48_WORK_ORDER_CREATION_ALLOWE,
-- 	C49_DELAYED_INV_ALLOC_SUPPORT,
-- 	C50_X_DOC_NODE,
-- 	C51_USE_END_OF_SHIFT_TIME,
-- 	C52_CAN_SHIP_TO_OTHER_ADDRESSE,
-- 	C53_CAN_SHIP_TO_ALL_NODES,
-- 	C54_NODE_TYPE,
-- 	C55_IDENTIFIED_BY_PARENT_AS,
-- 	C56_MAX_CONCURRENT_WAVES,
-- 	C57_AGENT_CRITERIA_GROUP,
-- 	C58_BOL_PREFIX,
-- 	C59_REQUIRE_TRANSFER_ACCEPTANC,
-- 	C60_LOCKID,
-- 	C61_CREATETS,
-- 	C62_MODIFYTS,
-- 	C63_CREATEUSERID,
-- 	C64_MODIFYUSERID,
-- 	C65_CREATEPROGID,
-- 	C66_MODIFYPROGID,
-- 	C67_RECEIVE_ADJ_RSN_CODE,
-- 	C68_PACK_ADJ_RSN_CODE,
-- 	C69_SHIP_ADJ_RSN_CODE,
-- 	C70_SERIAL_TRCKD_ON_TRANSFER,
-- 	C71_SERIAL_TRCKD_IN_SHIPPING,
-- 	C72_SERIAL_TRCKD_RECEIVING,
-- 	C73_RCPT_PRCSSNG_TIME_FOR_FRWR,
-- 	C74_ALLOW_INV_OPS_WHILE_PHY_CN,
-- 	C75_IS_IBA_ALLOWED,
-- 	C76_RESOURCE_PLANNING_ENABLED,
-- 	C77_RESOURCE_PLANNING_UOM,
-- 	C78_PLANNING_CALENDAR_KEY,
-- 	C79_SUPPLY_DEMAND_DIFF_THRESHO,
-- 	C80_DEFAULT_PERSON_DAY_HOURS,
-- 	C81_WAVE_SHORTAGE_HANDLING_TYP,
-- 	C82_IS_FULFILLMENT_NODE,
-- 	C83_IS_YARD,
-- 	C84_DOCK_SCHEDULING,
-- 	C85_OVER_ALLOC_ADJ_RSN_CODE,
-- 	C86_VOICE_APPL_INSTANCE_KEY,
-- 	C87_RCPT_PRCSSNG_TIME_FOR_FUTU,
-- 	C88_IGNORE_PENDING_ALLOCATION,
-- 	C89_ALLOW_GIFT_WRAP
-- )
-- values
-- (
-- 	:C1_SHIPNODE_KEY,
-- 	:C2_SHIP_NODE,
-- 	:C3_DESCRIPTION,
-- 	:C4_SHIPNODE_TYPE,
-- 	:C5_DCM_INTEGRATION_REAL_TIME,
-- 	:C6_SERIAL_TRACKING,
-- 	:C7_TAG_TRACKED_IN_INVENTORY,
-- 	:C8_TAG_TRACKED_AT_RECEIPT,
-- 	:C9_INTERFACE_TYPE,
-- 	:C10_INTERFACE_SUB_TYPE,
-- 	:C11_GLN,
-- 	:C12_ACTIVATE_FLAG,
-- 	:C13_REQUIRES_CHANGE_REQUEST,
-- 	:C14_SHIP_NODE_ADDRESS_KEY,
-- 	:C15_SUPPLIER_KEY,
-- 	:C16_PICKLIST_TYPE,
-- 	:C17_TIME_DIFF,
-- 	:C18_LATITUDE,
-- 	:C19_LONGITUDE,
-- 	:C20_SHIP_NODE_CLASS,
-- 	:C21_RETURN_CENTER_FLAG,
-- 	:C22_ACCEPTANCE_REQUIRED,
-- 	:C23_GENERATE_BOL_NUMBER,
-- 	:C24_CURRENT_BOL_NUMBER,
-- 	:C25_OWNER_TYPE,
-- 	:C26_RECEIVING_CALENDAR_KEY,
-- 	:C27_SHIPPING_CALENDAR_KEY,
-- 	:C28_OWNER_KEY,
-- 	:C29_EXPORT_TAXPAYER_ID,
-- 	:C30_EXPORT_LICENSE_NO,
-- 	:C31_EXPORT_LICENSE_EXP_DATE,
-- 	:C32_INVENTORYTYPE,
-- 	:C33_DEFAULT_DECLARED_VALUE,
-- 	:C34_MAINTAIN_INVENTORY_COST,
-- 	:C35_INVENTORY_TRACKED,
-- 	:C36_SHIPPING_NODE,
-- 	:C37_RECEIVING_NODE,
-- 	:C38_RETURNS_NODE,
-- 	:C39_THREE_PL_NODE,
-- 	:C40_LOCALECODE,
-- 	:C41_CONTACT_ADDRESS_KEY,
-- 	:C42_RECEIPT_PROCESSING_TIME,
-- 	:C43_INHERIT_CONFIG_FROM_SHIPNO,
-- 	:C44_NODE_ORG_CODE,
-- 	:C45_MAX_DAYS_TO_SCH_BEFORE,
-- 	:C46_PROCURE_TO_SHIP_ALLOWED,
-- 	:C47_SUBSTITUTION_ALLOWED,
-- 	:C48_WORK_ORDER_CREATION_ALLOWE,
-- 	:C49_DELAYED_INV_ALLOC_SUPPORT,
-- 	:C50_X_DOC_NODE,
-- 	:C51_USE_END_OF_SHIFT_TIME,
-- 	:C52_CAN_SHIP_TO_OTHER_ADDRESSE,
-- 	:C53_CAN_SHIP_TO_ALL_NODES,
-- 	:C54_NODE_TYPE,
-- 	:C55_IDENTIFIED_BY_PARENT_AS,
-- 	:C56_MAX_CONCURRENT_WAVES,
-- 	:C57_AGENT_CRITERIA_GROUP,
-- 	:C58_BOL_PREFIX,
-- 	:C59_REQUIRE_TRANSFER_ACCEPTANC,
-- 	:C60_LOCKID,
-- 	:C61_CREATETS,
-- 	:C62_MODIFYTS,
-- 	:C63_CREATEUSERID,
-- 	:C64_MODIFYUSERID,
-- 	:C65_CREATEPROGID,
-- 	:C66_MODIFYPROGID,
-- 	:C67_RECEIVE_ADJ_RSN_CODE,
-- 	:C68_PACK_ADJ_RSN_CODE,
-- 	:C69_SHIP_ADJ_RSN_CODE,
-- 	:C70_SERIAL_TRCKD_ON_TRANSFER,
-- 	:C71_SERIAL_TRCKD_IN_SHIPPING,
-- 	:C72_SERIAL_TRCKD_RECEIVING,
-- 	:C73_RCPT_PRCSSNG_TIME_FOR_FRWR,
-- 	:C74_ALLOW_INV_OPS_WHILE_PHY_CN,
-- 	:C75_IS_IBA_ALLOWED,
-- 	:C76_RESOURCE_PLANNING_ENABLED,
-- 	:C77_RESOURCE_PLANNING_UOM,
-- 	:C78_PLANNING_CALENDAR_KEY,
-- 	:C79_SUPPLY_DEMAND_DIFF_THRESHO,
-- 	:C80_DEFAULT_PERSON_DAY_HOURS,
-- 	:C81_WAVE_SHORTAGE_HANDLING_TYP,
-- 	:C82_IS_FULFILLMENT_NODE,
-- 	:C83_IS_YARD,
-- 	:C84_DOCK_SCHEDULING,
-- 	:C85_OVER_ALLOC_ADJ_RSN_CODE,
-- 	:C86_VOICE_APPL_INSTANCE_KEY,
-- 	:C87_RCPT_PRCSSNG_TIME_FOR_FUTU,
-- 	:C88_IGNORE_PENDING_ALLOCATION,
-- 	:C89_ALLOW_GIFT_WRAP
-- )

-- &


/*-----------------------------------------------*/
/* TASK No. 7 */
/* Analyze work table */



BEGIN
DBMS_STATS.GATHER_TABLE_STATS (
    ownname =>	'RAX_APP_USER',
    tabname =>	'C$_0SHIP_NODE_STG',
    estimate_percent =>	DBMS_STATS.AUTO_SAMPLE_SIZE
);
END;




&


/*-----------------------------------------------*/
/* TASK No. 9 */
/* Set vID */

/* NONE or SET VARIABLE STATEMENT FOUND, CHECK ODI TASK NO. 9 */




/*-----------------------------------------------*/
/* TASK No. 10 */
/* Drop flow table */

BEGIN  
   EXECUTE IMMEDIATE 'drop table RAX_APP_USER.I$_SHIP_NODE_STG2038001';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -942 THEN  
         RAISE;  
      END IF;  
END;

&


/*-----------------------------------------------*/
/* TASK No. 11 */
/* Create flow table I$ */

create table RAX_APP_USER.I$_SHIP_NODE_STG2038001
(
	SHIPNODE_KEY	CHAR(24) NULL,
	SHIP_NODE	CHAR(24) NULL,
	DESCRIPTION	VARCHAR2(100) NULL,
	SHIPNODE_TYPE	VARCHAR2(20) NULL,
	DCM_INTEGRATION_REAL_TIME	CHAR(1) NULL,
	SERIAL_TRACKING	CHAR(1) NULL,
	TAG_TRACKED_IN_INVENTORY	CHAR(1) NULL,
	TAG_TRACKED_AT_RECEIPT	CHAR(1) NULL,
	INTERFACE_TYPE	VARCHAR2(20) NULL,
	INTERFACE_SUB_TYPE	VARCHAR2(100) NULL,
	GLN	VARCHAR2(40) NULL,
	ACTIVATE_FLAG	CHAR(1) NULL,
	REQUIRES_CHANGE_REQUEST	CHAR(1) NULL,
	SHIP_NODE_ADDRESS_KEY	CHAR(24) NULL,
	SUPPLIER_KEY	CHAR(24) NULL,
	PICKLIST_TYPE	VARCHAR2(20) NULL,
	TIME_DIFF	NUMBER(14,4) NULL,
	LATITUDE	NUMBER(11,8) NULL,
	LONGITUDE	NUMBER(11,8) NULL,
	SHIP_NODE_CLASS	VARCHAR2(40) NULL,
	RETURN_CENTER_FLAG	CHAR(1) NULL,
	ACCEPTANCE_REQUIRED	CHAR(1) NULL,
	GENERATE_BOL_NUMBER	CHAR(1) NULL,
	CURRENT_BOL_NUMBER	CHAR(35) NULL,
	OWNER_TYPE	CHAR(20) NULL,
	RECEIVING_CALENDAR_KEY	CHAR(24) NULL,
	SHIPPING_CALENDAR_KEY	CHAR(24) NULL,
	OWNER_KEY	CHAR(24) NULL,
	EXPORT_TAXPAYER_ID	VARCHAR2(40) NULL,
	EXPORT_LICENSE_NO	VARCHAR2(40) NULL,
	EXPORT_LICENSE_EXP_DATE	DATE NULL,
	INVENTORYTYPE	VARCHAR2(20) NULL,
	DEFAULT_DECLARED_VALUE	NUMBER(15,2) NULL,
	MAINTAIN_INVENTORY_COST	CHAR(1) NULL,
	INVENTORY_TRACKED	CHAR(1) NULL,
	SHIPPING_NODE	CHAR(1) NULL,
	RECEIVING_NODE	CHAR(1) NULL,
	RETURNS_NODE	CHAR(1) NULL,
	THREE_PL_NODE	CHAR(1) NULL,
	LOCALECODE	VARCHAR2(20) NULL,
	CONTACT_ADDRESS_KEY	CHAR(24) NULL,
	RECEIPT_PROCESSING_TIME	NUMBER(14,4) NULL,
	INHERIT_CONFIG_FROM_SHIPNODE	CHAR(24) NULL,
	NODE_ORG_CODE	CHAR(24) NULL,
	MAX_DAYS_TO_SCH_BEFORE	NUMBER(5) NULL,
	PROCURE_TO_SHIP_ALLOWED	CHAR(1) NULL,
	SUBSTITUTION_ALLOWED	CHAR(1) NULL,
	WORK_ORDER_CREATION_ALLOWED	CHAR(1) NULL,
	DELAYED_INV_ALLOC_SUPPORT	CHAR(1) NULL,
	X_DOC_NODE	CHAR(1) NULL,
	USE_END_OF_SHIFT_TIME	CHAR(1) NULL,
	CAN_SHIP_TO_OTHER_ADDRESSES	CHAR(1) NULL,
	CAN_SHIP_TO_ALL_NODES	CHAR(1) NULL,
	NODE_TYPE	VARCHAR2(40) NULL,
	IDENTIFIED_BY_PARENT_AS	CHAR(24) NULL,
	MAX_CONCURRENT_WAVES	NUMBER(5) NULL,
	AGENT_CRITERIA_GROUP	VARCHAR2(40) NULL,
	BOL_PREFIX	VARCHAR2(2) NULL,
	REQUIRE_TRANSFER_ACCEPTANCE	CHAR(1) NULL,
	LOCKID	NUMBER(5) NULL,
	CREATETS	DATE NULL,
	MODIFYTS	DATE NULL,
	CREATEUSERID	VARCHAR2(40) NULL,
	MODIFYUSERID	VARCHAR2(40) NULL,
	CREATEPROGID	VARCHAR2(40) NULL,
	MODIFYPROGID	VARCHAR2(40) NULL,
	RECEIVE_ADJ_RSN_CODE	VARCHAR2(40) NULL,
	PACK_ADJ_RSN_CODE	VARCHAR2(40) NULL,
	SHIP_ADJ_RSN_CODE	VARCHAR2(40) NULL,
	SERIAL_TRCKD_ON_TRANSFER	CHAR(1) NULL,
	SERIAL_TRCKD_IN_SHIPPING	CHAR(1) NULL,
	SERIAL_TRCKD_RECEIVING	VARCHAR2(40) NULL,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG	NUMBER(14,4) NULL,
	ALLOW_INV_OPS_WHILE_PHY_CNT	CHAR(1) NULL,
	IS_IBA_ALLOWED	CHAR(1) NULL,
	RESOURCE_PLANNING_ENABLED	CHAR(1) NULL,
	RESOURCE_PLANNING_UOM	VARCHAR2(40) NULL,
	PLANNING_CALENDAR_KEY	CHAR(24) NULL,
	SUPPLY_DEMAND_DIFF_THRESHOLD	NUMBER(5,2) NULL,
	DEFAULT_PERSON_DAY_HOURS	NUMBER(2) NULL,
	WAVE_SHORTAGE_HANDLING_TYPE	VARCHAR2(40) NULL,
	IS_FULFILLMENT_NODE	CHAR(1) NULL,
	IS_YARD	CHAR(1) NULL,
	DOCK_SCHEDULING	VARCHAR2(20) NULL,
	OVER_ALLOC_ADJ_RSN_CODE	VARCHAR2(40) NULL,
	VOICE_APPL_INSTANCE_KEY	CHAR(24) NULL,
	RCPT_PRCSSNG_TIME_FOR_FUTURE	NUMBER(5) NULL,
	IGNORE_PENDING_ALLOCATION	CHAR(1) NULL,
	ALLOW_GIFT_WRAP	CHAR(1) NULL,
	ODS_CREATE_DATE	DATE NULL,
	ODS_MODIFY_DATE	DATE NULL
	,IND_UPDATE		char(1)
)
NOLOGGING

&


/*-----------------------------------------------*/
/* TASK No. 12 */
/* Insert flow into I$ table */

/* DETECTION_STRATEGY = NOT_EXISTS */
 


  


insert into	RAX_APP_USER.I$_SHIP_NODE_STG2038001
(
	SHIPNODE_KEY,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	IND_UPDATE
)
select 
SHIPNODE_KEY,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	IND_UPDATE
 from (


select 	 
	
	C1_SHIPNODE_KEY SHIPNODE_KEY,
	C2_SHIP_NODE SHIP_NODE,
	C3_DESCRIPTION DESCRIPTION,
	C4_SHIPNODE_TYPE SHIPNODE_TYPE,
	C5_DCM_INTEGRATION_REAL_TIME DCM_INTEGRATION_REAL_TIME,
	C6_SERIAL_TRACKING SERIAL_TRACKING,
	C7_TAG_TRACKED_IN_INVENTORY TAG_TRACKED_IN_INVENTORY,
	C8_TAG_TRACKED_AT_RECEIPT TAG_TRACKED_AT_RECEIPT,
	C9_INTERFACE_TYPE INTERFACE_TYPE,
	C10_INTERFACE_SUB_TYPE INTERFACE_SUB_TYPE,
	C11_GLN GLN,
	C12_ACTIVATE_FLAG ACTIVATE_FLAG,
	C13_REQUIRES_CHANGE_REQUEST REQUIRES_CHANGE_REQUEST,
	C14_SHIP_NODE_ADDRESS_KEY SHIP_NODE_ADDRESS_KEY,
	C15_SUPPLIER_KEY SUPPLIER_KEY,
	C16_PICKLIST_TYPE PICKLIST_TYPE,
	C17_TIME_DIFF TIME_DIFF,
	C18_LATITUDE LATITUDE,
	C19_LONGITUDE LONGITUDE,
	C20_SHIP_NODE_CLASS SHIP_NODE_CLASS,
	C21_RETURN_CENTER_FLAG RETURN_CENTER_FLAG,
	C22_ACCEPTANCE_REQUIRED ACCEPTANCE_REQUIRED,
	C23_GENERATE_BOL_NUMBER GENERATE_BOL_NUMBER,
	C24_CURRENT_BOL_NUMBER CURRENT_BOL_NUMBER,
	C25_OWNER_TYPE OWNER_TYPE,
	C26_RECEIVING_CALENDAR_KEY RECEIVING_CALENDAR_KEY,
	C27_SHIPPING_CALENDAR_KEY SHIPPING_CALENDAR_KEY,
	C28_OWNER_KEY OWNER_KEY,
	C29_EXPORT_TAXPAYER_ID EXPORT_TAXPAYER_ID,
	C30_EXPORT_LICENSE_NO EXPORT_LICENSE_NO,
	C31_EXPORT_LICENSE_EXP_DATE EXPORT_LICENSE_EXP_DATE,
	C32_INVENTORYTYPE INVENTORYTYPE,
	C33_DEFAULT_DECLARED_VALUE DEFAULT_DECLARED_VALUE,
	C34_MAINTAIN_INVENTORY_COST MAINTAIN_INVENTORY_COST,
	C35_INVENTORY_TRACKED INVENTORY_TRACKED,
	C36_SHIPPING_NODE SHIPPING_NODE,
	C37_RECEIVING_NODE RECEIVING_NODE,
	C38_RETURNS_NODE RETURNS_NODE,
	C39_THREE_PL_NODE THREE_PL_NODE,
	C40_LOCALECODE LOCALECODE,
	C41_CONTACT_ADDRESS_KEY CONTACT_ADDRESS_KEY,
	C42_RECEIPT_PROCESSING_TIME RECEIPT_PROCESSING_TIME,
	C43_INHERIT_CONFIG_FROM_SHIPNO INHERIT_CONFIG_FROM_SHIPNODE,
	C44_NODE_ORG_CODE NODE_ORG_CODE,
	C45_MAX_DAYS_TO_SCH_BEFORE MAX_DAYS_TO_SCH_BEFORE,
	C46_PROCURE_TO_SHIP_ALLOWED PROCURE_TO_SHIP_ALLOWED,
	C47_SUBSTITUTION_ALLOWED SUBSTITUTION_ALLOWED,
	C48_WORK_ORDER_CREATION_ALLOWE WORK_ORDER_CREATION_ALLOWED,
	C49_DELAYED_INV_ALLOC_SUPPORT DELAYED_INV_ALLOC_SUPPORT,
	C50_X_DOC_NODE X_DOC_NODE,
	C51_USE_END_OF_SHIFT_TIME USE_END_OF_SHIFT_TIME,
	C52_CAN_SHIP_TO_OTHER_ADDRESSE CAN_SHIP_TO_OTHER_ADDRESSES,
	C53_CAN_SHIP_TO_ALL_NODES CAN_SHIP_TO_ALL_NODES,
	C54_NODE_TYPE NODE_TYPE,
	C55_IDENTIFIED_BY_PARENT_AS IDENTIFIED_BY_PARENT_AS,
	C56_MAX_CONCURRENT_WAVES MAX_CONCURRENT_WAVES,
	C57_AGENT_CRITERIA_GROUP AGENT_CRITERIA_GROUP,
	C58_BOL_PREFIX BOL_PREFIX,
	C59_REQUIRE_TRANSFER_ACCEPTANC REQUIRE_TRANSFER_ACCEPTANCE,
	C60_LOCKID LOCKID,
	C61_CREATETS CREATETS,
	C62_MODIFYTS MODIFYTS,
	C63_CREATEUSERID CREATEUSERID,
	C64_MODIFYUSERID MODIFYUSERID,
	C65_CREATEPROGID CREATEPROGID,
	C66_MODIFYPROGID MODIFYPROGID,
	C67_RECEIVE_ADJ_RSN_CODE RECEIVE_ADJ_RSN_CODE,
	C68_PACK_ADJ_RSN_CODE PACK_ADJ_RSN_CODE,
	C69_SHIP_ADJ_RSN_CODE SHIP_ADJ_RSN_CODE,
	C70_SERIAL_TRCKD_ON_TRANSFER SERIAL_TRCKD_ON_TRANSFER,
	C71_SERIAL_TRCKD_IN_SHIPPING SERIAL_TRCKD_IN_SHIPPING,
	C72_SERIAL_TRCKD_RECEIVING SERIAL_TRCKD_RECEIVING,
	C73_RCPT_PRCSSNG_TIME_FOR_FRWR RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	C74_ALLOW_INV_OPS_WHILE_PHY_CN ALLOW_INV_OPS_WHILE_PHY_CNT,
	C75_IS_IBA_ALLOWED IS_IBA_ALLOWED,
	C76_RESOURCE_PLANNING_ENABLED RESOURCE_PLANNING_ENABLED,
	C77_RESOURCE_PLANNING_UOM RESOURCE_PLANNING_UOM,
	C78_PLANNING_CALENDAR_KEY PLANNING_CALENDAR_KEY,
	C79_SUPPLY_DEMAND_DIFF_THRESHO SUPPLY_DEMAND_DIFF_THRESHOLD,
	C80_DEFAULT_PERSON_DAY_HOURS DEFAULT_PERSON_DAY_HOURS,
	C81_WAVE_SHORTAGE_HANDLING_TYP WAVE_SHORTAGE_HANDLING_TYPE,
	C82_IS_FULFILLMENT_NODE IS_FULFILLMENT_NODE,
	C83_IS_YARD IS_YARD,
	C84_DOCK_SCHEDULING DOCK_SCHEDULING,
	C85_OVER_ALLOC_ADJ_RSN_CODE OVER_ALLOC_ADJ_RSN_CODE,
	C86_VOICE_APPL_INSTANCE_KEY VOICE_APPL_INSTANCE_KEY,
	C87_RCPT_PRCSSNG_TIME_FOR_FUTU RCPT_PRCSSNG_TIME_FOR_FUTURE,
	C88_IGNORE_PENDING_ALLOCATION IGNORE_PENDING_ALLOCATION,
	C89_ALLOW_GIFT_WRAP ALLOW_GIFT_WRAP,

	'I' IND_UPDATE

from	RAX_APP_USER.C$_0SHIP_NODE_STG
where	(1=1)






) S
where NOT EXISTS 
	( select 1 from ODS_STAGE.OMS3_SHIP_NODE_STG T
	where	T.SHIPNODE_KEY	= S.SHIPNODE_KEY 
		 and ((T.SHIP_NODE = S.SHIP_NODE) or (T.SHIP_NODE IS NULL and S.SHIP_NODE IS NULL)) and
		((T.DESCRIPTION = S.DESCRIPTION) or (T.DESCRIPTION IS NULL and S.DESCRIPTION IS NULL)) and
		((T.SHIPNODE_TYPE = S.SHIPNODE_TYPE) or (T.SHIPNODE_TYPE IS NULL and S.SHIPNODE_TYPE IS NULL)) and
		((T.DCM_INTEGRATION_REAL_TIME = S.DCM_INTEGRATION_REAL_TIME) or (T.DCM_INTEGRATION_REAL_TIME IS NULL and S.DCM_INTEGRATION_REAL_TIME IS NULL)) and
		((T.SERIAL_TRACKING = S.SERIAL_TRACKING) or (T.SERIAL_TRACKING IS NULL and S.SERIAL_TRACKING IS NULL)) and
		((T.TAG_TRACKED_IN_INVENTORY = S.TAG_TRACKED_IN_INVENTORY) or (T.TAG_TRACKED_IN_INVENTORY IS NULL and S.TAG_TRACKED_IN_INVENTORY IS NULL)) and
		((T.TAG_TRACKED_AT_RECEIPT = S.TAG_TRACKED_AT_RECEIPT) or (T.TAG_TRACKED_AT_RECEIPT IS NULL and S.TAG_TRACKED_AT_RECEIPT IS NULL)) and
		((T.INTERFACE_TYPE = S.INTERFACE_TYPE) or (T.INTERFACE_TYPE IS NULL and S.INTERFACE_TYPE IS NULL)) and
		((T.INTERFACE_SUB_TYPE = S.INTERFACE_SUB_TYPE) or (T.INTERFACE_SUB_TYPE IS NULL and S.INTERFACE_SUB_TYPE IS NULL)) and
		((T.GLN = S.GLN) or (T.GLN IS NULL and S.GLN IS NULL)) and
		((T.ACTIVATE_FLAG = S.ACTIVATE_FLAG) or (T.ACTIVATE_FLAG IS NULL and S.ACTIVATE_FLAG IS NULL)) and
		((T.REQUIRES_CHANGE_REQUEST = S.REQUIRES_CHANGE_REQUEST) or (T.REQUIRES_CHANGE_REQUEST IS NULL and S.REQUIRES_CHANGE_REQUEST IS NULL)) and
		((T.SHIP_NODE_ADDRESS_KEY = S.SHIP_NODE_ADDRESS_KEY) or (T.SHIP_NODE_ADDRESS_KEY IS NULL and S.SHIP_NODE_ADDRESS_KEY IS NULL)) and
		((T.SUPPLIER_KEY = S.SUPPLIER_KEY) or (T.SUPPLIER_KEY IS NULL and S.SUPPLIER_KEY IS NULL)) and
		((T.PICKLIST_TYPE = S.PICKLIST_TYPE) or (T.PICKLIST_TYPE IS NULL and S.PICKLIST_TYPE IS NULL)) and
		((T.TIME_DIFF = S.TIME_DIFF) or (T.TIME_DIFF IS NULL and S.TIME_DIFF IS NULL)) and
		((T.LATITUDE = S.LATITUDE) or (T.LATITUDE IS NULL and S.LATITUDE IS NULL)) and
		((T.LONGITUDE = S.LONGITUDE) or (T.LONGITUDE IS NULL and S.LONGITUDE IS NULL)) and
		((T.SHIP_NODE_CLASS = S.SHIP_NODE_CLASS) or (T.SHIP_NODE_CLASS IS NULL and S.SHIP_NODE_CLASS IS NULL)) and
		((T.RETURN_CENTER_FLAG = S.RETURN_CENTER_FLAG) or (T.RETURN_CENTER_FLAG IS NULL and S.RETURN_CENTER_FLAG IS NULL)) and
		((T.ACCEPTANCE_REQUIRED = S.ACCEPTANCE_REQUIRED) or (T.ACCEPTANCE_REQUIRED IS NULL and S.ACCEPTANCE_REQUIRED IS NULL)) and
		((T.GENERATE_BOL_NUMBER = S.GENERATE_BOL_NUMBER) or (T.GENERATE_BOL_NUMBER IS NULL and S.GENERATE_BOL_NUMBER IS NULL)) and
		((T.CURRENT_BOL_NUMBER = S.CURRENT_BOL_NUMBER) or (T.CURRENT_BOL_NUMBER IS NULL and S.CURRENT_BOL_NUMBER IS NULL)) and
		((T.OWNER_TYPE = S.OWNER_TYPE) or (T.OWNER_TYPE IS NULL and S.OWNER_TYPE IS NULL)) and
		((T.RECEIVING_CALENDAR_KEY = S.RECEIVING_CALENDAR_KEY) or (T.RECEIVING_CALENDAR_KEY IS NULL and S.RECEIVING_CALENDAR_KEY IS NULL)) and
		((T.SHIPPING_CALENDAR_KEY = S.SHIPPING_CALENDAR_KEY) or (T.SHIPPING_CALENDAR_KEY IS NULL and S.SHIPPING_CALENDAR_KEY IS NULL)) and
		((T.OWNER_KEY = S.OWNER_KEY) or (T.OWNER_KEY IS NULL and S.OWNER_KEY IS NULL)) and
		((T.EXPORT_TAXPAYER_ID = S.EXPORT_TAXPAYER_ID) or (T.EXPORT_TAXPAYER_ID IS NULL and S.EXPORT_TAXPAYER_ID IS NULL)) and
		((T.EXPORT_LICENSE_NO = S.EXPORT_LICENSE_NO) or (T.EXPORT_LICENSE_NO IS NULL and S.EXPORT_LICENSE_NO IS NULL)) and
		((T.EXPORT_LICENSE_EXP_DATE = S.EXPORT_LICENSE_EXP_DATE) or (T.EXPORT_LICENSE_EXP_DATE IS NULL and S.EXPORT_LICENSE_EXP_DATE IS NULL)) and
		((T.INVENTORYTYPE = S.INVENTORYTYPE) or (T.INVENTORYTYPE IS NULL and S.INVENTORYTYPE IS NULL)) and
		((T.DEFAULT_DECLARED_VALUE = S.DEFAULT_DECLARED_VALUE) or (T.DEFAULT_DECLARED_VALUE IS NULL and S.DEFAULT_DECLARED_VALUE IS NULL)) and
		((T.MAINTAIN_INVENTORY_COST = S.MAINTAIN_INVENTORY_COST) or (T.MAINTAIN_INVENTORY_COST IS NULL and S.MAINTAIN_INVENTORY_COST IS NULL)) and
		((T.INVENTORY_TRACKED = S.INVENTORY_TRACKED) or (T.INVENTORY_TRACKED IS NULL and S.INVENTORY_TRACKED IS NULL)) and
		((T.SHIPPING_NODE = S.SHIPPING_NODE) or (T.SHIPPING_NODE IS NULL and S.SHIPPING_NODE IS NULL)) and
		((T.RECEIVING_NODE = S.RECEIVING_NODE) or (T.RECEIVING_NODE IS NULL and S.RECEIVING_NODE IS NULL)) and
		((T.RETURNS_NODE = S.RETURNS_NODE) or (T.RETURNS_NODE IS NULL and S.RETURNS_NODE IS NULL)) and
		((T.THREE_PL_NODE = S.THREE_PL_NODE) or (T.THREE_PL_NODE IS NULL and S.THREE_PL_NODE IS NULL)) and
		((T.LOCALECODE = S.LOCALECODE) or (T.LOCALECODE IS NULL and S.LOCALECODE IS NULL)) and
		((T.CONTACT_ADDRESS_KEY = S.CONTACT_ADDRESS_KEY) or (T.CONTACT_ADDRESS_KEY IS NULL and S.CONTACT_ADDRESS_KEY IS NULL)) and
		((T.RECEIPT_PROCESSING_TIME = S.RECEIPT_PROCESSING_TIME) or (T.RECEIPT_PROCESSING_TIME IS NULL and S.RECEIPT_PROCESSING_TIME IS NULL)) and
		((T.INHERIT_CONFIG_FROM_SHIPNODE = S.INHERIT_CONFIG_FROM_SHIPNODE) or (T.INHERIT_CONFIG_FROM_SHIPNODE IS NULL and S.INHERIT_CONFIG_FROM_SHIPNODE IS NULL)) and
		((T.NODE_ORG_CODE = S.NODE_ORG_CODE) or (T.NODE_ORG_CODE IS NULL and S.NODE_ORG_CODE IS NULL)) and
		((T.MAX_DAYS_TO_SCH_BEFORE = S.MAX_DAYS_TO_SCH_BEFORE) or (T.MAX_DAYS_TO_SCH_BEFORE IS NULL and S.MAX_DAYS_TO_SCH_BEFORE IS NULL)) and
		((T.PROCURE_TO_SHIP_ALLOWED = S.PROCURE_TO_SHIP_ALLOWED) or (T.PROCURE_TO_SHIP_ALLOWED IS NULL and S.PROCURE_TO_SHIP_ALLOWED IS NULL)) and
		((T.SUBSTITUTION_ALLOWED = S.SUBSTITUTION_ALLOWED) or (T.SUBSTITUTION_ALLOWED IS NULL and S.SUBSTITUTION_ALLOWED IS NULL)) and
		((T.WORK_ORDER_CREATION_ALLOWED = S.WORK_ORDER_CREATION_ALLOWED) or (T.WORK_ORDER_CREATION_ALLOWED IS NULL and S.WORK_ORDER_CREATION_ALLOWED IS NULL)) and
		((T.DELAYED_INV_ALLOC_SUPPORT = S.DELAYED_INV_ALLOC_SUPPORT) or (T.DELAYED_INV_ALLOC_SUPPORT IS NULL and S.DELAYED_INV_ALLOC_SUPPORT IS NULL)) and
		((T.X_DOC_NODE = S.X_DOC_NODE) or (T.X_DOC_NODE IS NULL and S.X_DOC_NODE IS NULL)) and
		((T.USE_END_OF_SHIFT_TIME = S.USE_END_OF_SHIFT_TIME) or (T.USE_END_OF_SHIFT_TIME IS NULL and S.USE_END_OF_SHIFT_TIME IS NULL)) and
		((T.CAN_SHIP_TO_OTHER_ADDRESSES = S.CAN_SHIP_TO_OTHER_ADDRESSES) or (T.CAN_SHIP_TO_OTHER_ADDRESSES IS NULL and S.CAN_SHIP_TO_OTHER_ADDRESSES IS NULL)) and
		((T.CAN_SHIP_TO_ALL_NODES = S.CAN_SHIP_TO_ALL_NODES) or (T.CAN_SHIP_TO_ALL_NODES IS NULL and S.CAN_SHIP_TO_ALL_NODES IS NULL)) and
		((T.NODE_TYPE = S.NODE_TYPE) or (T.NODE_TYPE IS NULL and S.NODE_TYPE IS NULL)) and
		((T.IDENTIFIED_BY_PARENT_AS = S.IDENTIFIED_BY_PARENT_AS) or (T.IDENTIFIED_BY_PARENT_AS IS NULL and S.IDENTIFIED_BY_PARENT_AS IS NULL)) and
		((T.MAX_CONCURRENT_WAVES = S.MAX_CONCURRENT_WAVES) or (T.MAX_CONCURRENT_WAVES IS NULL and S.MAX_CONCURRENT_WAVES IS NULL)) and
		((T.AGENT_CRITERIA_GROUP = S.AGENT_CRITERIA_GROUP) or (T.AGENT_CRITERIA_GROUP IS NULL and S.AGENT_CRITERIA_GROUP IS NULL)) and
		((T.BOL_PREFIX = S.BOL_PREFIX) or (T.BOL_PREFIX IS NULL and S.BOL_PREFIX IS NULL)) and
		((T.REQUIRE_TRANSFER_ACCEPTANCE = S.REQUIRE_TRANSFER_ACCEPTANCE) or (T.REQUIRE_TRANSFER_ACCEPTANCE IS NULL and S.REQUIRE_TRANSFER_ACCEPTANCE IS NULL)) and
		((T.LOCKID = S.LOCKID) or (T.LOCKID IS NULL and S.LOCKID IS NULL)) and
		((T.CREATETS = S.CREATETS) or (T.CREATETS IS NULL and S.CREATETS IS NULL)) and
		((T.MODIFYTS = S.MODIFYTS) or (T.MODIFYTS IS NULL and S.MODIFYTS IS NULL)) and
		((T.CREATEUSERID = S.CREATEUSERID) or (T.CREATEUSERID IS NULL and S.CREATEUSERID IS NULL)) and
		((T.MODIFYUSERID = S.MODIFYUSERID) or (T.MODIFYUSERID IS NULL and S.MODIFYUSERID IS NULL)) and
		((T.CREATEPROGID = S.CREATEPROGID) or (T.CREATEPROGID IS NULL and S.CREATEPROGID IS NULL)) and
		((T.MODIFYPROGID = S.MODIFYPROGID) or (T.MODIFYPROGID IS NULL and S.MODIFYPROGID IS NULL)) and
		((T.RECEIVE_ADJ_RSN_CODE = S.RECEIVE_ADJ_RSN_CODE) or (T.RECEIVE_ADJ_RSN_CODE IS NULL and S.RECEIVE_ADJ_RSN_CODE IS NULL)) and
		((T.PACK_ADJ_RSN_CODE = S.PACK_ADJ_RSN_CODE) or (T.PACK_ADJ_RSN_CODE IS NULL and S.PACK_ADJ_RSN_CODE IS NULL)) and
		((T.SHIP_ADJ_RSN_CODE = S.SHIP_ADJ_RSN_CODE) or (T.SHIP_ADJ_RSN_CODE IS NULL and S.SHIP_ADJ_RSN_CODE IS NULL)) and
		((T.SERIAL_TRCKD_ON_TRANSFER = S.SERIAL_TRCKD_ON_TRANSFER) or (T.SERIAL_TRCKD_ON_TRANSFER IS NULL and S.SERIAL_TRCKD_ON_TRANSFER IS NULL)) and
		((T.SERIAL_TRCKD_IN_SHIPPING = S.SERIAL_TRCKD_IN_SHIPPING) or (T.SERIAL_TRCKD_IN_SHIPPING IS NULL and S.SERIAL_TRCKD_IN_SHIPPING IS NULL)) and
		((T.SERIAL_TRCKD_RECEIVING = S.SERIAL_TRCKD_RECEIVING) or (T.SERIAL_TRCKD_RECEIVING IS NULL and S.SERIAL_TRCKD_RECEIVING IS NULL)) and
		((T.RCPT_PRCSSNG_TIME_FOR_FRWRDNG = S.RCPT_PRCSSNG_TIME_FOR_FRWRDNG) or (T.RCPT_PRCSSNG_TIME_FOR_FRWRDNG IS NULL and S.RCPT_PRCSSNG_TIME_FOR_FRWRDNG IS NULL)) and
		((T.ALLOW_INV_OPS_WHILE_PHY_CNT = S.ALLOW_INV_OPS_WHILE_PHY_CNT) or (T.ALLOW_INV_OPS_WHILE_PHY_CNT IS NULL and S.ALLOW_INV_OPS_WHILE_PHY_CNT IS NULL)) and
		((T.IS_IBA_ALLOWED = S.IS_IBA_ALLOWED) or (T.IS_IBA_ALLOWED IS NULL and S.IS_IBA_ALLOWED IS NULL)) and
		((T.RESOURCE_PLANNING_ENABLED = S.RESOURCE_PLANNING_ENABLED) or (T.RESOURCE_PLANNING_ENABLED IS NULL and S.RESOURCE_PLANNING_ENABLED IS NULL)) and
		((T.RESOURCE_PLANNING_UOM = S.RESOURCE_PLANNING_UOM) or (T.RESOURCE_PLANNING_UOM IS NULL and S.RESOURCE_PLANNING_UOM IS NULL)) and
		((T.PLANNING_CALENDAR_KEY = S.PLANNING_CALENDAR_KEY) or (T.PLANNING_CALENDAR_KEY IS NULL and S.PLANNING_CALENDAR_KEY IS NULL)) and
		((T.SUPPLY_DEMAND_DIFF_THRESHOLD = S.SUPPLY_DEMAND_DIFF_THRESHOLD) or (T.SUPPLY_DEMAND_DIFF_THRESHOLD IS NULL and S.SUPPLY_DEMAND_DIFF_THRESHOLD IS NULL)) and
		((T.DEFAULT_PERSON_DAY_HOURS = S.DEFAULT_PERSON_DAY_HOURS) or (T.DEFAULT_PERSON_DAY_HOURS IS NULL and S.DEFAULT_PERSON_DAY_HOURS IS NULL)) and
		((T.WAVE_SHORTAGE_HANDLING_TYPE = S.WAVE_SHORTAGE_HANDLING_TYPE) or (T.WAVE_SHORTAGE_HANDLING_TYPE IS NULL and S.WAVE_SHORTAGE_HANDLING_TYPE IS NULL)) and
		((T.IS_FULFILLMENT_NODE = S.IS_FULFILLMENT_NODE) or (T.IS_FULFILLMENT_NODE IS NULL and S.IS_FULFILLMENT_NODE IS NULL)) and
		((T.IS_YARD = S.IS_YARD) or (T.IS_YARD IS NULL and S.IS_YARD IS NULL)) and
		((T.DOCK_SCHEDULING = S.DOCK_SCHEDULING) or (T.DOCK_SCHEDULING IS NULL and S.DOCK_SCHEDULING IS NULL)) and
		((T.OVER_ALLOC_ADJ_RSN_CODE = S.OVER_ALLOC_ADJ_RSN_CODE) or (T.OVER_ALLOC_ADJ_RSN_CODE IS NULL and S.OVER_ALLOC_ADJ_RSN_CODE IS NULL)) and
		((T.VOICE_APPL_INSTANCE_KEY = S.VOICE_APPL_INSTANCE_KEY) or (T.VOICE_APPL_INSTANCE_KEY IS NULL and S.VOICE_APPL_INSTANCE_KEY IS NULL)) and
		((T.RCPT_PRCSSNG_TIME_FOR_FUTURE = S.RCPT_PRCSSNG_TIME_FOR_FUTURE) or (T.RCPT_PRCSSNG_TIME_FOR_FUTURE IS NULL and S.RCPT_PRCSSNG_TIME_FOR_FUTURE IS NULL)) and
		((T.IGNORE_PENDING_ALLOCATION = S.IGNORE_PENDING_ALLOCATION) or (T.IGNORE_PENDING_ALLOCATION IS NULL and S.IGNORE_PENDING_ALLOCATION IS NULL)) and
		((T.ALLOW_GIFT_WRAP = S.ALLOW_GIFT_WRAP) or (T.ALLOW_GIFT_WRAP IS NULL and S.ALLOW_GIFT_WRAP IS NULL))
        )

  
  

  



&


/*-----------------------------------------------*/
/* TASK No. 13 */
/* Analyze integration table */



begin
    dbms_stats.gather_table_stats(
	ownname => 'RAX_APP_USER',
	tabname => 'I$_SHIP_NODE_STG2038001',
	estimate_percent => dbms_stats.auto_sample_size
    );
end;



&


/*-----------------------------------------------*/
/* TASK No. 14 */
/* Create Index on flow table */

create index	RAX_APP_USER.I$_SHIP_NODE_STG_IDX2038001
on		RAX_APP_USER.I$_SHIP_NODE_STG2038001 (SHIPNODE_KEY)
NOLOGGING

&


/*-----------------------------------------------*/
/* TASK No. 15 */
/* create check table */


BEGIN  
   EXECUTE IMMEDIATE 'create table RAX_APP_USER.SNP_CHECK_TAB
						(
							CATALOG_NAME	VARCHAR2(100 CHAR) NULL ,
							SCHEMA_NAME	VARCHAR2(100 CHAR) NULL ,
							RESOURCE_NAME	VARCHAR2(100 CHAR) NULL,
							FULL_RES_NAME	VARCHAR2(100 CHAR) NULL,
							ERR_TYPE		VARCHAR2(1 CHAR) NULL,
							ERR_MESS		VARCHAR2(250 CHAR) NULL ,
							CHECK_DATE	DATE NULL,
							ORIGIN		VARCHAR2(100 CHAR) NULL,
							CONS_NAME	VARCHAR2(35 CHAR) NULL,
							CONS_TYPE		VARCHAR2(2 CHAR) NULL,
							ERR_COUNT		NUMBER(10) NULL
						)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 THEN  
         RAISE;  
      END IF;  
END;
	

&


/*-----------------------------------------------*/
/* TASK No. 16 */
/* delete previous check sum */

delete from	RAX_APP_USER.SNP_CHECK_TAB
where	SCHEMA_NAME	= 'ODS_STAGE'
and	ORIGIN 		= '(2038001)ODS_Project.LOAD_OMS3_SHIP_NODE_STG'
and	ERR_TYPE 		= 'F'


&


/*-----------------------------------------------*/
/* TASK No. 17 */
/* create error table */


BEGIN  
   EXECUTE IMMEDIATE 'create table RAX_APP_USER.E$_SHIP_NODE_STG2038001
						(
							ODI_ROW_ID 		UROWID,
							ODI_ERR_TYPE		VARCHAR2(1 CHAR) NULL, 
							ODI_ERR_MESS		VARCHAR2(250 CHAR) NULL,
							ODI_CHECK_DATE	DATE NULL, 
							SHIPNODE_KEY	CHAR(24) NULL,
							SHIP_NODE	CHAR(24) NULL,
							DESCRIPTION	VARCHAR2(100) NULL,
							SHIPNODE_TYPE	VARCHAR2(20) NULL,
							DCM_INTEGRATION_REAL_TIME	CHAR(1) NULL,
							SERIAL_TRACKING	CHAR(1) NULL,
							TAG_TRACKED_IN_INVENTORY	CHAR(1) NULL,
							TAG_TRACKED_AT_RECEIPT	CHAR(1) NULL,
							INTERFACE_TYPE	VARCHAR2(20) NULL,
							INTERFACE_SUB_TYPE	VARCHAR2(100) NULL,
							GLN	VARCHAR2(40) NULL,
							ACTIVATE_FLAG	CHAR(1) NULL,
							REQUIRES_CHANGE_REQUEST	CHAR(1) NULL,
							SHIP_NODE_ADDRESS_KEY	CHAR(24) NULL,
							SUPPLIER_KEY	CHAR(24) NULL,
							PICKLIST_TYPE	VARCHAR2(20) NULL,
							TIME_DIFF	NUMBER(14,4) NULL,
							LATITUDE	NUMBER(11,8) NULL,
							LONGITUDE	NUMBER(11,8) NULL,
							SHIP_NODE_CLASS	VARCHAR2(40) NULL,
							RETURN_CENTER_FLAG	CHAR(1) NULL,
							ACCEPTANCE_REQUIRED	CHAR(1) NULL,
							GENERATE_BOL_NUMBER	CHAR(1) NULL,
							CURRENT_BOL_NUMBER	CHAR(35) NULL,
							OWNER_TYPE	CHAR(20) NULL,
							RECEIVING_CALENDAR_KEY	CHAR(24) NULL,
							SHIPPING_CALENDAR_KEY	CHAR(24) NULL,
							OWNER_KEY	CHAR(24) NULL,
							EXPORT_TAXPAYER_ID	VARCHAR2(40) NULL,
							EXPORT_LICENSE_NO	VARCHAR2(40) NULL,
							EXPORT_LICENSE_EXP_DATE	DATE NULL,
							INVENTORYTYPE	VARCHAR2(20) NULL,
							DEFAULT_DECLARED_VALUE	NUMBER(15,2) NULL,
							MAINTAIN_INVENTORY_COST	CHAR(1) NULL,
							INVENTORY_TRACKED	CHAR(1) NULL,
							SHIPPING_NODE	CHAR(1) NULL,
							RECEIVING_NODE	CHAR(1) NULL,
							RETURNS_NODE	CHAR(1) NULL,
							THREE_PL_NODE	CHAR(1) NULL,
							LOCALECODE	VARCHAR2(20) NULL,
							CONTACT_ADDRESS_KEY	CHAR(24) NULL,
							RECEIPT_PROCESSING_TIME	NUMBER(14,4) NULL,
							INHERIT_CONFIG_FROM_SHIPNODE	CHAR(24) NULL,
							NODE_ORG_CODE	CHAR(24) NULL,
							MAX_DAYS_TO_SCH_BEFORE	NUMBER(5) NULL,
							PROCURE_TO_SHIP_ALLOWED	CHAR(1) NULL,
							SUBSTITUTION_ALLOWED	CHAR(1) NULL,
							WORK_ORDER_CREATION_ALLOWED	CHAR(1) NULL,
							DELAYED_INV_ALLOC_SUPPORT	CHAR(1) NULL,
							X_DOC_NODE	CHAR(1) NULL,
							USE_END_OF_SHIFT_TIME	CHAR(1) NULL,
							CAN_SHIP_TO_OTHER_ADDRESSES	CHAR(1) NULL,
							CAN_SHIP_TO_ALL_NODES	CHAR(1) NULL,
							NODE_TYPE	VARCHAR2(40) NULL,
							IDENTIFIED_BY_PARENT_AS	CHAR(24) NULL,
							MAX_CONCURRENT_WAVES	NUMBER(5) NULL,
							AGENT_CRITERIA_GROUP	VARCHAR2(40) NULL,
							BOL_PREFIX	VARCHAR2(2) NULL,
							REQUIRE_TRANSFER_ACCEPTANCE	CHAR(1) NULL,
							LOCKID	NUMBER(5) NULL,
							CREATETS	DATE NULL,
							MODIFYTS	DATE NULL,
							CREATEUSERID	VARCHAR2(40) NULL,
							MODIFYUSERID	VARCHAR2(40) NULL,
							CREATEPROGID	VARCHAR2(40) NULL,
							MODIFYPROGID	VARCHAR2(40) NULL,
							RECEIVE_ADJ_RSN_CODE	VARCHAR2(40) NULL,
							PACK_ADJ_RSN_CODE	VARCHAR2(40) NULL,
							SHIP_ADJ_RSN_CODE	VARCHAR2(40) NULL,
							SERIAL_TRCKD_ON_TRANSFER	CHAR(1) NULL,
							SERIAL_TRCKD_IN_SHIPPING	CHAR(1) NULL,
							SERIAL_TRCKD_RECEIVING	VARCHAR2(40) NULL,
							RCPT_PRCSSNG_TIME_FOR_FRWRDNG	NUMBER(14,4) NULL,
							ALLOW_INV_OPS_WHILE_PHY_CNT	CHAR(1) NULL,
							IS_IBA_ALLOWED	CHAR(1) NULL,
							RESOURCE_PLANNING_ENABLED	CHAR(1) NULL,
							RESOURCE_PLANNING_UOM	VARCHAR2(40) NULL,
							PLANNING_CALENDAR_KEY	CHAR(24) NULL,
							SUPPLY_DEMAND_DIFF_THRESHOLD	NUMBER(5,2) NULL,
							DEFAULT_PERSON_DAY_HOURS	NUMBER(2) NULL,
							WAVE_SHORTAGE_HANDLING_TYPE	VARCHAR2(40) NULL,
							IS_FULFILLMENT_NODE	CHAR(1) NULL,
							IS_YARD	CHAR(1) NULL,
							DOCK_SCHEDULING	VARCHAR2(20) NULL,
							OVER_ALLOC_ADJ_RSN_CODE	VARCHAR2(40) NULL,
							VOICE_APPL_INSTANCE_KEY	CHAR(24) NULL,
							RCPT_PRCSSNG_TIME_FOR_FUTURE	NUMBER(5) NULL,
							IGNORE_PENDING_ALLOCATION	CHAR(1) NULL,
							ALLOW_GIFT_WRAP	CHAR(1) NULL,
							ODS_CREATE_DATE	DATE NULL,
							ODS_MODIFY_DATE	DATE NULL,
							ODI_ORIGIN		VARCHAR2(100 CHAR) NULL,
							ODI_CONS_NAME	VARCHAR2(35 CHAR) NULL,
							ODI_CONS_TYPE		VARCHAR2(2 CHAR) NULL,
							ODI_PK			VARCHAR2(32 CHAR) PRIMARY KEY,
							ODI_SESS_NO		VARCHAR2(19 CHAR)
						)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 THEN  
         RAISE;  
      END IF;  
END;


&


/*-----------------------------------------------*/
/* TASK No. 18 */
/* delete previous errors */

delete from 	RAX_APP_USER.E$_SHIP_NODE_STG2038001
where	(ODI_ERR_TYPE = 'S'	and 'F' = 'S')
or	(ODI_ERR_TYPE = 'F'	and ODI_ORIGIN = '(2038001)ODS_Project.LOAD_OMS3_SHIP_NODE_STG')


&


/*-----------------------------------------------*/
/* TASK No. 19 */
/* insert Not Null errors */

insert into RAX_APP_USER.E$_SHIP_NODE_STG2038001
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	SHIPNODE_KEY,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE
)
select
	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15066: The column SHIPNODE_KEY cannot be null.',
	sysdate,
	'(2038001)ODS_Project.LOAD_OMS3_SHIP_NODE_STG',
	'SHIPNODE_KEY',
	'NN',	
	SHIPNODE_KEY,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE
from	RAX_APP_USER.I$_SHIP_NODE_STG2038001
where	SHIPNODE_KEY is null



&


/*-----------------------------------------------*/
/* TASK No. 20 */
/* create index on error table */

 
/* FLOW CONTROL CREATE INDEX ON THE E$TABLE */
BEGIN  
   EXECUTE IMMEDIATE 'create index 	RAX_APP_USER.E$_SHIP_NODE_STG2038001 on	RAX_APP_USER.E$_SHIP_NODE_STG2038001 (ODI_ROW_ID)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 and SQLCODE != -01408 THEN
         RAISE;  
      END IF;  
END;


&


/*-----------------------------------------------*/
/* TASK No. 21 */
/* delete errors from controlled table */

delete from	RAX_APP_USER.I$_SHIP_NODE_STG2038001  T
where	exists 	(
		select	1
		from	RAX_APP_USER.E$_SHIP_NODE_STG2038001 E
		where ODI_SESS_NO = :v_sess_no
		and T.rowid = E.ODI_ROW_ID
		)


&


/*-----------------------------------------------*/
/* TASK No. 22 */
/* insert check sum into check table */

insert into RAX_APP_USER.SNP_CHECK_TAB
(
	SCHEMA_NAME,
	RESOURCE_NAME,
	FULL_RES_NAME,
	ERR_TYPE,
	ERR_MESS,
	CHECK_DATE,
	ORIGIN,
	CONS_NAME,
	CONS_TYPE,
	ERR_COUNT
)
select	
	'ODS_STAGE',
	'SHIP_NODE_STG',
	'ODS_STAGE.OMS3_SHIP_NODE_STG2038001',
	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE,
	count(1) 
from	RAX_APP_USER.E$_SHIP_NODE_STG2038001 E
where	E.ODI_ERR_TYPE	= 'F'
and	E.ODI_ORIGIN 	= '(2038001)ODS_Project.LOAD_OMS3_SHIP_NODE_STG'
group by	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE


&


/*-----------------------------------------------*/
/* TASK No. 23 */
/* Merge Rows */

merge into	ODS_STAGE.OMS3_SHIP_NODE_STG T
using	RAX_APP_USER.I$_SHIP_NODE_STG2038001 S
on	(
		T.SHIPNODE_KEY=S.SHIPNODE_KEY
	)
when matched
then update set
	T.SHIP_NODE	= S.SHIP_NODE,
	T.DESCRIPTION	= S.DESCRIPTION,
	T.SHIPNODE_TYPE	= S.SHIPNODE_TYPE,
	T.DCM_INTEGRATION_REAL_TIME	= S.DCM_INTEGRATION_REAL_TIME,
	T.SERIAL_TRACKING	= S.SERIAL_TRACKING,
	T.TAG_TRACKED_IN_INVENTORY	= S.TAG_TRACKED_IN_INVENTORY,
	T.TAG_TRACKED_AT_RECEIPT	= S.TAG_TRACKED_AT_RECEIPT,
	T.INTERFACE_TYPE	= S.INTERFACE_TYPE,
	T.INTERFACE_SUB_TYPE	= S.INTERFACE_SUB_TYPE,
	T.GLN	= S.GLN,
	T.ACTIVATE_FLAG	= S.ACTIVATE_FLAG,
	T.REQUIRES_CHANGE_REQUEST	= S.REQUIRES_CHANGE_REQUEST,
	T.SHIP_NODE_ADDRESS_KEY	= S.SHIP_NODE_ADDRESS_KEY,
	T.SUPPLIER_KEY	= S.SUPPLIER_KEY,
	T.PICKLIST_TYPE	= S.PICKLIST_TYPE,
	T.TIME_DIFF	= S.TIME_DIFF,
	T.LATITUDE	= S.LATITUDE,
	T.LONGITUDE	= S.LONGITUDE,
	T.SHIP_NODE_CLASS	= S.SHIP_NODE_CLASS,
	T.RETURN_CENTER_FLAG	= S.RETURN_CENTER_FLAG,
	T.ACCEPTANCE_REQUIRED	= S.ACCEPTANCE_REQUIRED,
	T.GENERATE_BOL_NUMBER	= S.GENERATE_BOL_NUMBER,
	T.CURRENT_BOL_NUMBER	= S.CURRENT_BOL_NUMBER,
	T.OWNER_TYPE	= S.OWNER_TYPE,
	T.RECEIVING_CALENDAR_KEY	= S.RECEIVING_CALENDAR_KEY,
	T.SHIPPING_CALENDAR_KEY	= S.SHIPPING_CALENDAR_KEY,
	T.OWNER_KEY	= S.OWNER_KEY,
	T.EXPORT_TAXPAYER_ID	= S.EXPORT_TAXPAYER_ID,
	T.EXPORT_LICENSE_NO	= S.EXPORT_LICENSE_NO,
	T.EXPORT_LICENSE_EXP_DATE	= S.EXPORT_LICENSE_EXP_DATE,
	T.INVENTORYTYPE	= S.INVENTORYTYPE,
	T.DEFAULT_DECLARED_VALUE	= S.DEFAULT_DECLARED_VALUE,
	T.MAINTAIN_INVENTORY_COST	= S.MAINTAIN_INVENTORY_COST,
	T.INVENTORY_TRACKED	= S.INVENTORY_TRACKED,
	T.SHIPPING_NODE	= S.SHIPPING_NODE,
	T.RECEIVING_NODE	= S.RECEIVING_NODE,
	T.RETURNS_NODE	= S.RETURNS_NODE,
	T.THREE_PL_NODE	= S.THREE_PL_NODE,
	T.LOCALECODE	= S.LOCALECODE,
	T.CONTACT_ADDRESS_KEY	= S.CONTACT_ADDRESS_KEY,
	T.RECEIPT_PROCESSING_TIME	= S.RECEIPT_PROCESSING_TIME,
	T.INHERIT_CONFIG_FROM_SHIPNODE	= S.INHERIT_CONFIG_FROM_SHIPNODE,
	T.NODE_ORG_CODE	= S.NODE_ORG_CODE,
	T.MAX_DAYS_TO_SCH_BEFORE	= S.MAX_DAYS_TO_SCH_BEFORE,
	T.PROCURE_TO_SHIP_ALLOWED	= S.PROCURE_TO_SHIP_ALLOWED,
	T.SUBSTITUTION_ALLOWED	= S.SUBSTITUTION_ALLOWED,
	T.WORK_ORDER_CREATION_ALLOWED	= S.WORK_ORDER_CREATION_ALLOWED,
	T.DELAYED_INV_ALLOC_SUPPORT	= S.DELAYED_INV_ALLOC_SUPPORT,
	T.X_DOC_NODE	= S.X_DOC_NODE,
	T.USE_END_OF_SHIFT_TIME	= S.USE_END_OF_SHIFT_TIME,
	T.CAN_SHIP_TO_OTHER_ADDRESSES	= S.CAN_SHIP_TO_OTHER_ADDRESSES,
	T.CAN_SHIP_TO_ALL_NODES	= S.CAN_SHIP_TO_ALL_NODES,
	T.NODE_TYPE	= S.NODE_TYPE,
	T.IDENTIFIED_BY_PARENT_AS	= S.IDENTIFIED_BY_PARENT_AS,
	T.MAX_CONCURRENT_WAVES	= S.MAX_CONCURRENT_WAVES,
	T.AGENT_CRITERIA_GROUP	= S.AGENT_CRITERIA_GROUP,
	T.BOL_PREFIX	= S.BOL_PREFIX,
	T.REQUIRE_TRANSFER_ACCEPTANCE	= S.REQUIRE_TRANSFER_ACCEPTANCE,
	T.LOCKID	= S.LOCKID,
	T.CREATETS	= S.CREATETS,
	T.MODIFYTS	= S.MODIFYTS,
	T.CREATEUSERID	= S.CREATEUSERID,
	T.MODIFYUSERID	= S.MODIFYUSERID,
	T.CREATEPROGID	= S.CREATEPROGID,
	T.MODIFYPROGID	= S.MODIFYPROGID,
	T.RECEIVE_ADJ_RSN_CODE	= S.RECEIVE_ADJ_RSN_CODE,
	T.PACK_ADJ_RSN_CODE	= S.PACK_ADJ_RSN_CODE,
	T.SHIP_ADJ_RSN_CODE	= S.SHIP_ADJ_RSN_CODE,
	T.SERIAL_TRCKD_ON_TRANSFER	= S.SERIAL_TRCKD_ON_TRANSFER,
	T.SERIAL_TRCKD_IN_SHIPPING	= S.SERIAL_TRCKD_IN_SHIPPING,
	T.SERIAL_TRCKD_RECEIVING	= S.SERIAL_TRCKD_RECEIVING,
	T.RCPT_PRCSSNG_TIME_FOR_FRWRDNG	= S.RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	T.ALLOW_INV_OPS_WHILE_PHY_CNT	= S.ALLOW_INV_OPS_WHILE_PHY_CNT,
	T.IS_IBA_ALLOWED	= S.IS_IBA_ALLOWED,
	T.RESOURCE_PLANNING_ENABLED	= S.RESOURCE_PLANNING_ENABLED,
	T.RESOURCE_PLANNING_UOM	= S.RESOURCE_PLANNING_UOM,
	T.PLANNING_CALENDAR_KEY	= S.PLANNING_CALENDAR_KEY,
	T.SUPPLY_DEMAND_DIFF_THRESHOLD	= S.SUPPLY_DEMAND_DIFF_THRESHOLD,
	T.DEFAULT_PERSON_DAY_HOURS	= S.DEFAULT_PERSON_DAY_HOURS,
	T.WAVE_SHORTAGE_HANDLING_TYPE	= S.WAVE_SHORTAGE_HANDLING_TYPE,
	T.IS_FULFILLMENT_NODE	= S.IS_FULFILLMENT_NODE,
	T.IS_YARD	= S.IS_YARD,
	T.DOCK_SCHEDULING	= S.DOCK_SCHEDULING,
	T.OVER_ALLOC_ADJ_RSN_CODE	= S.OVER_ALLOC_ADJ_RSN_CODE,
	T.VOICE_APPL_INSTANCE_KEY	= S.VOICE_APPL_INSTANCE_KEY,
	T.RCPT_PRCSSNG_TIME_FOR_FUTURE	= S.RCPT_PRCSSNG_TIME_FOR_FUTURE,
	T.IGNORE_PENDING_ALLOCATION	= S.IGNORE_PENDING_ALLOCATION,
	T.ALLOW_GIFT_WRAP	= S.ALLOW_GIFT_WRAP
	,                                                                                        T.ODS_MODIFY_DATE	= SYSDATE
when not matched
then insert
	(
	T.SHIPNODE_KEY,
	T.SHIP_NODE,
	T.DESCRIPTION,
	T.SHIPNODE_TYPE,
	T.DCM_INTEGRATION_REAL_TIME,
	T.SERIAL_TRACKING,
	T.TAG_TRACKED_IN_INVENTORY,
	T.TAG_TRACKED_AT_RECEIPT,
	T.INTERFACE_TYPE,
	T.INTERFACE_SUB_TYPE,
	T.GLN,
	T.ACTIVATE_FLAG,
	T.REQUIRES_CHANGE_REQUEST,
	T.SHIP_NODE_ADDRESS_KEY,
	T.SUPPLIER_KEY,
	T.PICKLIST_TYPE,
	T.TIME_DIFF,
	T.LATITUDE,
	T.LONGITUDE,
	T.SHIP_NODE_CLASS,
	T.RETURN_CENTER_FLAG,
	T.ACCEPTANCE_REQUIRED,
	T.GENERATE_BOL_NUMBER,
	T.CURRENT_BOL_NUMBER,
	T.OWNER_TYPE,
	T.RECEIVING_CALENDAR_KEY,
	T.SHIPPING_CALENDAR_KEY,
	T.OWNER_KEY,
	T.EXPORT_TAXPAYER_ID,
	T.EXPORT_LICENSE_NO,
	T.EXPORT_LICENSE_EXP_DATE,
	T.INVENTORYTYPE,
	T.DEFAULT_DECLARED_VALUE,
	T.MAINTAIN_INVENTORY_COST,
	T.INVENTORY_TRACKED,
	T.SHIPPING_NODE,
	T.RECEIVING_NODE,
	T.RETURNS_NODE,
	T.THREE_PL_NODE,
	T.LOCALECODE,
	T.CONTACT_ADDRESS_KEY,
	T.RECEIPT_PROCESSING_TIME,
	T.INHERIT_CONFIG_FROM_SHIPNODE,
	T.NODE_ORG_CODE,
	T.MAX_DAYS_TO_SCH_BEFORE,
	T.PROCURE_TO_SHIP_ALLOWED,
	T.SUBSTITUTION_ALLOWED,
	T.WORK_ORDER_CREATION_ALLOWED,
	T.DELAYED_INV_ALLOC_SUPPORT,
	T.X_DOC_NODE,
	T.USE_END_OF_SHIFT_TIME,
	T.CAN_SHIP_TO_OTHER_ADDRESSES,
	T.CAN_SHIP_TO_ALL_NODES,
	T.NODE_TYPE,
	T.IDENTIFIED_BY_PARENT_AS,
	T.MAX_CONCURRENT_WAVES,
	T.AGENT_CRITERIA_GROUP,
	T.BOL_PREFIX,
	T.REQUIRE_TRANSFER_ACCEPTANCE,
	T.LOCKID,
	T.CREATETS,
	T.MODIFYTS,
	T.CREATEUSERID,
	T.MODIFYUSERID,
	T.CREATEPROGID,
	T.MODIFYPROGID,
	T.RECEIVE_ADJ_RSN_CODE,
	T.PACK_ADJ_RSN_CODE,
	T.SHIP_ADJ_RSN_CODE,
	T.SERIAL_TRCKD_ON_TRANSFER,
	T.SERIAL_TRCKD_IN_SHIPPING,
	T.SERIAL_TRCKD_RECEIVING,
	T.RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	T.ALLOW_INV_OPS_WHILE_PHY_CNT,
	T.IS_IBA_ALLOWED,
	T.RESOURCE_PLANNING_ENABLED,
	T.RESOURCE_PLANNING_UOM,
	T.PLANNING_CALENDAR_KEY,
	T.SUPPLY_DEMAND_DIFF_THRESHOLD,
	T.DEFAULT_PERSON_DAY_HOURS,
	T.WAVE_SHORTAGE_HANDLING_TYPE,
	T.IS_FULFILLMENT_NODE,
	T.IS_YARD,
	T.DOCK_SCHEDULING,
	T.OVER_ALLOC_ADJ_RSN_CODE,
	T.VOICE_APPL_INSTANCE_KEY,
	T.RCPT_PRCSSNG_TIME_FOR_FUTURE,
	T.IGNORE_PENDING_ALLOCATION,
	T.ALLOW_GIFT_WRAP
	,                                                                                         T.ODS_CREATE_DATE,
	T.ODS_MODIFY_DATE
	)
values
	(
	S.SHIPNODE_KEY,
	S.SHIP_NODE,
	S.DESCRIPTION,
	S.SHIPNODE_TYPE,
	S.DCM_INTEGRATION_REAL_TIME,
	S.SERIAL_TRACKING,
	S.TAG_TRACKED_IN_INVENTORY,
	S.TAG_TRACKED_AT_RECEIPT,
	S.INTERFACE_TYPE,
	S.INTERFACE_SUB_TYPE,
	S.GLN,
	S.ACTIVATE_FLAG,
	S.REQUIRES_CHANGE_REQUEST,
	S.SHIP_NODE_ADDRESS_KEY,
	S.SUPPLIER_KEY,
	S.PICKLIST_TYPE,
	S.TIME_DIFF,
	S.LATITUDE,
	S.LONGITUDE,
	S.SHIP_NODE_CLASS,
	S.RETURN_CENTER_FLAG,
	S.ACCEPTANCE_REQUIRED,
	S.GENERATE_BOL_NUMBER,
	S.CURRENT_BOL_NUMBER,
	S.OWNER_TYPE,
	S.RECEIVING_CALENDAR_KEY,
	S.SHIPPING_CALENDAR_KEY,
	S.OWNER_KEY,
	S.EXPORT_TAXPAYER_ID,
	S.EXPORT_LICENSE_NO,
	S.EXPORT_LICENSE_EXP_DATE,
	S.INVENTORYTYPE,
	S.DEFAULT_DECLARED_VALUE,
	S.MAINTAIN_INVENTORY_COST,
	S.INVENTORY_TRACKED,
	S.SHIPPING_NODE,
	S.RECEIVING_NODE,
	S.RETURNS_NODE,
	S.THREE_PL_NODE,
	S.LOCALECODE,
	S.CONTACT_ADDRESS_KEY,
	S.RECEIPT_PROCESSING_TIME,
	S.INHERIT_CONFIG_FROM_SHIPNODE,
	S.NODE_ORG_CODE,
	S.MAX_DAYS_TO_SCH_BEFORE,
	S.PROCURE_TO_SHIP_ALLOWED,
	S.SUBSTITUTION_ALLOWED,
	S.WORK_ORDER_CREATION_ALLOWED,
	S.DELAYED_INV_ALLOC_SUPPORT,
	S.X_DOC_NODE,
	S.USE_END_OF_SHIFT_TIME,
	S.CAN_SHIP_TO_OTHER_ADDRESSES,
	S.CAN_SHIP_TO_ALL_NODES,
	S.NODE_TYPE,
	S.IDENTIFIED_BY_PARENT_AS,
	S.MAX_CONCURRENT_WAVES,
	S.AGENT_CRITERIA_GROUP,
	S.BOL_PREFIX,
	S.REQUIRE_TRANSFER_ACCEPTANCE,
	S.LOCKID,
	S.CREATETS,
	S.MODIFYTS,
	S.CREATEUSERID,
	S.MODIFYUSERID,
	S.CREATEPROGID,
	S.MODIFYPROGID,
	S.RECEIVE_ADJ_RSN_CODE,
	S.PACK_ADJ_RSN_CODE,
	S.SHIP_ADJ_RSN_CODE,
	S.SERIAL_TRCKD_ON_TRANSFER,
	S.SERIAL_TRCKD_IN_SHIPPING,
	S.SERIAL_TRCKD_RECEIVING,
	S.RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	S.ALLOW_INV_OPS_WHILE_PHY_CNT,
	S.IS_IBA_ALLOWED,
	S.RESOURCE_PLANNING_ENABLED,
	S.RESOURCE_PLANNING_UOM,
	S.PLANNING_CALENDAR_KEY,
	S.SUPPLY_DEMAND_DIFF_THRESHOLD,
	S.DEFAULT_PERSON_DAY_HOURS,
	S.WAVE_SHORTAGE_HANDLING_TYPE,
	S.IS_FULFILLMENT_NODE,
	S.IS_YARD,
	S.DOCK_SCHEDULING,
	S.OVER_ALLOC_ADJ_RSN_CODE,
	S.VOICE_APPL_INSTANCE_KEY,
	S.RCPT_PRCSSNG_TIME_FOR_FUTURE,
	S.IGNORE_PENDING_ALLOCATION,
	S.ALLOW_GIFT_WRAP
	,                                                                                         SYSDATE,
	SYSDATE
	)

&


/*-----------------------------------------------*/
/* TASK No. 24 */
/* Commit transaction */

/*commit*/


/*-----------------------------------------------*/
/* TASK No. 25 */
/* Drop flow table */

drop table RAX_APP_USER.I$_SHIP_NODE_STG2038001 

&


/*-----------------------------------------------*/
/* TASK No. 1000008 */
/* Drop work table */

BEGIN  
   EXECUTE IMMEDIATE 'drop table RAX_APP_USER.C$_0SHIP_NODE_STG purge';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -942 THEN  
         RAISE;  
      END IF;  
END;

&


/*-----------------------------------------------*/
/* TASK No. 26 */
/* Set vID */

/* NONE or SET VARIABLE STATEMENT FOUND, CHECK ODI TASK NO. 26 */




/*-----------------------------------------------*/
/* TASK No. 27 */
/* Drop flow table */

BEGIN  
   EXECUTE IMMEDIATE 'drop table RAX_APP_USER.I$_SHIP_NODE_XR2039001';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -942 THEN  
         RAISE;  
      END IF;  
END;

&


/*-----------------------------------------------*/
/* TASK No. 28 */
/* Create flow table I$ */

create table RAX_APP_USER.I$_SHIP_NODE_XR2039001
(
	SHIP_NODE_OID	NUMBER NULL,
	SHIPNODE_KEY	CHAR(24) NULL,
	CONTACT_ADDRESS_KEY	CHAR(24) NULL,
	ODS_CREATE_DATE	DATE NULL,
	ODS_MODIFY_DATE	DATE NULL
	,IND_UPDATE		char(1)
)
NOLOGGING

&


/*-----------------------------------------------*/
/* TASK No. 29 */
/* Insert flow into I$ table */

/* DETECTION_STRATEGY = NOT_EXISTS */
 


  


insert into	RAX_APP_USER.I$_SHIP_NODE_XR2039001
(
	SHIPNODE_KEY,
	CONTACT_ADDRESS_KEY,
	IND_UPDATE
)
select 
SHIPNODE_KEY,
	CONTACT_ADDRESS_KEY,
	IND_UPDATE
 from (


select 	 
	
	TRIM(SHIP_NODE_STG.SHIPNODE_KEY) SHIPNODE_KEY,
	SHIP_NODE_STG.CONTACT_ADDRESS_KEY CONTACT_ADDRESS_KEY,

	'I' IND_UPDATE

from	ODS_STAGE.OMS3_SHIP_NODE_STG   SHIP_NODE_STG
where	(1=1)

And (SHIP_NODE_STG.MODIFYTS >= TO_DATE(SUBSTR(:v_cdc_load_date, 1, 19), 'YYYY-MM-DD HH24:MI:SS')  - :v_cdc_oms_overlap)




) S
where NOT EXISTS 
	( select 1 from ODS_STAGE.OMS3_SHIP_NODE_XR T
	where	T.SHIPNODE_KEY	= S.SHIPNODE_KEY 
		 and ((T.CONTACT_ADDRESS_KEY = S.CONTACT_ADDRESS_KEY) or (T.CONTACT_ADDRESS_KEY IS NULL and S.CONTACT_ADDRESS_KEY IS NULL))
        )

  
  

  



&


/*-----------------------------------------------*/
/* TASK No. 30 */
/* Analyze integration table */



begin
    dbms_stats.gather_table_stats(
	ownname => 'RAX_APP_USER',
	tabname => 'I$_SHIP_NODE_XR2039001',
	estimate_percent => dbms_stats.auto_sample_size
    );
end;



&


/*-----------------------------------------------*/
/* TASK No. 31 */
/* Create Index on flow table */

create index	RAX_APP_USER.I$_SHIP_NODE_XR_IDX2039001
on		RAX_APP_USER.I$_SHIP_NODE_XR2039001 (SHIPNODE_KEY)
NOLOGGING

&


/*-----------------------------------------------*/
/* TASK No. 32 */
/* create check table */


BEGIN  
   EXECUTE IMMEDIATE 'create table RAX_APP_USER.SNP_CHECK_TAB
						(
							CATALOG_NAME	VARCHAR2(100 CHAR) NULL ,
							SCHEMA_NAME	VARCHAR2(100 CHAR) NULL ,
							RESOURCE_NAME	VARCHAR2(100 CHAR) NULL,
							FULL_RES_NAME	VARCHAR2(100 CHAR) NULL,
							ERR_TYPE		VARCHAR2(1 CHAR) NULL,
							ERR_MESS		VARCHAR2(250 CHAR) NULL ,
							CHECK_DATE	DATE NULL,
							ORIGIN		VARCHAR2(100 CHAR) NULL,
							CONS_NAME	VARCHAR2(35 CHAR) NULL,
							CONS_TYPE		VARCHAR2(2 CHAR) NULL,
							ERR_COUNT		NUMBER(10) NULL
						)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 THEN  
         RAISE;  
      END IF;  
END;
	

&


/*-----------------------------------------------*/
/* TASK No. 33 */
/* delete previous check sum */

delete from	RAX_APP_USER.SNP_CHECK_TAB
where	SCHEMA_NAME	= 'ODS_STAGE'
and	ORIGIN 		= '(2039001)ODS_Project.LOAD_OMS3_SHIP_NODE_XR_INT'
and	ERR_TYPE 		= 'F'


&


/*-----------------------------------------------*/
/* TASK No. 34 */
/* create error table */


BEGIN  
   EXECUTE IMMEDIATE 'create table RAX_APP_USER.E$_SHIP_NODE_XR2039001
						(
							ODI_ROW_ID 		UROWID,
							ODI_ERR_TYPE		VARCHAR2(1 CHAR) NULL, 
							ODI_ERR_MESS		VARCHAR2(250 CHAR) NULL,
							ODI_CHECK_DATE	DATE NULL, 
							SHIP_NODE_OID	NUMBER NULL,
							SHIPNODE_KEY	CHAR(24) NULL,
							CONTACT_ADDRESS_KEY	CHAR(24) NULL,
							ODS_CREATE_DATE	DATE NULL,
							ODS_MODIFY_DATE	DATE NULL,
							ODI_ORIGIN		VARCHAR2(100 CHAR) NULL,
							ODI_CONS_NAME	VARCHAR2(35 CHAR) NULL,
							ODI_CONS_TYPE		VARCHAR2(2 CHAR) NULL,
							ODI_PK			VARCHAR2(32 CHAR) PRIMARY KEY,
							ODI_SESS_NO		VARCHAR2(19 CHAR)
						)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 THEN  
         RAISE;  
      END IF;  
END;



&


/*-----------------------------------------------*/
/* TASK No. 35 */
/* delete previous errors */

delete from 	RAX_APP_USER.E$_SHIP_NODE_XR2039001
where	(ODI_ERR_TYPE = 'S'	and 'F' = 'S')
or	(ODI_ERR_TYPE = 'F'	and ODI_ORIGIN = '(2039001)ODS_Project.LOAD_OMS3_SHIP_NODE_XR_INT')


&


/*-----------------------------------------------*/
/* TASK No. 36 */
/* insert Not Null errors */

insert into RAX_APP_USER.E$_SHIP_NODE_XR2039001
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	SHIP_NODE_OID,
	SHIPNODE_KEY,
	CONTACT_ADDRESS_KEY,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE
)
select
	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15066: The column SHIPNODE_KEY cannot be null.',
	sysdate,
	'(2039001)ODS_Project.LOAD_OMS3_SHIP_NODE_XR_INT',
	'SHIPNODE_KEY',
	'NN',	
	SHIP_NODE_OID,
	SHIPNODE_KEY,
	CONTACT_ADDRESS_KEY,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE
from	RAX_APP_USER.I$_SHIP_NODE_XR2039001
where	SHIPNODE_KEY is null



&


/*-----------------------------------------------*/
/* TASK No. 37 */
/* create index on error table */

 
/* FLOW CONTROL CREATE INDEX ON THE E$TABLE */
BEGIN  
   EXECUTE IMMEDIATE 'create index 	RAX_APP_USER.E$_SHIP_NODE_XR2039001 on	RAX_APP_USER.E$_SHIP_NODE_XR2039001 (ODI_ROW_ID)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 and SQLCODE != -01408 THEN  
         RAISE;  
      END IF;  
END;


&


/*-----------------------------------------------*/
/* TASK No. 38 */
/* delete errors from controlled table */

delete from	RAX_APP_USER.I$_SHIP_NODE_XR2039001  T
where	exists 	(
		select	1
		from	RAX_APP_USER.E$_SHIP_NODE_XR2039001 E
		where ODI_SESS_NO = :v_sess_no
		and T.rowid = E.ODI_ROW_ID
		)


&


/*-----------------------------------------------*/
/* TASK No. 39 */
/* insert check sum into check table */

insert into RAX_APP_USER.SNP_CHECK_TAB
(
	SCHEMA_NAME,
	RESOURCE_NAME,
	FULL_RES_NAME,
	ERR_TYPE,
	ERR_MESS,
	CHECK_DATE,
	ORIGIN,
	CONS_NAME,
	CONS_TYPE,
	ERR_COUNT
)
select	
	'ODS_STAGE',
	'SHIP_NODE_XR',
	'ODS_STAGE.OMS3_SHIP_NODE_XR2039001',
	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE,
	count(1) 
from	RAX_APP_USER.E$_SHIP_NODE_XR2039001 E
where	E.ODI_ERR_TYPE	= 'F'
and	E.ODI_ORIGIN 	= '(2039001)ODS_Project.LOAD_OMS3_SHIP_NODE_XR_INT'
group by	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE


&


/*-----------------------------------------------*/
/* TASK No. 40 */
/* Merge Rows */

merge into	ODS_STAGE.OMS3_SHIP_NODE_XR T
using	RAX_APP_USER.I$_SHIP_NODE_XR2039001 S
on	(
		T.SHIPNODE_KEY=S.SHIPNODE_KEY
	)
when matched
then update set
	T.CONTACT_ADDRESS_KEY	= S.CONTACT_ADDRESS_KEY
	, T.ODS_MODIFY_DATE	= SYSDATE
when not matched
then insert
	(
	T.SHIPNODE_KEY,
	T.CONTACT_ADDRESS_KEY
	,  T.SHIP_NODE_OID,
	T.ODS_CREATE_DATE,
	T.ODS_MODIFY_DATE
	)
values
	(
	S.SHIPNODE_KEY,
	S.CONTACT_ADDRESS_KEY
	,  ODS_STAGE.SHIP_NODE_OID_SEQ.nextval,
	SYSDATE,
	SYSDATE
	)

&


/*-----------------------------------------------*/
/* TASK No. 41 */
/* Commit transaction */

/*commit*/


/*-----------------------------------------------*/
/* TASK No. 42 */
/* Drop flow table */

drop table RAX_APP_USER.I$_SHIP_NODE_XR2039001 

&


/*-----------------------------------------------*/
/* TASK No. 43 */
/* Set vID */

/* NONE or SET VARIABLE STATEMENT FOUND, CHECK ODI TASK NO. 43 */




/*-----------------------------------------------*/
/* TASK No. 44 */
/* Drop flow table */

BEGIN  
   EXECUTE IMMEDIATE 'drop table RAX_APP_USER.I$_SHIP_NODE2040001';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -942 THEN  
         RAISE;  
      END IF;  
END;

&


/*-----------------------------------------------*/
/* TASK No. 45 */
/* Create flow table I$ */

create table RAX_APP_USER.I$_SHIP_NODE2040001
(
	SHIP_NODE_OID	NUMBER NULL,
	SHIP_NODE	VARCHAR2(24) NULL,
	DESCRIPTION	VARCHAR2(100) NULL,
	SHIPNODE_TYPE	VARCHAR2(20) NULL,
	DCM_INTEGRATION_REAL_TIME	VARCHAR2(1) NULL,
	SERIAL_TRACKING	VARCHAR2(1) NULL,
	TAG_TRACKED_IN_INVENTORY	VARCHAR2(1) NULL,
	TAG_TRACKED_AT_RECEIPT	VARCHAR2(1) NULL,
	INTERFACE_TYPE	VARCHAR2(20) NULL,
	INTERFACE_SUB_TYPE	VARCHAR2(100) NULL,
	GLN	VARCHAR2(40) NULL,
	ACTIVATE_FLAG	VARCHAR2(1) NULL,
	REQUIRES_CHANGE_REQUEST	VARCHAR2(1) NULL,
	SHIP_NODE_ADDRESS_KEY	VARCHAR2(24) NULL,
	SUPPLIER_KEY	VARCHAR2(24) NULL,
	PICKLIST_TYPE	VARCHAR2(20) NULL,
	TIME_DIFF	NUMBER NULL,
	LATITUDE	NUMBER NULL,
	LONGITUDE	NUMBER NULL,
	SHIP_NODE_CLASS	VARCHAR2(40) NULL,
	RETURN_CENTER_FLAG	VARCHAR2(1) NULL,
	ACCEPTANCE_REQUIRED	VARCHAR2(1) NULL,
	GENERATE_BOL_NUMBER	VARCHAR2(1) NULL,
	CURRENT_BOL_NUMBER	VARCHAR2(35) NULL,
	OWNER_TYPE	VARCHAR2(20) NULL,
	RECEIVING_CALENDAR_KEY	VARCHAR2(24) NULL,
	SHIPPING_CALENDAR_KEY	VARCHAR2(24) NULL,
	OWNER_KEY	VARCHAR2(24) NULL,
	EXPORT_TAXPAYER_ID	VARCHAR2(40) NULL,
	EXPORT_LICENSE_NO	VARCHAR2(40) NULL,
	EXPORT_LICENSE_EXP_DATE	DATE NULL,
	INVENTORYTYPE	VARCHAR2(20) NULL,
	DEFAULT_DECLARED_VALUE	NUMBER NULL,
	MAINTAIN_INVENTORY_COST	VARCHAR2(1) NULL,
	INVENTORY_TRACKED	VARCHAR2(1) NULL,
	SHIPPING_NODE	VARCHAR2(1) NULL,
	RECEIVING_NODE	VARCHAR2(1) NULL,
	RETURNS_NODE	VARCHAR2(1) NULL,
	THREE_PL_NODE	VARCHAR2(1) NULL,
	LOCALECODE	VARCHAR2(20) NULL,
	CONTACT_ADDRESS_KEY	VARCHAR2(24) NULL,
	RECEIPT_PROCESSING_TIME	NUMBER NULL,
	INHERIT_CONFIG_FROM_SHIPNODE	VARCHAR2(24) NULL,
	NODE_ORG_CODE	VARCHAR2(24) NULL,
	MAX_DAYS_TO_SCH_BEFORE	NUMBER NULL,
	PROCURE_TO_SHIP_ALLOWED	VARCHAR2(1) NULL,
	SUBSTITUTION_ALLOWED	VARCHAR2(1) NULL,
	WORK_ORDER_CREATION_ALLOWED	VARCHAR2(1) NULL,
	DELAYED_INV_ALLOC_SUPPORT	VARCHAR2(1) NULL,
	X_DOC_NODE	VARCHAR2(1) NULL,
	USE_END_OF_SHIFT_TIME	VARCHAR2(1) NULL,
	CAN_SHIP_TO_OTHER_ADDRESSES	VARCHAR2(1) NULL,
	CAN_SHIP_TO_ALL_NODES	VARCHAR2(1) NULL,
	NODE_TYPE	VARCHAR2(40) NULL,
	IDENTIFIED_BY_PARENT_AS	VARCHAR2(24) NULL,
	MAX_CONCURRENT_WAVES	NUMBER NULL,
	AGENT_CRITERIA_GROUP	VARCHAR2(40) NULL,
	BOL_PREFIX	VARCHAR2(2) NULL,
	REQUIRE_TRANSFER_ACCEPTANCE	VARCHAR2(1) NULL,
	LOCKID	NUMBER NULL,
	CREATETS	DATE NULL,
	MODIFYTS	DATE NULL,
	CREATEUSERID	VARCHAR2(40) NULL,
	MODIFYUSERID	VARCHAR2(40) NULL,
	CREATEPROGID	VARCHAR2(40) NULL,
	MODIFYPROGID	VARCHAR2(40) NULL,
	RECEIVE_ADJ_RSN_CODE	VARCHAR2(40) NULL,
	PACK_ADJ_RSN_CODE	VARCHAR2(40) NULL,
	SHIP_ADJ_RSN_CODE	VARCHAR2(40) NULL,
	SERIAL_TRCKD_ON_TRANSFER	VARCHAR2(1) NULL,
	SERIAL_TRCKD_IN_SHIPPING	VARCHAR2(1) NULL,
	SERIAL_TRCKD_RECEIVING	VARCHAR2(40) NULL,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG	NUMBER NULL,
	ALLOW_INV_OPS_WHILE_PHY_CNT	VARCHAR2(1) NULL,
	IS_IBA_ALLOWED	VARCHAR2(1) NULL,
	RESOURCE_PLANNING_ENABLED	VARCHAR2(1) NULL,
	RESOURCE_PLANNING_UOM	VARCHAR2(40) NULL,
	PLANNING_CALENDAR_KEY	VARCHAR2(24) NULL,
	SUPPLY_DEMAND_DIFF_THRESHOLD	NUMBER NULL,
	DEFAULT_PERSON_DAY_HOURS	NUMBER NULL,
	WAVE_SHORTAGE_HANDLING_TYPE	VARCHAR2(40) NULL,
	IS_FULFILLMENT_NODE	VARCHAR2(1) NULL,
	IS_YARD	VARCHAR2(1) NULL,
	DOCK_SCHEDULING	VARCHAR2(20) NULL,
	OVER_ALLOC_ADJ_RSN_CODE	VARCHAR2(40) NULL,
	VOICE_APPL_INSTANCE_KEY	VARCHAR2(24) NULL,
	RCPT_PRCSSNG_TIME_FOR_FUTURE	NUMBER NULL,
	IGNORE_PENDING_ALLOCATION	VARCHAR2(1) NULL,
	ALLOW_GIFT_WRAP	VARCHAR2(1) NULL,
	SOURCE_SYSTEM_OID	NUMBER NULL,
	ODS_CREATE_DATE	DATE NULL,
	ODS_MODIFY_DATE	DATE NULL
	,IND_UPDATE		char(1)
)
NOLOGGING

&


/*-----------------------------------------------*/
/* TASK No. 46 */
/* Insert flow into I$ table */

/* DETECTION_STRATEGY = NOT_EXISTS */
 


  


insert into	RAX_APP_USER.I$_SHIP_NODE2040001
(
	SHIP_NODE_OID,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	SOURCE_SYSTEM_OID,
	IND_UPDATE
)
select 
SHIP_NODE_OID,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	SOURCE_SYSTEM_OID,
	IND_UPDATE
 from (


select 	 
	
	SHIP_NODE_XR.SHIP_NODE_OID SHIP_NODE_OID,
	TRIM(SHIP_NODE_STG.SHIP_NODE) SHIP_NODE,
	SHIP_NODE_STG.DESCRIPTION DESCRIPTION,
	SHIP_NODE_STG.SHIPNODE_TYPE SHIPNODE_TYPE,
	SHIP_NODE_STG.DCM_INTEGRATION_REAL_TIME DCM_INTEGRATION_REAL_TIME,
	SHIP_NODE_STG.SERIAL_TRACKING SERIAL_TRACKING,
	SHIP_NODE_STG.TAG_TRACKED_IN_INVENTORY TAG_TRACKED_IN_INVENTORY,
	SHIP_NODE_STG.TAG_TRACKED_AT_RECEIPT TAG_TRACKED_AT_RECEIPT,
	SHIP_NODE_STG.INTERFACE_TYPE INTERFACE_TYPE,
	SHIP_NODE_STG.INTERFACE_SUB_TYPE INTERFACE_SUB_TYPE,
	SHIP_NODE_STG.GLN GLN,
	SHIP_NODE_STG.ACTIVATE_FLAG ACTIVATE_FLAG,
	SHIP_NODE_STG.REQUIRES_CHANGE_REQUEST REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_STG.SHIP_NODE_ADDRESS_KEY SHIP_NODE_ADDRESS_KEY,
	SHIP_NODE_STG.SUPPLIER_KEY SUPPLIER_KEY,
	SHIP_NODE_STG.PICKLIST_TYPE PICKLIST_TYPE,
	SHIP_NODE_STG.TIME_DIFF TIME_DIFF,
	SHIP_NODE_STG.LATITUDE LATITUDE,
	SHIP_NODE_STG.LONGITUDE LONGITUDE,
	SHIP_NODE_STG.SHIP_NODE_CLASS SHIP_NODE_CLASS,
	SHIP_NODE_STG.RETURN_CENTER_FLAG RETURN_CENTER_FLAG,
	SHIP_NODE_STG.ACCEPTANCE_REQUIRED ACCEPTANCE_REQUIRED,
	SHIP_NODE_STG.GENERATE_BOL_NUMBER GENERATE_BOL_NUMBER,
	SHIP_NODE_STG.CURRENT_BOL_NUMBER CURRENT_BOL_NUMBER,
	SHIP_NODE_STG.OWNER_TYPE OWNER_TYPE,
	SHIP_NODE_STG.RECEIVING_CALENDAR_KEY RECEIVING_CALENDAR_KEY,
	SHIP_NODE_STG.SHIPPING_CALENDAR_KEY SHIPPING_CALENDAR_KEY,
	SHIP_NODE_STG.OWNER_KEY OWNER_KEY,
	SHIP_NODE_STG.EXPORT_TAXPAYER_ID EXPORT_TAXPAYER_ID,
	SHIP_NODE_STG.EXPORT_LICENSE_NO EXPORT_LICENSE_NO,
	SHIP_NODE_STG.EXPORT_LICENSE_EXP_DATE EXPORT_LICENSE_EXP_DATE,
	SHIP_NODE_STG.INVENTORYTYPE INVENTORYTYPE,
	SHIP_NODE_STG.DEFAULT_DECLARED_VALUE DEFAULT_DECLARED_VALUE,
	SHIP_NODE_STG.MAINTAIN_INVENTORY_COST MAINTAIN_INVENTORY_COST,
	SHIP_NODE_STG.INVENTORY_TRACKED INVENTORY_TRACKED,
	SHIP_NODE_STG.SHIPPING_NODE SHIPPING_NODE,
	SHIP_NODE_STG.RECEIVING_NODE RECEIVING_NODE,
	SHIP_NODE_STG.RETURNS_NODE RETURNS_NODE,
	SHIP_NODE_STG.THREE_PL_NODE THREE_PL_NODE,
	SHIP_NODE_STG.LOCALECODE LOCALECODE,
	SHIP_NODE_STG.CONTACT_ADDRESS_KEY CONTACT_ADDRESS_KEY,
	SHIP_NODE_STG.RECEIPT_PROCESSING_TIME RECEIPT_PROCESSING_TIME,
	SHIP_NODE_STG.INHERIT_CONFIG_FROM_SHIPNODE INHERIT_CONFIG_FROM_SHIPNODE,
	SHIP_NODE_STG.NODE_ORG_CODE NODE_ORG_CODE,
	SHIP_NODE_STG.MAX_DAYS_TO_SCH_BEFORE MAX_DAYS_TO_SCH_BEFORE,
	SHIP_NODE_STG.PROCURE_TO_SHIP_ALLOWED PROCURE_TO_SHIP_ALLOWED,
	SHIP_NODE_STG.SUBSTITUTION_ALLOWED SUBSTITUTION_ALLOWED,
	SHIP_NODE_STG.WORK_ORDER_CREATION_ALLOWED WORK_ORDER_CREATION_ALLOWED,
	SHIP_NODE_STG.DELAYED_INV_ALLOC_SUPPORT DELAYED_INV_ALLOC_SUPPORT,
	SHIP_NODE_STG.X_DOC_NODE X_DOC_NODE,
	SHIP_NODE_STG.USE_END_OF_SHIFT_TIME USE_END_OF_SHIFT_TIME,
	SHIP_NODE_STG.CAN_SHIP_TO_OTHER_ADDRESSES CAN_SHIP_TO_OTHER_ADDRESSES,
	SHIP_NODE_STG.CAN_SHIP_TO_ALL_NODES CAN_SHIP_TO_ALL_NODES,
	SHIP_NODE_STG.NODE_TYPE NODE_TYPE,
	SHIP_NODE_STG.IDENTIFIED_BY_PARENT_AS IDENTIFIED_BY_PARENT_AS,
	SHIP_NODE_STG.MAX_CONCURRENT_WAVES MAX_CONCURRENT_WAVES,
	SHIP_NODE_STG.AGENT_CRITERIA_GROUP AGENT_CRITERIA_GROUP,
	SHIP_NODE_STG.BOL_PREFIX BOL_PREFIX,
	SHIP_NODE_STG.REQUIRE_TRANSFER_ACCEPTANCE REQUIRE_TRANSFER_ACCEPTANCE,
	SHIP_NODE_STG.LOCKID LOCKID,
	SHIP_NODE_STG.CREATETS CREATETS,
	SHIP_NODE_STG.MODIFYTS MODIFYTS,
	SHIP_NODE_STG.CREATEUSERID CREATEUSERID,
	SHIP_NODE_STG.MODIFYUSERID MODIFYUSERID,
	SHIP_NODE_STG.CREATEPROGID CREATEPROGID,
	SHIP_NODE_STG.MODIFYPROGID MODIFYPROGID,
	SHIP_NODE_STG.RECEIVE_ADJ_RSN_CODE RECEIVE_ADJ_RSN_CODE,
	SHIP_NODE_STG.PACK_ADJ_RSN_CODE PACK_ADJ_RSN_CODE,
	SHIP_NODE_STG.SHIP_ADJ_RSN_CODE SHIP_ADJ_RSN_CODE,
	SHIP_NODE_STG.SERIAL_TRCKD_ON_TRANSFER SERIAL_TRCKD_ON_TRANSFER,
	SHIP_NODE_STG.SERIAL_TRCKD_IN_SHIPPING SERIAL_TRCKD_IN_SHIPPING,
	SHIP_NODE_STG.SERIAL_TRCKD_RECEIVING SERIAL_TRCKD_RECEIVING,
	SHIP_NODE_STG.RCPT_PRCSSNG_TIME_FOR_FRWRDNG RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	SHIP_NODE_STG.ALLOW_INV_OPS_WHILE_PHY_CNT ALLOW_INV_OPS_WHILE_PHY_CNT,
	SHIP_NODE_STG.IS_IBA_ALLOWED IS_IBA_ALLOWED,
	SHIP_NODE_STG.RESOURCE_PLANNING_ENABLED RESOURCE_PLANNING_ENABLED,
	SHIP_NODE_STG.RESOURCE_PLANNING_UOM RESOURCE_PLANNING_UOM,
	SHIP_NODE_STG.PLANNING_CALENDAR_KEY PLANNING_CALENDAR_KEY,
	SHIP_NODE_STG.SUPPLY_DEMAND_DIFF_THRESHOLD SUPPLY_DEMAND_DIFF_THRESHOLD,
	SHIP_NODE_STG.DEFAULT_PERSON_DAY_HOURS DEFAULT_PERSON_DAY_HOURS,
	SHIP_NODE_STG.WAVE_SHORTAGE_HANDLING_TYPE WAVE_SHORTAGE_HANDLING_TYPE,
	SHIP_NODE_STG.IS_FULFILLMENT_NODE IS_FULFILLMENT_NODE,
	SHIP_NODE_STG.IS_YARD IS_YARD,
	SHIP_NODE_STG.DOCK_SCHEDULING DOCK_SCHEDULING,
	SHIP_NODE_STG.OVER_ALLOC_ADJ_RSN_CODE OVER_ALLOC_ADJ_RSN_CODE,
	SHIP_NODE_STG.VOICE_APPL_INSTANCE_KEY VOICE_APPL_INSTANCE_KEY,
	SHIP_NODE_STG.RCPT_PRCSSNG_TIME_FOR_FUTURE RCPT_PRCSSNG_TIME_FOR_FUTURE,
	SHIP_NODE_STG.IGNORE_PENDING_ALLOCATION IGNORE_PENDING_ALLOCATION,
	SHIP_NODE_STG.ALLOW_GIFT_WRAP ALLOW_GIFT_WRAP,
	SOURCE_SYSTEM.SOURCE_SYSTEM_OID SOURCE_SYSTEM_OID,

	'I' IND_UPDATE

from	ODS_STAGE.OMS3_SHIP_NODE_STG   SHIP_NODE_STG, ODS_STAGE.OMS3_SHIP_NODE_XR   SHIP_NODE_XR, ODS_OWN.SOURCE_SYSTEM   SOURCE_SYSTEM
where	(1=1)
 And (TRIM(SHIP_NODE_STG.SHIPNODE_KEY) = TRIM(SHIP_NODE_XR.SHIPNODE_KEY))
And (SOURCE_SYSTEM.SOURCE_SYSTEM_SHORT_NAME = 'OMS')
 And (SHIP_NODE_STG.MODIFYTS >= TO_DATE(SUBSTR(:v_cdc_load_date, 1, 19), 'YYYY-MM-DD HH24:MI:SS')  - :v_cdc_oms_overlap)




) S
where NOT EXISTS 
	( select 1 from ODS_OWN.SHIP_NODE T
	where	T.SHIP_NODE_OID	= S.SHIP_NODE_OID 
		 and ((T.SHIP_NODE = S.SHIP_NODE) or (T.SHIP_NODE IS NULL and S.SHIP_NODE IS NULL)) and
		((T.DESCRIPTION = S.DESCRIPTION) or (T.DESCRIPTION IS NULL and S.DESCRIPTION IS NULL)) and
		((T.SHIPNODE_TYPE = S.SHIPNODE_TYPE) or (T.SHIPNODE_TYPE IS NULL and S.SHIPNODE_TYPE IS NULL)) and
		((T.DCM_INTEGRATION_REAL_TIME = S.DCM_INTEGRATION_REAL_TIME) or (T.DCM_INTEGRATION_REAL_TIME IS NULL and S.DCM_INTEGRATION_REAL_TIME IS NULL)) and
		((T.SERIAL_TRACKING = S.SERIAL_TRACKING) or (T.SERIAL_TRACKING IS NULL and S.SERIAL_TRACKING IS NULL)) and
		((T.TAG_TRACKED_IN_INVENTORY = S.TAG_TRACKED_IN_INVENTORY) or (T.TAG_TRACKED_IN_INVENTORY IS NULL and S.TAG_TRACKED_IN_INVENTORY IS NULL)) and
		((T.TAG_TRACKED_AT_RECEIPT = S.TAG_TRACKED_AT_RECEIPT) or (T.TAG_TRACKED_AT_RECEIPT IS NULL and S.TAG_TRACKED_AT_RECEIPT IS NULL)) and
		((T.INTERFACE_TYPE = S.INTERFACE_TYPE) or (T.INTERFACE_TYPE IS NULL and S.INTERFACE_TYPE IS NULL)) and
		((T.INTERFACE_SUB_TYPE = S.INTERFACE_SUB_TYPE) or (T.INTERFACE_SUB_TYPE IS NULL and S.INTERFACE_SUB_TYPE IS NULL)) and
		((T.GLN = S.GLN) or (T.GLN IS NULL and S.GLN IS NULL)) and
		((T.ACTIVATE_FLAG = S.ACTIVATE_FLAG) or (T.ACTIVATE_FLAG IS NULL and S.ACTIVATE_FLAG IS NULL)) and
		((T.REQUIRES_CHANGE_REQUEST = S.REQUIRES_CHANGE_REQUEST) or (T.REQUIRES_CHANGE_REQUEST IS NULL and S.REQUIRES_CHANGE_REQUEST IS NULL)) and
		((T.SHIP_NODE_ADDRESS_KEY = S.SHIP_NODE_ADDRESS_KEY) or (T.SHIP_NODE_ADDRESS_KEY IS NULL and S.SHIP_NODE_ADDRESS_KEY IS NULL)) and
		((T.SUPPLIER_KEY = S.SUPPLIER_KEY) or (T.SUPPLIER_KEY IS NULL and S.SUPPLIER_KEY IS NULL)) and
		((T.PICKLIST_TYPE = S.PICKLIST_TYPE) or (T.PICKLIST_TYPE IS NULL and S.PICKLIST_TYPE IS NULL)) and
		((T.TIME_DIFF = S.TIME_DIFF) or (T.TIME_DIFF IS NULL and S.TIME_DIFF IS NULL)) and
		((T.LATITUDE = S.LATITUDE) or (T.LATITUDE IS NULL and S.LATITUDE IS NULL)) and
		((T.LONGITUDE = S.LONGITUDE) or (T.LONGITUDE IS NULL and S.LONGITUDE IS NULL)) and
		((T.SHIP_NODE_CLASS = S.SHIP_NODE_CLASS) or (T.SHIP_NODE_CLASS IS NULL and S.SHIP_NODE_CLASS IS NULL)) and
		((T.RETURN_CENTER_FLAG = S.RETURN_CENTER_FLAG) or (T.RETURN_CENTER_FLAG IS NULL and S.RETURN_CENTER_FLAG IS NULL)) and
		((T.ACCEPTANCE_REQUIRED = S.ACCEPTANCE_REQUIRED) or (T.ACCEPTANCE_REQUIRED IS NULL and S.ACCEPTANCE_REQUIRED IS NULL)) and
		((T.GENERATE_BOL_NUMBER = S.GENERATE_BOL_NUMBER) or (T.GENERATE_BOL_NUMBER IS NULL and S.GENERATE_BOL_NUMBER IS NULL)) and
		((T.CURRENT_BOL_NUMBER = S.CURRENT_BOL_NUMBER) or (T.CURRENT_BOL_NUMBER IS NULL and S.CURRENT_BOL_NUMBER IS NULL)) and
		((T.OWNER_TYPE = S.OWNER_TYPE) or (T.OWNER_TYPE IS NULL and S.OWNER_TYPE IS NULL)) and
		((T.RECEIVING_CALENDAR_KEY = S.RECEIVING_CALENDAR_KEY) or (T.RECEIVING_CALENDAR_KEY IS NULL and S.RECEIVING_CALENDAR_KEY IS NULL)) and
		((T.SHIPPING_CALENDAR_KEY = S.SHIPPING_CALENDAR_KEY) or (T.SHIPPING_CALENDAR_KEY IS NULL and S.SHIPPING_CALENDAR_KEY IS NULL)) and
		((T.OWNER_KEY = S.OWNER_KEY) or (T.OWNER_KEY IS NULL and S.OWNER_KEY IS NULL)) and
		((T.EXPORT_TAXPAYER_ID = S.EXPORT_TAXPAYER_ID) or (T.EXPORT_TAXPAYER_ID IS NULL and S.EXPORT_TAXPAYER_ID IS NULL)) and
		((T.EXPORT_LICENSE_NO = S.EXPORT_LICENSE_NO) or (T.EXPORT_LICENSE_NO IS NULL and S.EXPORT_LICENSE_NO IS NULL)) and
		((T.EXPORT_LICENSE_EXP_DATE = S.EXPORT_LICENSE_EXP_DATE) or (T.EXPORT_LICENSE_EXP_DATE IS NULL and S.EXPORT_LICENSE_EXP_DATE IS NULL)) and
		((T.INVENTORYTYPE = S.INVENTORYTYPE) or (T.INVENTORYTYPE IS NULL and S.INVENTORYTYPE IS NULL)) and
		((T.DEFAULT_DECLARED_VALUE = S.DEFAULT_DECLARED_VALUE) or (T.DEFAULT_DECLARED_VALUE IS NULL and S.DEFAULT_DECLARED_VALUE IS NULL)) and
		((T.MAINTAIN_INVENTORY_COST = S.MAINTAIN_INVENTORY_COST) or (T.MAINTAIN_INVENTORY_COST IS NULL and S.MAINTAIN_INVENTORY_COST IS NULL)) and
		((T.INVENTORY_TRACKED = S.INVENTORY_TRACKED) or (T.INVENTORY_TRACKED IS NULL and S.INVENTORY_TRACKED IS NULL)) and
		((T.SHIPPING_NODE = S.SHIPPING_NODE) or (T.SHIPPING_NODE IS NULL and S.SHIPPING_NODE IS NULL)) and
		((T.RECEIVING_NODE = S.RECEIVING_NODE) or (T.RECEIVING_NODE IS NULL and S.RECEIVING_NODE IS NULL)) and
		((T.RETURNS_NODE = S.RETURNS_NODE) or (T.RETURNS_NODE IS NULL and S.RETURNS_NODE IS NULL)) and
		((T.THREE_PL_NODE = S.THREE_PL_NODE) or (T.THREE_PL_NODE IS NULL and S.THREE_PL_NODE IS NULL)) and
		((T.LOCALECODE = S.LOCALECODE) or (T.LOCALECODE IS NULL and S.LOCALECODE IS NULL)) and
		((T.CONTACT_ADDRESS_KEY = S.CONTACT_ADDRESS_KEY) or (T.CONTACT_ADDRESS_KEY IS NULL and S.CONTACT_ADDRESS_KEY IS NULL)) and
		((T.RECEIPT_PROCESSING_TIME = S.RECEIPT_PROCESSING_TIME) or (T.RECEIPT_PROCESSING_TIME IS NULL and S.RECEIPT_PROCESSING_TIME IS NULL)) and
		((T.INHERIT_CONFIG_FROM_SHIPNODE = S.INHERIT_CONFIG_FROM_SHIPNODE) or (T.INHERIT_CONFIG_FROM_SHIPNODE IS NULL and S.INHERIT_CONFIG_FROM_SHIPNODE IS NULL)) and
		((T.NODE_ORG_CODE = S.NODE_ORG_CODE) or (T.NODE_ORG_CODE IS NULL and S.NODE_ORG_CODE IS NULL)) and
		((T.MAX_DAYS_TO_SCH_BEFORE = S.MAX_DAYS_TO_SCH_BEFORE) or (T.MAX_DAYS_TO_SCH_BEFORE IS NULL and S.MAX_DAYS_TO_SCH_BEFORE IS NULL)) and
		((T.PROCURE_TO_SHIP_ALLOWED = S.PROCURE_TO_SHIP_ALLOWED) or (T.PROCURE_TO_SHIP_ALLOWED IS NULL and S.PROCURE_TO_SHIP_ALLOWED IS NULL)) and
		((T.SUBSTITUTION_ALLOWED = S.SUBSTITUTION_ALLOWED) or (T.SUBSTITUTION_ALLOWED IS NULL and S.SUBSTITUTION_ALLOWED IS NULL)) and
		((T.WORK_ORDER_CREATION_ALLOWED = S.WORK_ORDER_CREATION_ALLOWED) or (T.WORK_ORDER_CREATION_ALLOWED IS NULL and S.WORK_ORDER_CREATION_ALLOWED IS NULL)) and
		((T.DELAYED_INV_ALLOC_SUPPORT = S.DELAYED_INV_ALLOC_SUPPORT) or (T.DELAYED_INV_ALLOC_SUPPORT IS NULL and S.DELAYED_INV_ALLOC_SUPPORT IS NULL)) and
		((T.X_DOC_NODE = S.X_DOC_NODE) or (T.X_DOC_NODE IS NULL and S.X_DOC_NODE IS NULL)) and
		((T.USE_END_OF_SHIFT_TIME = S.USE_END_OF_SHIFT_TIME) or (T.USE_END_OF_SHIFT_TIME IS NULL and S.USE_END_OF_SHIFT_TIME IS NULL)) and
		((T.CAN_SHIP_TO_OTHER_ADDRESSES = S.CAN_SHIP_TO_OTHER_ADDRESSES) or (T.CAN_SHIP_TO_OTHER_ADDRESSES IS NULL and S.CAN_SHIP_TO_OTHER_ADDRESSES IS NULL)) and
		((T.CAN_SHIP_TO_ALL_NODES = S.CAN_SHIP_TO_ALL_NODES) or (T.CAN_SHIP_TO_ALL_NODES IS NULL and S.CAN_SHIP_TO_ALL_NODES IS NULL)) and
		((T.NODE_TYPE = S.NODE_TYPE) or (T.NODE_TYPE IS NULL and S.NODE_TYPE IS NULL)) and
		((T.IDENTIFIED_BY_PARENT_AS = S.IDENTIFIED_BY_PARENT_AS) or (T.IDENTIFIED_BY_PARENT_AS IS NULL and S.IDENTIFIED_BY_PARENT_AS IS NULL)) and
		((T.MAX_CONCURRENT_WAVES = S.MAX_CONCURRENT_WAVES) or (T.MAX_CONCURRENT_WAVES IS NULL and S.MAX_CONCURRENT_WAVES IS NULL)) and
		((T.AGENT_CRITERIA_GROUP = S.AGENT_CRITERIA_GROUP) or (T.AGENT_CRITERIA_GROUP IS NULL and S.AGENT_CRITERIA_GROUP IS NULL)) and
		((T.BOL_PREFIX = S.BOL_PREFIX) or (T.BOL_PREFIX IS NULL and S.BOL_PREFIX IS NULL)) and
		((T.REQUIRE_TRANSFER_ACCEPTANCE = S.REQUIRE_TRANSFER_ACCEPTANCE) or (T.REQUIRE_TRANSFER_ACCEPTANCE IS NULL and S.REQUIRE_TRANSFER_ACCEPTANCE IS NULL)) and
		((T.LOCKID = S.LOCKID) or (T.LOCKID IS NULL and S.LOCKID IS NULL)) and
		((T.CREATETS = S.CREATETS) or (T.CREATETS IS NULL and S.CREATETS IS NULL)) and
		((T.MODIFYTS = S.MODIFYTS) or (T.MODIFYTS IS NULL and S.MODIFYTS IS NULL)) and
		((T.CREATEUSERID = S.CREATEUSERID) or (T.CREATEUSERID IS NULL and S.CREATEUSERID IS NULL)) and
		((T.MODIFYUSERID = S.MODIFYUSERID) or (T.MODIFYUSERID IS NULL and S.MODIFYUSERID IS NULL)) and
		((T.CREATEPROGID = S.CREATEPROGID) or (T.CREATEPROGID IS NULL and S.CREATEPROGID IS NULL)) and
		((T.MODIFYPROGID = S.MODIFYPROGID) or (T.MODIFYPROGID IS NULL and S.MODIFYPROGID IS NULL)) and
		((T.RECEIVE_ADJ_RSN_CODE = S.RECEIVE_ADJ_RSN_CODE) or (T.RECEIVE_ADJ_RSN_CODE IS NULL and S.RECEIVE_ADJ_RSN_CODE IS NULL)) and
		((T.PACK_ADJ_RSN_CODE = S.PACK_ADJ_RSN_CODE) or (T.PACK_ADJ_RSN_CODE IS NULL and S.PACK_ADJ_RSN_CODE IS NULL)) and
		((T.SHIP_ADJ_RSN_CODE = S.SHIP_ADJ_RSN_CODE) or (T.SHIP_ADJ_RSN_CODE IS NULL and S.SHIP_ADJ_RSN_CODE IS NULL)) and
		((T.SERIAL_TRCKD_ON_TRANSFER = S.SERIAL_TRCKD_ON_TRANSFER) or (T.SERIAL_TRCKD_ON_TRANSFER IS NULL and S.SERIAL_TRCKD_ON_TRANSFER IS NULL)) and
		((T.SERIAL_TRCKD_IN_SHIPPING = S.SERIAL_TRCKD_IN_SHIPPING) or (T.SERIAL_TRCKD_IN_SHIPPING IS NULL and S.SERIAL_TRCKD_IN_SHIPPING IS NULL)) and
		((T.SERIAL_TRCKD_RECEIVING = S.SERIAL_TRCKD_RECEIVING) or (T.SERIAL_TRCKD_RECEIVING IS NULL and S.SERIAL_TRCKD_RECEIVING IS NULL)) and
		((T.RCPT_PRCSSNG_TIME_FOR_FRWRDNG = S.RCPT_PRCSSNG_TIME_FOR_FRWRDNG) or (T.RCPT_PRCSSNG_TIME_FOR_FRWRDNG IS NULL and S.RCPT_PRCSSNG_TIME_FOR_FRWRDNG IS NULL)) and
		((T.ALLOW_INV_OPS_WHILE_PHY_CNT = S.ALLOW_INV_OPS_WHILE_PHY_CNT) or (T.ALLOW_INV_OPS_WHILE_PHY_CNT IS NULL and S.ALLOW_INV_OPS_WHILE_PHY_CNT IS NULL)) and
		((T.IS_IBA_ALLOWED = S.IS_IBA_ALLOWED) or (T.IS_IBA_ALLOWED IS NULL and S.IS_IBA_ALLOWED IS NULL)) and
		((T.RESOURCE_PLANNING_ENABLED = S.RESOURCE_PLANNING_ENABLED) or (T.RESOURCE_PLANNING_ENABLED IS NULL and S.RESOURCE_PLANNING_ENABLED IS NULL)) and
		((T.RESOURCE_PLANNING_UOM = S.RESOURCE_PLANNING_UOM) or (T.RESOURCE_PLANNING_UOM IS NULL and S.RESOURCE_PLANNING_UOM IS NULL)) and
		((T.PLANNING_CALENDAR_KEY = S.PLANNING_CALENDAR_KEY) or (T.PLANNING_CALENDAR_KEY IS NULL and S.PLANNING_CALENDAR_KEY IS NULL)) and
		((T.SUPPLY_DEMAND_DIFF_THRESHOLD = S.SUPPLY_DEMAND_DIFF_THRESHOLD) or (T.SUPPLY_DEMAND_DIFF_THRESHOLD IS NULL and S.SUPPLY_DEMAND_DIFF_THRESHOLD IS NULL)) and
		((T.DEFAULT_PERSON_DAY_HOURS = S.DEFAULT_PERSON_DAY_HOURS) or (T.DEFAULT_PERSON_DAY_HOURS IS NULL and S.DEFAULT_PERSON_DAY_HOURS IS NULL)) and
		((T.WAVE_SHORTAGE_HANDLING_TYPE = S.WAVE_SHORTAGE_HANDLING_TYPE) or (T.WAVE_SHORTAGE_HANDLING_TYPE IS NULL and S.WAVE_SHORTAGE_HANDLING_TYPE IS NULL)) and
		((T.IS_FULFILLMENT_NODE = S.IS_FULFILLMENT_NODE) or (T.IS_FULFILLMENT_NODE IS NULL and S.IS_FULFILLMENT_NODE IS NULL)) and
		((T.IS_YARD = S.IS_YARD) or (T.IS_YARD IS NULL and S.IS_YARD IS NULL)) and
		((T.DOCK_SCHEDULING = S.DOCK_SCHEDULING) or (T.DOCK_SCHEDULING IS NULL and S.DOCK_SCHEDULING IS NULL)) and
		((T.OVER_ALLOC_ADJ_RSN_CODE = S.OVER_ALLOC_ADJ_RSN_CODE) or (T.OVER_ALLOC_ADJ_RSN_CODE IS NULL and S.OVER_ALLOC_ADJ_RSN_CODE IS NULL)) and
		((T.VOICE_APPL_INSTANCE_KEY = S.VOICE_APPL_INSTANCE_KEY) or (T.VOICE_APPL_INSTANCE_KEY IS NULL and S.VOICE_APPL_INSTANCE_KEY IS NULL)) and
		((T.RCPT_PRCSSNG_TIME_FOR_FUTURE = S.RCPT_PRCSSNG_TIME_FOR_FUTURE) or (T.RCPT_PRCSSNG_TIME_FOR_FUTURE IS NULL and S.RCPT_PRCSSNG_TIME_FOR_FUTURE IS NULL)) and
		((T.IGNORE_PENDING_ALLOCATION = S.IGNORE_PENDING_ALLOCATION) or (T.IGNORE_PENDING_ALLOCATION IS NULL and S.IGNORE_PENDING_ALLOCATION IS NULL)) and
		((T.ALLOW_GIFT_WRAP = S.ALLOW_GIFT_WRAP) or (T.ALLOW_GIFT_WRAP IS NULL and S.ALLOW_GIFT_WRAP IS NULL)) and
		((T.SOURCE_SYSTEM_OID = S.SOURCE_SYSTEM_OID) or (T.SOURCE_SYSTEM_OID IS NULL and S.SOURCE_SYSTEM_OID IS NULL))
        )

  
  

  



&


/*-----------------------------------------------*/
/* TASK No. 47 */
/* Analyze integration table */



begin
    dbms_stats.gather_table_stats(
	ownname => 'RAX_APP_USER',
	tabname => 'I$_SHIP_NODE2040001',
	estimate_percent => dbms_stats.auto_sample_size
    );
end;



&


/*-----------------------------------------------*/
/* TASK No. 48 */
/* Create Index on flow table */

create index	RAX_APP_USER.I$_SHIP_NODE_IDX2040001
on		RAX_APP_USER.I$_SHIP_NODE2040001 (SHIP_NODE_OID)
NOLOGGING

&


/*-----------------------------------------------*/
/* TASK No. 49 */
/* create check table */


BEGIN  
   EXECUTE IMMEDIATE 'create table RAX_APP_USER.SNP_CHECK_TAB
						(
							CATALOG_NAME	VARCHAR2(100 CHAR) NULL ,
							SCHEMA_NAME	VARCHAR2(100 CHAR) NULL ,
							RESOURCE_NAME	VARCHAR2(100 CHAR) NULL,
							FULL_RES_NAME	VARCHAR2(100 CHAR) NULL,
							ERR_TYPE		VARCHAR2(1 CHAR) NULL,
							ERR_MESS		VARCHAR2(250 CHAR) NULL ,
							CHECK_DATE	DATE NULL,
							ORIGIN		VARCHAR2(100 CHAR) NULL,
							CONS_NAME	VARCHAR2(35 CHAR) NULL,
							CONS_TYPE		VARCHAR2(2 CHAR) NULL,
							ERR_COUNT		NUMBER(10) NULL
						)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 THEN  
         RAISE;  
      END IF;  
END;
	

&


/*-----------------------------------------------*/
/* TASK No. 50 */
/* delete previous check sum */

delete from	RAX_APP_USER.SNP_CHECK_TAB
where	SCHEMA_NAME	= 'ODS_OWN'
and	ORIGIN 		= '(2040001)ODS_Project.LOAD_SHIP_NODE_INT'
and	ERR_TYPE 		= 'F'


&


/*-----------------------------------------------*/
/* TASK No. 51 */
/* create error table */

BEGIN  
   EXECUTE IMMEDIATE 'create table RAX_APP_USER.E$_SHIP_NODE2040001
						(
							ODI_ROW_ID 		UROWID,
							ODI_ERR_TYPE		VARCHAR2(1 CHAR) NULL, 
							ODI_ERR_MESS		VARCHAR2(250 CHAR) NULL,
							ODI_CHECK_DATE	DATE NULL, 
							SHIP_NODE_OID	NUMBER NULL,
							SHIP_NODE	VARCHAR2(24) NULL,
							DESCRIPTION	VARCHAR2(100) NULL,
							SHIPNODE_TYPE	VARCHAR2(20) NULL,
							DCM_INTEGRATION_REAL_TIME	VARCHAR2(1) NULL,
							SERIAL_TRACKING	VARCHAR2(1) NULL,
							TAG_TRACKED_IN_INVENTORY	VARCHAR2(1) NULL,
							TAG_TRACKED_AT_RECEIPT	VARCHAR2(1) NULL,
							INTERFACE_TYPE	VARCHAR2(20) NULL,
							INTERFACE_SUB_TYPE	VARCHAR2(100) NULL,
							GLN	VARCHAR2(40) NULL,
							ACTIVATE_FLAG	VARCHAR2(1) NULL,
							REQUIRES_CHANGE_REQUEST	VARCHAR2(1) NULL,
							SHIP_NODE_ADDRESS_KEY	VARCHAR2(24) NULL,
							SUPPLIER_KEY	VARCHAR2(24) NULL,
							PICKLIST_TYPE	VARCHAR2(20) NULL,
							TIME_DIFF	NUMBER NULL,
							LATITUDE	NUMBER NULL,
							LONGITUDE	NUMBER NULL,
							SHIP_NODE_CLASS	VARCHAR2(40) NULL,
							RETURN_CENTER_FLAG	VARCHAR2(1) NULL,
							ACCEPTANCE_REQUIRED	VARCHAR2(1) NULL,
							GENERATE_BOL_NUMBER	VARCHAR2(1) NULL,
							CURRENT_BOL_NUMBER	VARCHAR2(35) NULL,
							OWNER_TYPE	VARCHAR2(20) NULL,
							RECEIVING_CALENDAR_KEY	VARCHAR2(24) NULL,
							SHIPPING_CALENDAR_KEY	VARCHAR2(24) NULL,
							OWNER_KEY	VARCHAR2(24) NULL,
							EXPORT_TAXPAYER_ID	VARCHAR2(40) NULL,
							EXPORT_LICENSE_NO	VARCHAR2(40) NULL,
							EXPORT_LICENSE_EXP_DATE	DATE NULL,
							INVENTORYTYPE	VARCHAR2(20) NULL,
							DEFAULT_DECLARED_VALUE	NUMBER NULL,
							MAINTAIN_INVENTORY_COST	VARCHAR2(1) NULL,
							INVENTORY_TRACKED	VARCHAR2(1) NULL,
							SHIPPING_NODE	VARCHAR2(1) NULL,
							RECEIVING_NODE	VARCHAR2(1) NULL,
							RETURNS_NODE	VARCHAR2(1) NULL,
							THREE_PL_NODE	VARCHAR2(1) NULL,
							LOCALECODE	VARCHAR2(20) NULL,
							CONTACT_ADDRESS_KEY	VARCHAR2(24) NULL,
							RECEIPT_PROCESSING_TIME	NUMBER NULL,
							INHERIT_CONFIG_FROM_SHIPNODE	VARCHAR2(24) NULL,
							NODE_ORG_CODE	VARCHAR2(24) NULL,
							MAX_DAYS_TO_SCH_BEFORE	NUMBER NULL,
							PROCURE_TO_SHIP_ALLOWED	VARCHAR2(1) NULL,
							SUBSTITUTION_ALLOWED	VARCHAR2(1) NULL,
							WORK_ORDER_CREATION_ALLOWED	VARCHAR2(1) NULL,
							DELAYED_INV_ALLOC_SUPPORT	VARCHAR2(1) NULL,
							X_DOC_NODE	VARCHAR2(1) NULL,
							USE_END_OF_SHIFT_TIME	VARCHAR2(1) NULL,
							CAN_SHIP_TO_OTHER_ADDRESSES	VARCHAR2(1) NULL,
							CAN_SHIP_TO_ALL_NODES	VARCHAR2(1) NULL,
							NODE_TYPE	VARCHAR2(40) NULL,
							IDENTIFIED_BY_PARENT_AS	VARCHAR2(24) NULL,
							MAX_CONCURRENT_WAVES	NUMBER NULL,
							AGENT_CRITERIA_GROUP	VARCHAR2(40) NULL,
							BOL_PREFIX	VARCHAR2(2) NULL,
							REQUIRE_TRANSFER_ACCEPTANCE	VARCHAR2(1) NULL,
							LOCKID	NUMBER NULL,
							CREATETS	DATE NULL,
							MODIFYTS	DATE NULL,
							CREATEUSERID	VARCHAR2(40) NULL,
							MODIFYUSERID	VARCHAR2(40) NULL,
							CREATEPROGID	VARCHAR2(40) NULL,
							MODIFYPROGID	VARCHAR2(40) NULL,
							RECEIVE_ADJ_RSN_CODE	VARCHAR2(40) NULL,
							PACK_ADJ_RSN_CODE	VARCHAR2(40) NULL,
							SHIP_ADJ_RSN_CODE	VARCHAR2(40) NULL,
							SERIAL_TRCKD_ON_TRANSFER	VARCHAR2(1) NULL,
							SERIAL_TRCKD_IN_SHIPPING	VARCHAR2(1) NULL,
							SERIAL_TRCKD_RECEIVING	VARCHAR2(40) NULL,
							RCPT_PRCSSNG_TIME_FOR_FRWRDNG	NUMBER NULL,
							ALLOW_INV_OPS_WHILE_PHY_CNT	VARCHAR2(1) NULL,
							IS_IBA_ALLOWED	VARCHAR2(1) NULL,
							RESOURCE_PLANNING_ENABLED	VARCHAR2(1) NULL,
							RESOURCE_PLANNING_UOM	VARCHAR2(40) NULL,
							PLANNING_CALENDAR_KEY	VARCHAR2(24) NULL,
							SUPPLY_DEMAND_DIFF_THRESHOLD	NUMBER NULL,
							DEFAULT_PERSON_DAY_HOURS	NUMBER NULL,
							WAVE_SHORTAGE_HANDLING_TYPE	VARCHAR2(40) NULL,
							IS_FULFILLMENT_NODE	VARCHAR2(1) NULL,
							IS_YARD	VARCHAR2(1) NULL,
							DOCK_SCHEDULING	VARCHAR2(20) NULL,
							OVER_ALLOC_ADJ_RSN_CODE	VARCHAR2(40) NULL,
							VOICE_APPL_INSTANCE_KEY	VARCHAR2(24) NULL,
							RCPT_PRCSSNG_TIME_FOR_FUTURE	NUMBER NULL,
							IGNORE_PENDING_ALLOCATION	VARCHAR2(1) NULL,
							ALLOW_GIFT_WRAP	VARCHAR2(1) NULL,
							SOURCE_SYSTEM_OID	NUMBER NULL,
							ODS_CREATE_DATE	DATE NULL,
							ODS_MODIFY_DATE	DATE NULL,
							ODI_ORIGIN		VARCHAR2(100 CHAR) NULL,
							ODI_CONS_NAME	VARCHAR2(35 CHAR) NULL,
							ODI_CONS_TYPE		VARCHAR2(2 CHAR) NULL,
							ODI_PK			VARCHAR2(32 CHAR) PRIMARY KEY,
							ODI_SESS_NO		VARCHAR2(19 CHAR)
						)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 THEN  
         RAISE;  
      END IF;  
END;



&


/*-----------------------------------------------*/
/* TASK No. 52 */
/* delete previous errors */

delete from 	RAX_APP_USER.E$_SHIP_NODE2040001
where	(ODI_ERR_TYPE = 'S'	and 'F' = 'S')
or	(ODI_ERR_TYPE = 'F'	and ODI_ORIGIN = '(2040001)ODS_Project.LOAD_SHIP_NODE_INT')


&


/*-----------------------------------------------*/
/* TASK No. 53 */
/* Create index on PK */

 
/* FLOW CONTROL CREATE THE iNDEX ON THE I$TABLE */
BEGIN  
   EXECUTE IMMEDIATE 'create index 	RAX_APP_USER.I$_SHIP_NODE2040001 on	RAX_APP_USER.I$_SHIP_NODE2040001 (SHIP_NODE_OID)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 and SQLCODE != -01408 THEN  
         RAISE;  
      END IF;  
END;


&


/*-----------------------------------------------*/
/* TASK No. 54 */
/* insert PK errors */

DECLARE
               CheckTable                             VarChar2(60);
               TargetTable                            VarChar2(60);
               VariableCheckTable                     VarChar2(60);

BEGIN
               SELECT 'RAX_APP_USER.I$_SHIP_NODE' INTO CheckTable FROM DUAL;
               SELECT 'ODS_OWN.SHIP_NODE' INTO TargetTable FROM DUAL;

IF CheckTable = TargetTable THEN
   VariableCheckTable := CheckTable; 
ELSE
   VariableCheckTable := CheckTable || '2040001';
END IF;

execute immediate '
insert into RAX_APP_USER.E$_SHIP_NODE2040001
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_ORIGIN,
	ODI_CHECK_DATE,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	SHIP_NODE_OID,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	SOURCE_SYSTEM_OID,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE
)
select	SYS_GUID(),
	:v_sess_no, 
	rowid,
	''F'', 
	''ODI-15064: The primary key SHIP_NODE_PK is not unique.'',
	''(2040001)ODS_Project.LOAD_SHIP_NODE_INT'',
	sysdate,
	''SHIP_NODE_PK'',
	''PK'',	
	SHIP_NODE.SHIP_NODE_OID,
	SHIP_NODE.SHIP_NODE,
	SHIP_NODE.DESCRIPTION,
	SHIP_NODE.SHIPNODE_TYPE,
	SHIP_NODE.DCM_INTEGRATION_REAL_TIME,
	SHIP_NODE.SERIAL_TRACKING,
	SHIP_NODE.TAG_TRACKED_IN_INVENTORY,
	SHIP_NODE.TAG_TRACKED_AT_RECEIPT,
	SHIP_NODE.INTERFACE_TYPE,
	SHIP_NODE.INTERFACE_SUB_TYPE,
	SHIP_NODE.GLN,
	SHIP_NODE.ACTIVATE_FLAG,
	SHIP_NODE.REQUIRES_CHANGE_REQUEST,
	SHIP_NODE.SHIP_NODE_ADDRESS_KEY,
	SHIP_NODE.SUPPLIER_KEY,
	SHIP_NODE.PICKLIST_TYPE,
	SHIP_NODE.TIME_DIFF,
	SHIP_NODE.LATITUDE,
	SHIP_NODE.LONGITUDE,
	SHIP_NODE.SHIP_NODE_CLASS,
	SHIP_NODE.RETURN_CENTER_FLAG,
	SHIP_NODE.ACCEPTANCE_REQUIRED,
	SHIP_NODE.GENERATE_BOL_NUMBER,
	SHIP_NODE.CURRENT_BOL_NUMBER,
	SHIP_NODE.OWNER_TYPE,
	SHIP_NODE.RECEIVING_CALENDAR_KEY,
	SHIP_NODE.SHIPPING_CALENDAR_KEY,
	SHIP_NODE.OWNER_KEY,
	SHIP_NODE.EXPORT_TAXPAYER_ID,
	SHIP_NODE.EXPORT_LICENSE_NO,
	SHIP_NODE.EXPORT_LICENSE_EXP_DATE,
	SHIP_NODE.INVENTORYTYPE,
	SHIP_NODE.DEFAULT_DECLARED_VALUE,
	SHIP_NODE.MAINTAIN_INVENTORY_COST,
	SHIP_NODE.INVENTORY_TRACKED,
	SHIP_NODE.SHIPPING_NODE,
	SHIP_NODE.RECEIVING_NODE,
	SHIP_NODE.RETURNS_NODE,
	SHIP_NODE.THREE_PL_NODE,
	SHIP_NODE.LOCALECODE,
	SHIP_NODE.CONTACT_ADDRESS_KEY,
	SHIP_NODE.RECEIPT_PROCESSING_TIME,
	SHIP_NODE.INHERIT_CONFIG_FROM_SHIPNODE,
	SHIP_NODE.NODE_ORG_CODE,
	SHIP_NODE.MAX_DAYS_TO_SCH_BEFORE,
	SHIP_NODE.PROCURE_TO_SHIP_ALLOWED,
	SHIP_NODE.SUBSTITUTION_ALLOWED,
	SHIP_NODE.WORK_ORDER_CREATION_ALLOWED,
	SHIP_NODE.DELAYED_INV_ALLOC_SUPPORT,
	SHIP_NODE.X_DOC_NODE,
	SHIP_NODE.USE_END_OF_SHIFT_TIME,
	SHIP_NODE.CAN_SHIP_TO_OTHER_ADDRESSES,
	SHIP_NODE.CAN_SHIP_TO_ALL_NODES,
	SHIP_NODE.NODE_TYPE,
	SHIP_NODE.IDENTIFIED_BY_PARENT_AS,
	SHIP_NODE.MAX_CONCURRENT_WAVES,
	SHIP_NODE.AGENT_CRITERIA_GROUP,
	SHIP_NODE.BOL_PREFIX,
	SHIP_NODE.REQUIRE_TRANSFER_ACCEPTANCE,
	SHIP_NODE.LOCKID,
	SHIP_NODE.CREATETS,
	SHIP_NODE.MODIFYTS,
	SHIP_NODE.CREATEUSERID,
	SHIP_NODE.MODIFYUSERID,
	SHIP_NODE.CREATEPROGID,
	SHIP_NODE.MODIFYPROGID,
	SHIP_NODE.RECEIVE_ADJ_RSN_CODE,
	SHIP_NODE.PACK_ADJ_RSN_CODE,
	SHIP_NODE.SHIP_ADJ_RSN_CODE,
	SHIP_NODE.SERIAL_TRCKD_ON_TRANSFER,
	SHIP_NODE.SERIAL_TRCKD_IN_SHIPPING,
	SHIP_NODE.SERIAL_TRCKD_RECEIVING,
	SHIP_NODE.RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	SHIP_NODE.ALLOW_INV_OPS_WHILE_PHY_CNT,
	SHIP_NODE.IS_IBA_ALLOWED,
	SHIP_NODE.RESOURCE_PLANNING_ENABLED,
	SHIP_NODE.RESOURCE_PLANNING_UOM,
	SHIP_NODE.PLANNING_CALENDAR_KEY,
	SHIP_NODE.SUPPLY_DEMAND_DIFF_THRESHOLD,
	SHIP_NODE.DEFAULT_PERSON_DAY_HOURS,
	SHIP_NODE.WAVE_SHORTAGE_HANDLING_TYPE,
	SHIP_NODE.IS_FULFILLMENT_NODE,
	SHIP_NODE.IS_YARD,
	SHIP_NODE.DOCK_SCHEDULING,
	SHIP_NODE.OVER_ALLOC_ADJ_RSN_CODE,
	SHIP_NODE.VOICE_APPL_INSTANCE_KEY,
	SHIP_NODE.RCPT_PRCSSNG_TIME_FOR_FUTURE,
	SHIP_NODE.IGNORE_PENDING_ALLOCATION,
	SHIP_NODE.ALLOW_GIFT_WRAP,
	SHIP_NODE.SOURCE_SYSTEM_OID,
	SHIP_NODE.ODS_CREATE_DATE,
	SHIP_NODE.ODS_MODIFY_DATE
from	'
 || VariableCheckTable || 
' SHIP_NODE 
where	exists  (
		select	SUB1.SHIP_NODE_OID
		from 	' 
|| VariableCheckTable ||
'  SUB1
		where 	SUB1.SHIP_NODE_OID=SHIP_NODE.SHIP_NODE_OID
		group by 	SUB1.SHIP_NODE_OID
		having 	count(1) > 1
		)
';

END;


&


/*-----------------------------------------------*/
/* TASK No. 55 */
/* insert Not Null errors */

insert into RAX_APP_USER.E$_SHIP_NODE2040001
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	SHIP_NODE_OID,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	SOURCE_SYSTEM_OID,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE
)
select
	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15066: The column SHIP_NODE_OID cannot be null.',
	sysdate,
	'(2040001)ODS_Project.LOAD_SHIP_NODE_INT',
	'SHIP_NODE_OID',
	'NN',	
	SHIP_NODE_OID,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	SOURCE_SYSTEM_OID,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE
from	RAX_APP_USER.I$_SHIP_NODE2040001
where	SHIP_NODE_OID is null



&


/*-----------------------------------------------*/
/* TASK No. 56 */
/* insert Not Null errors */

insert into RAX_APP_USER.E$_SHIP_NODE2040001
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	SHIP_NODE_OID,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	SOURCE_SYSTEM_OID,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE
)
select
	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15066: The column SHIP_NODE cannot be null.',
	sysdate,
	'(2040001)ODS_Project.LOAD_SHIP_NODE_INT',
	'SHIP_NODE',
	'NN',	
	SHIP_NODE_OID,
	SHIP_NODE,
	DESCRIPTION,
	SHIPNODE_TYPE,
	DCM_INTEGRATION_REAL_TIME,
	SERIAL_TRACKING,
	TAG_TRACKED_IN_INVENTORY,
	TAG_TRACKED_AT_RECEIPT,
	INTERFACE_TYPE,
	INTERFACE_SUB_TYPE,
	GLN,
	ACTIVATE_FLAG,
	REQUIRES_CHANGE_REQUEST,
	SHIP_NODE_ADDRESS_KEY,
	SUPPLIER_KEY,
	PICKLIST_TYPE,
	TIME_DIFF,
	LATITUDE,
	LONGITUDE,
	SHIP_NODE_CLASS,
	RETURN_CENTER_FLAG,
	ACCEPTANCE_REQUIRED,
	GENERATE_BOL_NUMBER,
	CURRENT_BOL_NUMBER,
	OWNER_TYPE,
	RECEIVING_CALENDAR_KEY,
	SHIPPING_CALENDAR_KEY,
	OWNER_KEY,
	EXPORT_TAXPAYER_ID,
	EXPORT_LICENSE_NO,
	EXPORT_LICENSE_EXP_DATE,
	INVENTORYTYPE,
	DEFAULT_DECLARED_VALUE,
	MAINTAIN_INVENTORY_COST,
	INVENTORY_TRACKED,
	SHIPPING_NODE,
	RECEIVING_NODE,
	RETURNS_NODE,
	THREE_PL_NODE,
	LOCALECODE,
	CONTACT_ADDRESS_KEY,
	RECEIPT_PROCESSING_TIME,
	INHERIT_CONFIG_FROM_SHIPNODE,
	NODE_ORG_CODE,
	MAX_DAYS_TO_SCH_BEFORE,
	PROCURE_TO_SHIP_ALLOWED,
	SUBSTITUTION_ALLOWED,
	WORK_ORDER_CREATION_ALLOWED,
	DELAYED_INV_ALLOC_SUPPORT,
	X_DOC_NODE,
	USE_END_OF_SHIFT_TIME,
	CAN_SHIP_TO_OTHER_ADDRESSES,
	CAN_SHIP_TO_ALL_NODES,
	NODE_TYPE,
	IDENTIFIED_BY_PARENT_AS,
	MAX_CONCURRENT_WAVES,
	AGENT_CRITERIA_GROUP,
	BOL_PREFIX,
	REQUIRE_TRANSFER_ACCEPTANCE,
	LOCKID,
	CREATETS,
	MODIFYTS,
	CREATEUSERID,
	MODIFYUSERID,
	CREATEPROGID,
	MODIFYPROGID,
	RECEIVE_ADJ_RSN_CODE,
	PACK_ADJ_RSN_CODE,
	SHIP_ADJ_RSN_CODE,
	SERIAL_TRCKD_ON_TRANSFER,
	SERIAL_TRCKD_IN_SHIPPING,
	SERIAL_TRCKD_RECEIVING,
	RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	ALLOW_INV_OPS_WHILE_PHY_CNT,
	IS_IBA_ALLOWED,
	RESOURCE_PLANNING_ENABLED,
	RESOURCE_PLANNING_UOM,
	PLANNING_CALENDAR_KEY,
	SUPPLY_DEMAND_DIFF_THRESHOLD,
	DEFAULT_PERSON_DAY_HOURS,
	WAVE_SHORTAGE_HANDLING_TYPE,
	IS_FULFILLMENT_NODE,
	IS_YARD,
	DOCK_SCHEDULING,
	OVER_ALLOC_ADJ_RSN_CODE,
	VOICE_APPL_INSTANCE_KEY,
	RCPT_PRCSSNG_TIME_FOR_FUTURE,
	IGNORE_PENDING_ALLOCATION,
	ALLOW_GIFT_WRAP,
	SOURCE_SYSTEM_OID,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE
from	RAX_APP_USER.I$_SHIP_NODE2040001
where	SHIP_NODE is null



&


/*-----------------------------------------------*/
/* TASK No. 57 */
/* create index on error table */

 
/* FLOW CONTROL CREATE INDEX ON THE E$TABLE */
BEGIN  
   EXECUTE IMMEDIATE 'create index 	RAX_APP_USER.E$_SHIP_NODE2040001 on	RAX_APP_USER.E$_SHIP_NODE2040001 (ODI_ROW_ID)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 and SQLCODE != -01408 THEN  
         RAISE;  
      END IF;  
END;


&


/*-----------------------------------------------*/
/* TASK No. 58 */
/* delete errors from controlled table */

delete from	RAX_APP_USER.I$_SHIP_NODE2040001  T
where	exists 	(
		select	1
		from	RAX_APP_USER.E$_SHIP_NODE2040001 E
		where ODI_SESS_NO = :v_sess_no
		and T.rowid = E.ODI_ROW_ID
		)


&


/*-----------------------------------------------*/
/* TASK No. 59 */
/* insert check sum into check table */

insert into RAX_APP_USER.SNP_CHECK_TAB
(
	SCHEMA_NAME,
	RESOURCE_NAME,
	FULL_RES_NAME,
	ERR_TYPE,
	ERR_MESS,
	CHECK_DATE,
	ORIGIN,
	CONS_NAME,
	CONS_TYPE,
	ERR_COUNT
)
select	
	'ODS_OWN',
	'SHIP_NODE',
	'ODS_OWN.SHIP_NODE2040001',
	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE,
	count(1) 
from	RAX_APP_USER.E$_SHIP_NODE2040001 E
where	E.ODI_ERR_TYPE	= 'F'
and	E.ODI_ORIGIN 	= '(2040001)ODS_Project.LOAD_SHIP_NODE_INT'
group by	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE


&


/*-----------------------------------------------*/
/* TASK No. 60 */
/* Merge Rows */

merge into	ODS_OWN.SHIP_NODE T
using	RAX_APP_USER.I$_SHIP_NODE2040001 S
on	(
		T.SHIP_NODE_OID=S.SHIP_NODE_OID
	)
when matched
then update set
	T.SHIP_NODE	= S.SHIP_NODE,
	T.DESCRIPTION	= S.DESCRIPTION,
	T.SHIPNODE_TYPE	= S.SHIPNODE_TYPE,
	T.DCM_INTEGRATION_REAL_TIME	= S.DCM_INTEGRATION_REAL_TIME,
	T.SERIAL_TRACKING	= S.SERIAL_TRACKING,
	T.TAG_TRACKED_IN_INVENTORY	= S.TAG_TRACKED_IN_INVENTORY,
	T.TAG_TRACKED_AT_RECEIPT	= S.TAG_TRACKED_AT_RECEIPT,
	T.INTERFACE_TYPE	= S.INTERFACE_TYPE,
	T.INTERFACE_SUB_TYPE	= S.INTERFACE_SUB_TYPE,
	T.GLN	= S.GLN,
	T.ACTIVATE_FLAG	= S.ACTIVATE_FLAG,
	T.REQUIRES_CHANGE_REQUEST	= S.REQUIRES_CHANGE_REQUEST,
	T.SHIP_NODE_ADDRESS_KEY	= S.SHIP_NODE_ADDRESS_KEY,
	T.SUPPLIER_KEY	= S.SUPPLIER_KEY,
	T.PICKLIST_TYPE	= S.PICKLIST_TYPE,
	T.TIME_DIFF	= S.TIME_DIFF,
	T.LATITUDE	= S.LATITUDE,
	T.LONGITUDE	= S.LONGITUDE,
	T.SHIP_NODE_CLASS	= S.SHIP_NODE_CLASS,
	T.RETURN_CENTER_FLAG	= S.RETURN_CENTER_FLAG,
	T.ACCEPTANCE_REQUIRED	= S.ACCEPTANCE_REQUIRED,
	T.GENERATE_BOL_NUMBER	= S.GENERATE_BOL_NUMBER,
	T.CURRENT_BOL_NUMBER	= S.CURRENT_BOL_NUMBER,
	T.OWNER_TYPE	= S.OWNER_TYPE,
	T.RECEIVING_CALENDAR_KEY	= S.RECEIVING_CALENDAR_KEY,
	T.SHIPPING_CALENDAR_KEY	= S.SHIPPING_CALENDAR_KEY,
	T.OWNER_KEY	= S.OWNER_KEY,
	T.EXPORT_TAXPAYER_ID	= S.EXPORT_TAXPAYER_ID,
	T.EXPORT_LICENSE_NO	= S.EXPORT_LICENSE_NO,
	T.EXPORT_LICENSE_EXP_DATE	= S.EXPORT_LICENSE_EXP_DATE,
	T.INVENTORYTYPE	= S.INVENTORYTYPE,
	T.DEFAULT_DECLARED_VALUE	= S.DEFAULT_DECLARED_VALUE,
	T.MAINTAIN_INVENTORY_COST	= S.MAINTAIN_INVENTORY_COST,
	T.INVENTORY_TRACKED	= S.INVENTORY_TRACKED,
	T.SHIPPING_NODE	= S.SHIPPING_NODE,
	T.RECEIVING_NODE	= S.RECEIVING_NODE,
	T.RETURNS_NODE	= S.RETURNS_NODE,
	T.THREE_PL_NODE	= S.THREE_PL_NODE,
	T.LOCALECODE	= S.LOCALECODE,
	T.CONTACT_ADDRESS_KEY	= S.CONTACT_ADDRESS_KEY,
	T.RECEIPT_PROCESSING_TIME	= S.RECEIPT_PROCESSING_TIME,
	T.INHERIT_CONFIG_FROM_SHIPNODE	= S.INHERIT_CONFIG_FROM_SHIPNODE,
	T.NODE_ORG_CODE	= S.NODE_ORG_CODE,
	T.MAX_DAYS_TO_SCH_BEFORE	= S.MAX_DAYS_TO_SCH_BEFORE,
	T.PROCURE_TO_SHIP_ALLOWED	= S.PROCURE_TO_SHIP_ALLOWED,
	T.SUBSTITUTION_ALLOWED	= S.SUBSTITUTION_ALLOWED,
	T.WORK_ORDER_CREATION_ALLOWED	= S.WORK_ORDER_CREATION_ALLOWED,
	T.DELAYED_INV_ALLOC_SUPPORT	= S.DELAYED_INV_ALLOC_SUPPORT,
	T.X_DOC_NODE	= S.X_DOC_NODE,
	T.USE_END_OF_SHIFT_TIME	= S.USE_END_OF_SHIFT_TIME,
	T.CAN_SHIP_TO_OTHER_ADDRESSES	= S.CAN_SHIP_TO_OTHER_ADDRESSES,
	T.CAN_SHIP_TO_ALL_NODES	= S.CAN_SHIP_TO_ALL_NODES,
	T.NODE_TYPE	= S.NODE_TYPE,
	T.IDENTIFIED_BY_PARENT_AS	= S.IDENTIFIED_BY_PARENT_AS,
	T.MAX_CONCURRENT_WAVES	= S.MAX_CONCURRENT_WAVES,
	T.AGENT_CRITERIA_GROUP	= S.AGENT_CRITERIA_GROUP,
	T.BOL_PREFIX	= S.BOL_PREFIX,
	T.REQUIRE_TRANSFER_ACCEPTANCE	= S.REQUIRE_TRANSFER_ACCEPTANCE,
	T.LOCKID	= S.LOCKID,
	T.CREATETS	= S.CREATETS,
	T.MODIFYTS	= S.MODIFYTS,
	T.CREATEUSERID	= S.CREATEUSERID,
	T.MODIFYUSERID	= S.MODIFYUSERID,
	T.CREATEPROGID	= S.CREATEPROGID,
	T.MODIFYPROGID	= S.MODIFYPROGID,
	T.RECEIVE_ADJ_RSN_CODE	= S.RECEIVE_ADJ_RSN_CODE,
	T.PACK_ADJ_RSN_CODE	= S.PACK_ADJ_RSN_CODE,
	T.SHIP_ADJ_RSN_CODE	= S.SHIP_ADJ_RSN_CODE,
	T.SERIAL_TRCKD_ON_TRANSFER	= S.SERIAL_TRCKD_ON_TRANSFER,
	T.SERIAL_TRCKD_IN_SHIPPING	= S.SERIAL_TRCKD_IN_SHIPPING,
	T.SERIAL_TRCKD_RECEIVING	= S.SERIAL_TRCKD_RECEIVING,
	T.RCPT_PRCSSNG_TIME_FOR_FRWRDNG	= S.RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	T.ALLOW_INV_OPS_WHILE_PHY_CNT	= S.ALLOW_INV_OPS_WHILE_PHY_CNT,
	T.IS_IBA_ALLOWED	= S.IS_IBA_ALLOWED,
	T.RESOURCE_PLANNING_ENABLED	= S.RESOURCE_PLANNING_ENABLED,
	T.RESOURCE_PLANNING_UOM	= S.RESOURCE_PLANNING_UOM,
	T.PLANNING_CALENDAR_KEY	= S.PLANNING_CALENDAR_KEY,
	T.SUPPLY_DEMAND_DIFF_THRESHOLD	= S.SUPPLY_DEMAND_DIFF_THRESHOLD,
	T.DEFAULT_PERSON_DAY_HOURS	= S.DEFAULT_PERSON_DAY_HOURS,
	T.WAVE_SHORTAGE_HANDLING_TYPE	= S.WAVE_SHORTAGE_HANDLING_TYPE,
	T.IS_FULFILLMENT_NODE	= S.IS_FULFILLMENT_NODE,
	T.IS_YARD	= S.IS_YARD,
	T.DOCK_SCHEDULING	= S.DOCK_SCHEDULING,
	T.OVER_ALLOC_ADJ_RSN_CODE	= S.OVER_ALLOC_ADJ_RSN_CODE,
	T.VOICE_APPL_INSTANCE_KEY	= S.VOICE_APPL_INSTANCE_KEY,
	T.RCPT_PRCSSNG_TIME_FOR_FUTURE	= S.RCPT_PRCSSNG_TIME_FOR_FUTURE,
	T.IGNORE_PENDING_ALLOCATION	= S.IGNORE_PENDING_ALLOCATION,
	T.ALLOW_GIFT_WRAP	= S.ALLOW_GIFT_WRAP,
	T.SOURCE_SYSTEM_OID	= S.SOURCE_SYSTEM_OID
	,                                                                                         T.ODS_MODIFY_DATE	= SYSDATE
when not matched
then insert
	(
	T.SHIP_NODE_OID,
	T.SHIP_NODE,
	T.DESCRIPTION,
	T.SHIPNODE_TYPE,
	T.DCM_INTEGRATION_REAL_TIME,
	T.SERIAL_TRACKING,
	T.TAG_TRACKED_IN_INVENTORY,
	T.TAG_TRACKED_AT_RECEIPT,
	T.INTERFACE_TYPE,
	T.INTERFACE_SUB_TYPE,
	T.GLN,
	T.ACTIVATE_FLAG,
	T.REQUIRES_CHANGE_REQUEST,
	T.SHIP_NODE_ADDRESS_KEY,
	T.SUPPLIER_KEY,
	T.PICKLIST_TYPE,
	T.TIME_DIFF,
	T.LATITUDE,
	T.LONGITUDE,
	T.SHIP_NODE_CLASS,
	T.RETURN_CENTER_FLAG,
	T.ACCEPTANCE_REQUIRED,
	T.GENERATE_BOL_NUMBER,
	T.CURRENT_BOL_NUMBER,
	T.OWNER_TYPE,
	T.RECEIVING_CALENDAR_KEY,
	T.SHIPPING_CALENDAR_KEY,
	T.OWNER_KEY,
	T.EXPORT_TAXPAYER_ID,
	T.EXPORT_LICENSE_NO,
	T.EXPORT_LICENSE_EXP_DATE,
	T.INVENTORYTYPE,
	T.DEFAULT_DECLARED_VALUE,
	T.MAINTAIN_INVENTORY_COST,
	T.INVENTORY_TRACKED,
	T.SHIPPING_NODE,
	T.RECEIVING_NODE,
	T.RETURNS_NODE,
	T.THREE_PL_NODE,
	T.LOCALECODE,
	T.CONTACT_ADDRESS_KEY,
	T.RECEIPT_PROCESSING_TIME,
	T.INHERIT_CONFIG_FROM_SHIPNODE,
	T.NODE_ORG_CODE,
	T.MAX_DAYS_TO_SCH_BEFORE,
	T.PROCURE_TO_SHIP_ALLOWED,
	T.SUBSTITUTION_ALLOWED,
	T.WORK_ORDER_CREATION_ALLOWED,
	T.DELAYED_INV_ALLOC_SUPPORT,
	T.X_DOC_NODE,
	T.USE_END_OF_SHIFT_TIME,
	T.CAN_SHIP_TO_OTHER_ADDRESSES,
	T.CAN_SHIP_TO_ALL_NODES,
	T.NODE_TYPE,
	T.IDENTIFIED_BY_PARENT_AS,
	T.MAX_CONCURRENT_WAVES,
	T.AGENT_CRITERIA_GROUP,
	T.BOL_PREFIX,
	T.REQUIRE_TRANSFER_ACCEPTANCE,
	T.LOCKID,
	T.CREATETS,
	T.MODIFYTS,
	T.CREATEUSERID,
	T.MODIFYUSERID,
	T.CREATEPROGID,
	T.MODIFYPROGID,
	T.RECEIVE_ADJ_RSN_CODE,
	T.PACK_ADJ_RSN_CODE,
	T.SHIP_ADJ_RSN_CODE,
	T.SERIAL_TRCKD_ON_TRANSFER,
	T.SERIAL_TRCKD_IN_SHIPPING,
	T.SERIAL_TRCKD_RECEIVING,
	T.RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	T.ALLOW_INV_OPS_WHILE_PHY_CNT,
	T.IS_IBA_ALLOWED,
	T.RESOURCE_PLANNING_ENABLED,
	T.RESOURCE_PLANNING_UOM,
	T.PLANNING_CALENDAR_KEY,
	T.SUPPLY_DEMAND_DIFF_THRESHOLD,
	T.DEFAULT_PERSON_DAY_HOURS,
	T.WAVE_SHORTAGE_HANDLING_TYPE,
	T.IS_FULFILLMENT_NODE,
	T.IS_YARD,
	T.DOCK_SCHEDULING,
	T.OVER_ALLOC_ADJ_RSN_CODE,
	T.VOICE_APPL_INSTANCE_KEY,
	T.RCPT_PRCSSNG_TIME_FOR_FUTURE,
	T.IGNORE_PENDING_ALLOCATION,
	T.ALLOW_GIFT_WRAP,
	T.SOURCE_SYSTEM_OID
	,                                                                                          T.ODS_CREATE_DATE,
	T.ODS_MODIFY_DATE
	)
values
	(
	S.SHIP_NODE_OID,
	S.SHIP_NODE,
	S.DESCRIPTION,
	S.SHIPNODE_TYPE,
	S.DCM_INTEGRATION_REAL_TIME,
	S.SERIAL_TRACKING,
	S.TAG_TRACKED_IN_INVENTORY,
	S.TAG_TRACKED_AT_RECEIPT,
	S.INTERFACE_TYPE,
	S.INTERFACE_SUB_TYPE,
	S.GLN,
	S.ACTIVATE_FLAG,
	S.REQUIRES_CHANGE_REQUEST,
	S.SHIP_NODE_ADDRESS_KEY,
	S.SUPPLIER_KEY,
	S.PICKLIST_TYPE,
	S.TIME_DIFF,
	S.LATITUDE,
	S.LONGITUDE,
	S.SHIP_NODE_CLASS,
	S.RETURN_CENTER_FLAG,
	S.ACCEPTANCE_REQUIRED,
	S.GENERATE_BOL_NUMBER,
	S.CURRENT_BOL_NUMBER,
	S.OWNER_TYPE,
	S.RECEIVING_CALENDAR_KEY,
	S.SHIPPING_CALENDAR_KEY,
	S.OWNER_KEY,
	S.EXPORT_TAXPAYER_ID,
	S.EXPORT_LICENSE_NO,
	S.EXPORT_LICENSE_EXP_DATE,
	S.INVENTORYTYPE,
	S.DEFAULT_DECLARED_VALUE,
	S.MAINTAIN_INVENTORY_COST,
	S.INVENTORY_TRACKED,
	S.SHIPPING_NODE,
	S.RECEIVING_NODE,
	S.RETURNS_NODE,
	S.THREE_PL_NODE,
	S.LOCALECODE,
	S.CONTACT_ADDRESS_KEY,
	S.RECEIPT_PROCESSING_TIME,
	S.INHERIT_CONFIG_FROM_SHIPNODE,
	S.NODE_ORG_CODE,
	S.MAX_DAYS_TO_SCH_BEFORE,
	S.PROCURE_TO_SHIP_ALLOWED,
	S.SUBSTITUTION_ALLOWED,
	S.WORK_ORDER_CREATION_ALLOWED,
	S.DELAYED_INV_ALLOC_SUPPORT,
	S.X_DOC_NODE,
	S.USE_END_OF_SHIFT_TIME,
	S.CAN_SHIP_TO_OTHER_ADDRESSES,
	S.CAN_SHIP_TO_ALL_NODES,
	S.NODE_TYPE,
	S.IDENTIFIED_BY_PARENT_AS,
	S.MAX_CONCURRENT_WAVES,
	S.AGENT_CRITERIA_GROUP,
	S.BOL_PREFIX,
	S.REQUIRE_TRANSFER_ACCEPTANCE,
	S.LOCKID,
	S.CREATETS,
	S.MODIFYTS,
	S.CREATEUSERID,
	S.MODIFYUSERID,
	S.CREATEPROGID,
	S.MODIFYPROGID,
	S.RECEIVE_ADJ_RSN_CODE,
	S.PACK_ADJ_RSN_CODE,
	S.SHIP_ADJ_RSN_CODE,
	S.SERIAL_TRCKD_ON_TRANSFER,
	S.SERIAL_TRCKD_IN_SHIPPING,
	S.SERIAL_TRCKD_RECEIVING,
	S.RCPT_PRCSSNG_TIME_FOR_FRWRDNG,
	S.ALLOW_INV_OPS_WHILE_PHY_CNT,
	S.IS_IBA_ALLOWED,
	S.RESOURCE_PLANNING_ENABLED,
	S.RESOURCE_PLANNING_UOM,
	S.PLANNING_CALENDAR_KEY,
	S.SUPPLY_DEMAND_DIFF_THRESHOLD,
	S.DEFAULT_PERSON_DAY_HOURS,
	S.WAVE_SHORTAGE_HANDLING_TYPE,
	S.IS_FULFILLMENT_NODE,
	S.IS_YARD,
	S.DOCK_SCHEDULING,
	S.OVER_ALLOC_ADJ_RSN_CODE,
	S.VOICE_APPL_INSTANCE_KEY,
	S.RCPT_PRCSSNG_TIME_FOR_FUTURE,
	S.IGNORE_PENDING_ALLOCATION,
	S.ALLOW_GIFT_WRAP,
	S.SOURCE_SYSTEM_OID
	,                                                                                          SYSDATE,
	SYSDATE
	)

&


/*-----------------------------------------------*/
/* TASK No. 61 */
/* Commit transaction */

/*commit*/


/*-----------------------------------------------*/
/* TASK No. 62 */
/* Drop flow table */

drop table RAX_APP_USER.I$_SHIP_NODE2040001 

&


/*-----------------------------------------------*/
/* TASK No. 63 */
/* Update CDC Load Status */

UPDATE ODS_OWN.ODS_CDC_LOAD_STATUS
SET LAST_CDC_COMPLETION_DATE=TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
+ nvl((TIMEZONE_OFFSET/24), 0) 
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env

/*
UPDATE ODS_OWN.ODS_CDC_LOAD_STATUS
SET LAST_CDC_COMPLETION_DATE=TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env
*/

&


/*-----------------------------------------------*/
/* TASK No. 64 */
/* Insert CDC Audit Record */

INSERT INTO RAX_APP_USER.ODS_CDC_LOAD_STATUS_AUDIT
(TABLE_NAME,
SESS_NO,                      
SESS_NAME,                    
SCEN_VERSION,                 
SESS_BEG,                     
ORIG_LAST_CDC_COMPLETION_DATE,
OVERLAP,
CREATE_DATE,
CONTEXT_NAME,
TIMEZONE_OFFSET              
)
select 
:v_cdc_load_table_name
,:v_sess_no
,'LOAD_SHIP_NODE_PKG'
,'001'
,TO_DATE(SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
,TO_DATE (SUBSTR(:v_cdc_load_date, 1, 19),'YYYY-MM-DD HH24:MI:SS')
,:v_cdc_overlap
,SYSDATE
,:v_env
,TIMEZONE_OFFSET
from 
ODS_OWN.ODS_CDC_LOAD_STATUS
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env

/*
INSERT INTO RAX_APP_USER.ODS_CDC_LOAD_STATUS_AUDIT
(TABLE_NAME,
SESS_NO,                      
SESS_NAME,                    
SCEN_VERSION,                 
SESS_BEG,                     
ORIG_LAST_CDC_COMPLETION_DATE,
OVERLAP,
CREATE_DATE,
CONTEXT_NAME              
)
values (
:v_cdc_load_table_name,
:v_sess_no,
'LOAD_SHIP_NODE_PKG',
'001',
TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS'),
TO_DATE (SUBSTR (:v_cdc_load_date, 1, 19),
                           'YYYY-MM-DD HH24:MI:SS'
                          )
,:v_cdc_overlap,
SYSDATE,
 :v_env)
*/


&


/*-----------------------------------------------*/
