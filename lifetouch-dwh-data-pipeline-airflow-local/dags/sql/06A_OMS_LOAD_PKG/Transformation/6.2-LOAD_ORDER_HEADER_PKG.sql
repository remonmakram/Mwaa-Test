/*-----------------------------------------------*/
/* TASK No. 20 */

/* NONE or SET VARIABLE STATEMENT FOUND, CHECK ODI TASK NO. 20 */




/*-----------------------------------------------*/
/* TASK No. 21 */

/* SELECT STATEMENT FOUND, CHECK ODI TASK NO. 21 */




/*-----------------------------------------------*/
/* TASK No. 22 */

/* SELECT STATEMENT FOUND, CHECK ODI TASK NO. 22 */




/*-----------------------------------------------*/
/* TASK No. 23 */

/* SELECT STATEMENT FOUND, CHECK ODI TASK NO. 23 */

/*-----------------------------------------------*/
/* TASK No. 24 */
/* Drop work table */

-- drop table RAX_APP_USER.C$_0STG_ORDER_HEADER 

-- &


-- /*-----------------------------------------------*/
-- /* TASK No. 25 */
-- /* Create work table */

-- create table RAX_APP_USER.C$_0STG_ORDER_HEADER
-- (
-- 	C1_TOTAL_AMOUNT	NUMBER(15,2) NULL,
-- 	C2_IS_LINE_SHIP_COMPLETE	CHAR(1) NULL,
-- 	C3_HOLD_FLAG	CHAR(1) NULL,
-- 	C4_ENTERED_BY	VARCHAR2(254) NULL,
-- 	C5_EXTN_ORDERS_SIT_TYPE	VARCHAR2(15) NULL,
-- 	C6_MODIFYPROGID	VARCHAR2(40) NULL,
-- 	C7_SHIP_NODE	CHAR(24) NULL,
-- 	C8_SEARCH_CRITERIA_1	VARCHAR2(100) NULL,
-- 	C9_EXTN_EXTERNAL_REF_ID	VARCHAR2(16) NULL,
-- 	C10_EXTN_SUBJECT_MIDDLENAME	VARCHAR2(255) NULL,
-- 	C11_EXTN_SIT_PART_NUMBER	VARCHAR2(20) NULL,
-- 	C12_ENTERPRISE_CURRENCY	VARCHAR2(20) NULL,
-- 	C13_REQ_SHIP_DATE	DATE NULL,
-- 	C14_BUYER_RECEIVING_NODE_ID	CHAR(24) NULL,
-- 	C15_CHARGE_ACTUAL_FREIGHT	CHAR(1) NULL,
-- 	C16_INVOICE_COMPLETE	CHAR(1) NULL,
-- 	C17_PRIORITY_NUMBER	NUMBER(10) NULL,
-- 	C18_EXTN_CSR_CODE	VARCHAR2(20) NULL,
-- 	C19_EXTN_ORDER_SUBPROGRAM_TYPE	VARCHAR2(20) NULL,
-- 	C20_ORIGINAL_TAX	NUMBER(15,2) NULL,
-- 	C21_SEARCH_CRITERIA_2	VARCHAR2(100) NULL,
-- 	C22_EXTN_PROMISED_BALANCE	NUMBER(8,2) NULL,
-- 	C23_NEXT_ALERT_TS	DATE NULL,
-- 	C24_AUTHORIZATION_EXPIRATION_D	DATE NULL,
-- 	C25_PERSONALIZE_CODE	VARCHAR2(20) NULL,
-- 	C26_EXTN_ORDER_PROGRAM_TYPE	VARCHAR2(20) NULL,
-- 	C27_EXTN_ORDER_PART_NUMBER	VARCHAR2(20) NULL,
-- 	C28_ORDER_CLOSED	CHAR(1) NULL,
-- 	C29_DIVISION	VARCHAR2(10) NULL,
-- 	C30_REQ_CANCEL_DATE	DATE NULL,
-- 	C31_REPORTING_CONVERSION_RATE	NUMBER(28,16) NULL,
-- 	C32_EXTN_VALUEPLUS_PAID	CHAR(1) NULL,
-- 	C33_SALE_VOIDED	CHAR(1) NULL,
-- 	C34_PRICE_PROGRAM_KEY	CHAR(24) NULL,
-- 	C35_EXTN_SESSION_ID	VARCHAR2(100) NULL,
-- 	C36_EXTN_ORDER_STUDIO_CODE	VARCHAR2(24) NULL,
-- 	C37_REPORTING_CONVERSION_DATE	DATE NULL,
-- 	C38_DEPARTMENT_CODE	VARCHAR2(20) NULL,
-- 	C39_TOTAL_ADJUSTMENT_AMOUNT	NUMBER(15,2) NULL,
-- 	C40_PURGE_HISTORY_DATE	DATE NULL,
-- 	C41_HRS_BEFORE_NEXT_ITER	NUMBER(14,4) NULL,
-- 	C42_HAS_DERIVED_CHILD	CHAR(1) NULL,
-- 	C43_ORDER_TYPE	VARCHAR2(20) NULL,
-- 	C44_SOURCE_KEY	NUMBER(20) NULL,
-- 	C45_EXTN_RETOUCHING	VARCHAR2(15) NULL,
-- 	C46_CUSTOMER_EMAILID	VARCHAR2(150) NULL,
-- 	C47_HAS_DERIVED_PARENT	CHAR(1) NULL,
-- 	C48_PRIORITY_CODE	VARCHAR2(256) NULL,
-- 	C49_PURPOSE	VARCHAR2(40) NULL,
-- 	C50_BILL_TO_KEY	CHAR(24) NULL,
-- 	C51_TAX_EXEMPT_FLAG	CHAR(1) NULL,
-- 	C52_OPTIMIZATION_TYPE	CHAR(2) NULL,
-- 	C53_BUYER_ORGANIZATION_CODE	CHAR(24) NULL,
-- 	C54_BUYER_USER_ID	VARCHAR2(60) NULL,
-- 	C55_DELIVERY_CODE	VARCHAR2(40) NULL,
-- 	C56_CUSTCARRIER_ACCOUNT_NO	VARCHAR2(40) NULL,
-- 	C57_EXTN_PROTECTIVE_FINISH	CHAR(1) NULL,
-- 	C58_CURRENCY	VARCHAR2(20) NULL,
-- 	C59_EXTN_INSTALLMENT_PAYMENT_P	CHAR(1) NULL,
-- 	C60_EXTN_ORDER_APO_KEY	VARCHAR2(24) NULL,
-- 	C61_SOURCING_CLASSIFICATION	VARCHAR2(40) NULL,
-- 	C62_BILL_TO_ID	VARCHAR2(40) NULL,
-- 	C63_EXTN_FOLIO_COUNTER	NUMBER(5,2) NULL,
-- 	C64_CUSTOMER_PO_NO	VARCHAR2(100) NULL,
-- 	C65_DOCUMENT_TYPE	VARCHAR2(40) NULL,
-- 	C66_MODIFYUSERID	VARCHAR2(40) NULL,
-- 	C67_EXTN_SUBJECT_KEY	VARCHAR2(24) NULL,
-- 	C68_NOTIFY_AFTER_SHIPMENT_FLAG	CHAR(1) NULL,
-- 	C69_EXTN_SUBJECT_LASTNAME	VARCHAR2(255) NULL,
-- 	C70_RETURN_OH_KEY_FOR_EXCHANGE	CHAR(24) NULL,
-- 	C71_EXTN_SHIP_ORDERS_TO	VARCHAR2(15) NULL,
-- 	C72_VENDOR_ID	CHAR(24) NULL,
-- 	C73_CONTACT_KEY	CHAR(24) NULL,
-- 	C74_TAX	NUMBER(15,2) NULL,
-- 	C75_RECEIVING_NODE	CHAR(24) NULL,
-- 	C76_TAX_EXEMPTION_CERTIFICATE	VARCHAR2(40) NULL,
-- 	C77_CREATETS	DATE NULL,
-- 	C78_PAYMENT_STATUS	CHAR(15) NULL,
-- 	C79_EXTN_DIE_CUT	CHAR(1) NULL,
-- 	C80_EXCHANGE_TYPE	VARCHAR2(40) NULL,
-- 	C81_CREATEPROGID	VARCHAR2(40) NULL,
-- 	C82_EXTN_ORDER_ACCOUNT_NAME	VARCHAR2(40) NULL,
-- 	C83_EXTN_OVERRIDE_1	CHAR(1) NULL,
-- 	C84_EXTN_SUBJECT_FIRSTNAME	VARCHAR2(255) NULL,
-- 	C85_EXTN_BATCH_ID	VARCHAR2(40) NULL,
-- 	C86_SOLD_TO_KEY	CHAR(24) NULL,
-- 	C87_MARK_FOR_KEY	CHAR(24) NULL,
-- 	C88_SHIP_TO_ID	VARCHAR2(40) NULL,
-- 	C89_TERMS_CODE	VARCHAR2(20) NULL,
-- 	C90_ADJUSTMENT_INVOICE_PENDING	CHAR(1) NULL,
-- 	C91_DEFAULT_TEMPLATE	CHAR(1) NULL,
-- 	C92_ENTRY_TYPE	VARCHAR2(20) NULL,
-- 	C93_TEAM_CODE	VARCHAR2(40) NULL,
-- 	C94_CREATED_AT_NODE	CHAR(1) NULL,
-- 	C95_ORDER_NO	CHAR(40) NULL,
-- 	C96_EXTN_PHOTOGRAPHY_LOCATION	VARCHAR2(15) NULL,
-- 	C97_ORDER_HEADER_KEY	CHAR(24) NULL,
-- 	C98_RETURN_BY_GIFT_RECIPIENT	CHAR(1) NULL,
-- 	C99_ORDER_DATE	DATE NULL,
-- 	C100_ORDER_NAME	VARCHAR2(100) NULL,
-- 	C101_SHIP_TO_KEY	CHAR(24) NULL,
-- 	C102_MODIFYTS	DATE NULL,
-- 	C103_NOTIFICATION_TYPE	VARCHAR2(20) NULL,
-- 	C104_AUTO_CANCEL_DATE	DATE NULL,
-- 	C105_ALLOCATION_RULE_ID	CHAR(10) NULL,
-- 	C106_EXTN_SPECIAL_INSTRUCTIONS	VARCHAR2(500) NULL,
-- 	C107_BUYER_MARK_FOR_NODE_ID	CHAR(24) NULL,
-- 	C108_IS_LINE_SHIP_SINGLE_NODE	CHAR(1) NULL,
-- 	C109_EXTN_COD_RELEASE_NO	NUMBER(5) NULL,
-- 	C110_CREATEUSERID	VARCHAR2(40) NULL,
-- 	C111_EXTN_VALUEPLUS	CHAR(1) NULL,
-- 	C112_CHAIN_TYPE	VARCHAR2(40) NULL,
-- 	C113_TAXPAYER_ID	VARCHAR2(40) NULL,
-- 	C114_SOURCE_TYPE	VARCHAR2(40) NULL,
-- 	C115_EXTN_LINEN_TEXTURE	CHAR(1) NULL,
-- 	C116_TAX_JURISDICTION	VARCHAR2(40) NULL,
-- 	C117_NOTIFICATION_REFERENCE	VARCHAR2(100) NULL,
-- 	C118_PRICING_CLASSIFICATION_CO	NUMBER(20) NULL,
-- 	C119_OTHER_CHARGES	NUMBER(15,2) NULL,
-- 	C120_ORDER_PURPOSE	VARCHAR2(20) NULL,
-- 	C121_ORIGINAL_TOTAL_AMOUNT	NUMBER(15,2) NULL,
-- 	C122_DRAFT_ORDER_FLAG	CHAR(1) NULL,
-- 	C123_EXTN_ORDER_PROCESSING_LAB	VARCHAR2(24) NULL,
-- 	C124_HOLD_REASON_CODE	VARCHAR2(40) NULL,
-- 	C125_EXTN_EVENT_REF_ID	VARCHAR2(10) NULL,
-- 	C126_FOB	VARCHAR2(40) NULL,
-- 	C127_RECREATE_AUTHORIZATIONS	CHAR(1) NULL,
-- 	C128_SELLER_ORGANIZATION_CODE	CHAR(24) NULL,
-- 	C129_PENDING_TRANSFER_IN	NUMBER(15,2) NULL,
-- 	C130_ORIGINAL_CONTAINER_KEY	NUMBER(20) NULL,
-- 	C131_IS_SHIP_COMPLETE	CHAR(1) NULL,
-- 	C132_ENTERPRISE_KEY	CHAR(24) NULL,
-- 	C133_REQ_DELIVERY_DATE	DATE NULL,
-- 	C134_CARRIER_SERVICE_CODE	VARCHAR2(40) NULL,
-- 	C135_DO_NOT_CONSOLIDATE	CHAR(1) NULL,
-- 	C136_CANCEL_ORDER_ON_EXCP_FLAG	CHAR(1) NULL,
-- 	C137_CUSTOMER_CUSTOMER_PO_NO	VARCHAR2(100) NULL,
-- 	C138_NEXT_ITER_SEQ_NO	NUMBER(10) NULL,
-- 	C139_EXTN_ORDER_ELECTRONIC_ORD	CHAR(1) NULL,
-- 	C140_NEXT_ITER_DATE	DATE NULL,
-- 	C141_PAYMENT_RULE_ID	VARCHAR2(20) NULL,
-- 	C142_LOCKID	NUMBER(5) NULL,
-- 	C143_IS_SHIP_SINGLE_NODE	CHAR(1) NULL,
-- 	C144_SCAC	VARCHAR2(40) NULL,
-- 	C145_EXTN_LAST_USER_MODIFIED_D	DATE NULL,
-- 	C146_EXTN_REQ_SHIP_DATE	DATE NULL,
-- 	C147_EXTN_SUBJECT_GRADE	VARCHAR2(255) NULL,
-- 	C148_EXTN_ORDER_STATUS	VARCHAR2(100) NULL,
-- 	C149_EXTN_RETAKE_NO	VARCHAR2(100) NULL,
-- 	C150_EXTN_DONTRELEASEUNTIL_DAT	DATE NULL,
-- 	C151_EXTN_PARENT_RETAKE_NO	VARCHAR2(100) NULL,
-- 	C152_EXTN_BATCHING_REQUIRED	CHAR(1) NULL,
-- 	C153_EXTN_PRICE_PROGRAM	VARCHAR2(50) NULL,
-- 	C154_EXTN_PARENT_ORDER_HEADER_	VARCHAR2(40) NULL,
-- 	C155_EXTN_SHUTTERFLYNOTE_ELIGI	CHAR(1) NULL,
-- 	C156_EXTN_CANCEL_COMMENT	VARCHAR2(300) NULL,
-- 	C157_EXTN_REPLAYED_WOB	VARCHAR2(40) NULL
-- )
-- NOLOGGING

-- &


-- /*-----------------------------------------------*/
-- /* TASK No. 26 */
-- /* Load data */

-- /* SOURCE CODE */
-- select	
-- 	OH.TOTAL_AMOUNT	   C1_TOTAL_AMOUNT,
-- 	OH.IS_LINE_SHIP_COMPLETE	   C2_IS_LINE_SHIP_COMPLETE,
-- 	OH.HOLD_FLAG	   C3_HOLD_FLAG,
-- 	OH.ENTERED_BY	   C4_ENTERED_BY,
-- 	OH.EXTN_ORDERS_SIT_TYPE	   C5_EXTN_ORDERS_SIT_TYPE,
-- 	OH.MODIFYPROGID	   C6_MODIFYPROGID,
-- 	OH.SHIP_NODE	   C7_SHIP_NODE,
-- 	OH.SEARCH_CRITERIA_1	   C8_SEARCH_CRITERIA_1,
-- 	OH.EXTN_EXTERNAL_REF_ID	   C9_EXTN_EXTERNAL_REF_ID,
-- 	OH.EXTN_SUBJECT_MIDDLENAME	   C10_EXTN_SUBJECT_MIDDLENAME,
-- 	OH.EXTN_SIT_PART_NUMBER	   C11_EXTN_SIT_PART_NUMBER,
-- 	OH.ENTERPRISE_CURRENCY	   C12_ENTERPRISE_CURRENCY,
-- 	OH.REQ_SHIP_DATE	   C13_REQ_SHIP_DATE,
-- 	OH.BUYER_RECEIVING_NODE_ID	   C14_BUYER_RECEIVING_NODE_ID,
-- 	OH.CHARGE_ACTUAL_FREIGHT	   C15_CHARGE_ACTUAL_FREIGHT,
-- 	OH.INVOICE_COMPLETE	   C16_INVOICE_COMPLETE,
-- 	OH.PRIORITY_NUMBER	   C17_PRIORITY_NUMBER,
-- 	OH.EXTN_CSR_CODE	   C18_EXTN_CSR_CODE,
-- 	OH.EXTN_ORDER_SUBPROGRAM_TYPE	   C19_EXTN_ORDER_SUBPROGRAM_TYPE,
-- 	OH.ORIGINAL_TAX	   C20_ORIGINAL_TAX,
-- 	OH.SEARCH_CRITERIA_2	   C21_SEARCH_CRITERIA_2,
-- 	OH.EXTN_PROMISED_BALANCE	   C22_EXTN_PROMISED_BALANCE,
-- 	OH.NEXT_ALERT_TS	   C23_NEXT_ALERT_TS,
-- 	OH.AUTHORIZATION_EXPIRATION_DATE	   C24_AUTHORIZATION_EXPIRATION_D,
-- 	OH.PERSONALIZE_CODE	   C25_PERSONALIZE_CODE,
-- 	OH.EXTN_ORDER_PROGRAM_TYPE	   C26_EXTN_ORDER_PROGRAM_TYPE,
-- 	OH.EXTN_ORDER_PART_NUMBER	   C27_EXTN_ORDER_PART_NUMBER,
-- 	OH.ORDER_CLOSED	   C28_ORDER_CLOSED,
-- 	OH.DIVISION	   C29_DIVISION,
-- 	OH.REQ_CANCEL_DATE	   C30_REQ_CANCEL_DATE,
-- 	OH.REPORTING_CONVERSION_RATE	   C31_REPORTING_CONVERSION_RATE,
-- 	OH.EXTN_VALUEPLUS_PAID	   C32_EXTN_VALUEPLUS_PAID,
-- 	OH.SALE_VOIDED	   C33_SALE_VOIDED,
-- 	OH.PRICE_PROGRAM_KEY	   C34_PRICE_PROGRAM_KEY,
-- 	OH.EXTN_SESSION_ID	   C35_EXTN_SESSION_ID,
-- 	OH.EXTN_ORDER_STUDIO_CODE	   C36_EXTN_ORDER_STUDIO_CODE,
-- 	OH.REPORTING_CONVERSION_DATE	   C37_REPORTING_CONVERSION_DATE,
-- 	OH.DEPARTMENT_CODE	   C38_DEPARTMENT_CODE,
-- 	OH.TOTAL_ADJUSTMENT_AMOUNT	   C39_TOTAL_ADJUSTMENT_AMOUNT,
-- 	OH.PURGE_HISTORY_DATE	   C40_PURGE_HISTORY_DATE,
-- 	OH.HRS_BEFORE_NEXT_ITER	   C41_HRS_BEFORE_NEXT_ITER,
-- 	OH.HAS_DERIVED_CHILD	   C42_HAS_DERIVED_CHILD,
-- 	OH.ORDER_TYPE	   C43_ORDER_TYPE,
-- 	OH.SOURCE_KEY	   C44_SOURCE_KEY,
-- 	OH.EXTN_RETOUCHING	   C45_EXTN_RETOUCHING,
-- 	OH.CUSTOMER_EMAILID	   C46_CUSTOMER_EMAILID,
-- 	OH.HAS_DERIVED_PARENT	   C47_HAS_DERIVED_PARENT,
-- 	OH.PRIORITY_CODE	   C48_PRIORITY_CODE,
-- 	OH.PURPOSE	   C49_PURPOSE,
-- 	OH.BILL_TO_KEY	   C50_BILL_TO_KEY,
-- 	OH.TAX_EXEMPT_FLAG	   C51_TAX_EXEMPT_FLAG,
-- 	OH.OPTIMIZATION_TYPE	   C52_OPTIMIZATION_TYPE,
-- 	OH.BUYER_ORGANIZATION_CODE	   C53_BUYER_ORGANIZATION_CODE,
-- 	OH.BUYER_USER_ID	   C54_BUYER_USER_ID,
-- 	OH.DELIVERY_CODE	   C55_DELIVERY_CODE,
-- 	OH.CUSTCARRIER_ACCOUNT_NO	   C56_CUSTCARRIER_ACCOUNT_NO,
-- 	OH.EXTN_PROTECTIVE_FINISH	   C57_EXTN_PROTECTIVE_FINISH,
-- 	OH.CURRENCY	   C58_CURRENCY,
-- 	OH.EXTN_INSTALLMENT_PAYMENT_PLAN	   C59_EXTN_INSTALLMENT_PAYMENT_P,
-- 	OH.EXTN_ORDER_APO_KEY	   C60_EXTN_ORDER_APO_KEY,
-- 	OH.SOURCING_CLASSIFICATION	   C61_SOURCING_CLASSIFICATION,
-- 	OH.BILL_TO_ID	   C62_BILL_TO_ID,
-- 	OH.EXTN_FOLIO_COUNTER	   C63_EXTN_FOLIO_COUNTER,
-- 	trim(OH.CUSTOMER_PO_NO)	   C64_CUSTOMER_PO_NO,
-- 	OH.DOCUMENT_TYPE	   C65_DOCUMENT_TYPE,
-- 	OH.MODIFYUSERID	   C66_MODIFYUSERID,
-- 	OH.EXTN_SUBJECT_KEY	   C67_EXTN_SUBJECT_KEY,
-- 	OH.NOTIFY_AFTER_SHIPMENT_FLAG	   C68_NOTIFY_AFTER_SHIPMENT_FLAG,
-- 	OH.EXTN_SUBJECT_LASTNAME	   C69_EXTN_SUBJECT_LASTNAME,
-- 	OH.RETURN_OH_KEY_FOR_EXCHANGE	   C70_RETURN_OH_KEY_FOR_EXCHANGE,
-- 	OH.EXTN_SHIP_ORDERS_TO	   C71_EXTN_SHIP_ORDERS_TO,
-- 	OH.VENDOR_ID	   C72_VENDOR_ID,
-- 	OH.CONTACT_KEY	   C73_CONTACT_KEY,
-- 	OH.TAX	   C74_TAX,
-- 	OH.RECEIVING_NODE	   C75_RECEIVING_NODE,
-- 	OH.TAX_EXEMPTION_CERTIFICATE	   C76_TAX_EXEMPTION_CERTIFICATE,
-- 	OH.CREATETS	   C77_CREATETS,
-- 	OH.PAYMENT_STATUS	   C78_PAYMENT_STATUS,
-- 	OH.EXTN_DIE_CUT	   C79_EXTN_DIE_CUT,
-- 	OH.EXCHANGE_TYPE	   C80_EXCHANGE_TYPE,
-- 	OH.CREATEPROGID	   C81_CREATEPROGID,
-- 	OH.EXTN_ORDER_ACCOUNT_NAME	   C82_EXTN_ORDER_ACCOUNT_NAME,
-- 	OH.EXTN_OVERRIDE_1	   C83_EXTN_OVERRIDE_1,
-- 	OH.EXTN_SUBJECT_FIRSTNAME	   C84_EXTN_SUBJECT_FIRSTNAME,
-- 	OH.EXTN_BATCH_ID	   C85_EXTN_BATCH_ID,
-- 	OH.SOLD_TO_KEY	   C86_SOLD_TO_KEY,
-- 	OH.MARK_FOR_KEY	   C87_MARK_FOR_KEY,
-- 	OH.SHIP_TO_ID	   C88_SHIP_TO_ID,
-- 	OH.TERMS_CODE	   C89_TERMS_CODE,
-- 	OH.ADJUSTMENT_INVOICE_PENDING	   C90_ADJUSTMENT_INVOICE_PENDING,
-- 	OH.DEFAULT_TEMPLATE	   C91_DEFAULT_TEMPLATE,
-- 	OH.ENTRY_TYPE	   C92_ENTRY_TYPE,
-- 	OH.TEAM_CODE	   C93_TEAM_CODE,
-- 	OH.CREATED_AT_NODE	   C94_CREATED_AT_NODE,
-- 	OH.ORDER_NO	   C95_ORDER_NO,
-- 	OH.EXTN_PHOTOGRAPHY_LOCATION	   C96_EXTN_PHOTOGRAPHY_LOCATION,
-- 	OH.ORDER_HEADER_KEY	   C97_ORDER_HEADER_KEY,
-- 	OH.RETURN_BY_GIFT_RECIPIENT	   C98_RETURN_BY_GIFT_RECIPIENT,
-- 	OH.ORDER_DATE	   C99_ORDER_DATE,
-- 	OH.ORDER_NAME	   C100_ORDER_NAME,
-- 	OH.SHIP_TO_KEY	   C101_SHIP_TO_KEY,
-- 	OH.MODIFYTS	   C102_MODIFYTS,
-- 	OH.NOTIFICATION_TYPE	   C103_NOTIFICATION_TYPE,
-- 	OH.AUTO_CANCEL_DATE	   C104_AUTO_CANCEL_DATE,
-- 	OH.ALLOCATION_RULE_ID	   C105_ALLOCATION_RULE_ID,
-- 	OH.EXTN_SPECIAL_INSTRUCTIONS	   C106_EXTN_SPECIAL_INSTRUCTIONS,
-- 	OH.BUYER_MARK_FOR_NODE_ID	   C107_BUYER_MARK_FOR_NODE_ID,
-- 	OH.IS_LINE_SHIP_SINGLE_NODE	   C108_IS_LINE_SHIP_SINGLE_NODE,
-- 	OH.EXTN_COD_RELEASE_NO	   C109_EXTN_COD_RELEASE_NO,
-- 	OH.CREATEUSERID	   C110_CREATEUSERID,
-- 	OH.EXTN_VALUEPLUS	   C111_EXTN_VALUEPLUS,
-- 	OH.CHAIN_TYPE	   C112_CHAIN_TYPE,
-- 	OH.TAXPAYER_ID	   C113_TAXPAYER_ID,
-- 	OH.SOURCE_TYPE	   C114_SOURCE_TYPE,
-- 	OH.EXTN_LINEN_TEXTURE	   C115_EXTN_LINEN_TEXTURE,
-- 	OH.TAX_JURISDICTION	   C116_TAX_JURISDICTION,
-- 	OH.NOTIFICATION_REFERENCE	   C117_NOTIFICATION_REFERENCE,
-- 	OH.PRICING_CLASSIFICATION_CODE	   C118_PRICING_CLASSIFICATION_CO,
-- 	OH.OTHER_CHARGES	   C119_OTHER_CHARGES,
-- 	OH.ORDER_PURPOSE	   C120_ORDER_PURPOSE,
-- 	OH.ORIGINAL_TOTAL_AMOUNT	   C121_ORIGINAL_TOTAL_AMOUNT,
-- 	OH.DRAFT_ORDER_FLAG	   C122_DRAFT_ORDER_FLAG,
-- 	OH.EXTN_ORDER_PROCESSING_LAB	   C123_EXTN_ORDER_PROCESSING_LAB,
-- 	OH.HOLD_REASON_CODE	   C124_HOLD_REASON_CODE,
-- 	OH.EXTN_EVENT_REF_ID	   C125_EXTN_EVENT_REF_ID,
-- 	OH.FOB	   C126_FOB,
-- 	OH.RECREATE_AUTHORIZATIONS	   C127_RECREATE_AUTHORIZATIONS,
-- 	OH.SELLER_ORGANIZATION_CODE	   C128_SELLER_ORGANIZATION_CODE,
-- 	OH.PENDING_TRANSFER_IN	   C129_PENDING_TRANSFER_IN,
-- 	OH.ORIGINAL_CONTAINER_KEY	   C130_ORIGINAL_CONTAINER_KEY,
-- 	OH.IS_SHIP_COMPLETE	   C131_IS_SHIP_COMPLETE,
-- 	OH.ENTERPRISE_KEY	   C132_ENTERPRISE_KEY,
-- 	OH.REQ_DELIVERY_DATE	   C133_REQ_DELIVERY_DATE,
-- 	OH.CARRIER_SERVICE_CODE	   C134_CARRIER_SERVICE_CODE,
-- 	OH.DO_NOT_CONSOLIDATE	   C135_DO_NOT_CONSOLIDATE,
-- 	OH.CANCEL_ORDER_ON_EXCP_FLAG	   C136_CANCEL_ORDER_ON_EXCP_FLAG,
-- 	OH.CUSTOMER_CUSTOMER_PO_NO	   C137_CUSTOMER_CUSTOMER_PO_NO,
-- 	OH.NEXT_ITER_SEQ_NO	   C138_NEXT_ITER_SEQ_NO,
-- 	OH.EXTN_ORDER_ELECTRONIC_ORDER	   C139_EXTN_ORDER_ELECTRONIC_ORD,
-- 	OH.NEXT_ITER_DATE	   C140_NEXT_ITER_DATE,
-- 	OH.PAYMENT_RULE_ID	   C141_PAYMENT_RULE_ID,
-- 	OH.LOCKID	   C142_LOCKID,
-- 	OH.IS_SHIP_SINGLE_NODE	   C143_IS_SHIP_SINGLE_NODE,
-- 	OH.SCAC	   C144_SCAC,
-- 	OH.EXTN_LAST_USER_MODIFIED_DATE	   C145_EXTN_LAST_USER_MODIFIED_D,
-- 	OH.EXTN_REQ_SHIP_DATE	   C146_EXTN_REQ_SHIP_DATE,
-- 	OH.EXTN_SUBJECT_GRADE	   C147_EXTN_SUBJECT_GRADE,
-- 	OH.EXTN_ORDER_STATUS	   C148_EXTN_ORDER_STATUS,
-- 	OH.EXTN_RETAKE_NO	   C149_EXTN_RETAKE_NO,
-- 	OH.EXTN_DONTRELEASEUNTIL_DATE	   C150_EXTN_DONTRELEASEUNTIL_DAT,
-- 	OH.EXTN_PARENT_RETAKE_NO	   C151_EXTN_PARENT_RETAKE_NO,
-- 	OH.EXTN_BATCHING_REQUIRED	   C152_EXTN_BATCHING_REQUIRED,
-- 	OH.EXTN_PRICE_PROGRAM	   C153_EXTN_PRICE_PROGRAM,
-- 	OH.EXTN_PARENT_ORDER_HEADER_KEY	   C154_EXTN_PARENT_ORDER_HEADER_,
-- 	OH.EXTN_SHUTTERFLYNOTE_ELIGIBLE	   C155_EXTN_SHUTTERFLYNOTE_ELIGI,
-- 	OH.EXTN_CANCEL_COMMENT	   C156_EXTN_CANCEL_COMMENT,
-- 	OH.EXTN_REPLAYED_WOB	   C157_EXTN_REPLAYED_WOB
-- from	OMS3_OWN.YFS_ORDER_HEADER   OH
-- where	(1=1)
-- And (OH.MODIFYTS >= TO_DATE(SUBSTR(:v_cdc_load_date, 1, 19), 'YYYY-MM-DD HH24:MI:SS')  -:v_cdc_oms_overlap
-- )





-- &

-- /* TARGET CODE */
-- insert into RAX_APP_USER.C$_0STG_ORDER_HEADER
-- (
-- 	C1_TOTAL_AMOUNT,
-- 	C2_IS_LINE_SHIP_COMPLETE,
-- 	C3_HOLD_FLAG,
-- 	C4_ENTERED_BY,
-- 	C5_EXTN_ORDERS_SIT_TYPE,
-- 	C6_MODIFYPROGID,
-- 	C7_SHIP_NODE,
-- 	C8_SEARCH_CRITERIA_1,
-- 	C9_EXTN_EXTERNAL_REF_ID,
-- 	C10_EXTN_SUBJECT_MIDDLENAME,
-- 	C11_EXTN_SIT_PART_NUMBER,
-- 	C12_ENTERPRISE_CURRENCY,
-- 	C13_REQ_SHIP_DATE,
-- 	C14_BUYER_RECEIVING_NODE_ID,
-- 	C15_CHARGE_ACTUAL_FREIGHT,
-- 	C16_INVOICE_COMPLETE,
-- 	C17_PRIORITY_NUMBER,
-- 	C18_EXTN_CSR_CODE,
-- 	C19_EXTN_ORDER_SUBPROGRAM_TYPE,
-- 	C20_ORIGINAL_TAX,
-- 	C21_SEARCH_CRITERIA_2,
-- 	C22_EXTN_PROMISED_BALANCE,
-- 	C23_NEXT_ALERT_TS,
-- 	C24_AUTHORIZATION_EXPIRATION_D,
-- 	C25_PERSONALIZE_CODE,
-- 	C26_EXTN_ORDER_PROGRAM_TYPE,
-- 	C27_EXTN_ORDER_PART_NUMBER,
-- 	C28_ORDER_CLOSED,
-- 	C29_DIVISION,
-- 	C30_REQ_CANCEL_DATE,
-- 	C31_REPORTING_CONVERSION_RATE,
-- 	C32_EXTN_VALUEPLUS_PAID,
-- 	C33_SALE_VOIDED,
-- 	C34_PRICE_PROGRAM_KEY,
-- 	C35_EXTN_SESSION_ID,
-- 	C36_EXTN_ORDER_STUDIO_CODE,
-- 	C37_REPORTING_CONVERSION_DATE,
-- 	C38_DEPARTMENT_CODE,
-- 	C39_TOTAL_ADJUSTMENT_AMOUNT,
-- 	C40_PURGE_HISTORY_DATE,
-- 	C41_HRS_BEFORE_NEXT_ITER,
-- 	C42_HAS_DERIVED_CHILD,
-- 	C43_ORDER_TYPE,
-- 	C44_SOURCE_KEY,
-- 	C45_EXTN_RETOUCHING,
-- 	C46_CUSTOMER_EMAILID,
-- 	C47_HAS_DERIVED_PARENT,
-- 	C48_PRIORITY_CODE,
-- 	C49_PURPOSE,
-- 	C50_BILL_TO_KEY,
-- 	C51_TAX_EXEMPT_FLAG,
-- 	C52_OPTIMIZATION_TYPE,
-- 	C53_BUYER_ORGANIZATION_CODE,
-- 	C54_BUYER_USER_ID,
-- 	C55_DELIVERY_CODE,
-- 	C56_CUSTCARRIER_ACCOUNT_NO,
-- 	C57_EXTN_PROTECTIVE_FINISH,
-- 	C58_CURRENCY,
-- 	C59_EXTN_INSTALLMENT_PAYMENT_P,
-- 	C60_EXTN_ORDER_APO_KEY,
-- 	C61_SOURCING_CLASSIFICATION,
-- 	C62_BILL_TO_ID,
-- 	C63_EXTN_FOLIO_COUNTER,
-- 	C64_CUSTOMER_PO_NO,
-- 	C65_DOCUMENT_TYPE,
-- 	C66_MODIFYUSERID,
-- 	C67_EXTN_SUBJECT_KEY,
-- 	C68_NOTIFY_AFTER_SHIPMENT_FLAG,
-- 	C69_EXTN_SUBJECT_LASTNAME,
-- 	C70_RETURN_OH_KEY_FOR_EXCHANGE,
-- 	C71_EXTN_SHIP_ORDERS_TO,
-- 	C72_VENDOR_ID,
-- 	C73_CONTACT_KEY,
-- 	C74_TAX,
-- 	C75_RECEIVING_NODE,
-- 	C76_TAX_EXEMPTION_CERTIFICATE,
-- 	C77_CREATETS,
-- 	C78_PAYMENT_STATUS,
-- 	C79_EXTN_DIE_CUT,
-- 	C80_EXCHANGE_TYPE,
-- 	C81_CREATEPROGID,
-- 	C82_EXTN_ORDER_ACCOUNT_NAME,
-- 	C83_EXTN_OVERRIDE_1,
-- 	C84_EXTN_SUBJECT_FIRSTNAME,
-- 	C85_EXTN_BATCH_ID,
-- 	C86_SOLD_TO_KEY,
-- 	C87_MARK_FOR_KEY,
-- 	C88_SHIP_TO_ID,
-- 	C89_TERMS_CODE,
-- 	C90_ADJUSTMENT_INVOICE_PENDING,
-- 	C91_DEFAULT_TEMPLATE,
-- 	C92_ENTRY_TYPE,
-- 	C93_TEAM_CODE,
-- 	C94_CREATED_AT_NODE,
-- 	C95_ORDER_NO,
-- 	C96_EXTN_PHOTOGRAPHY_LOCATION,
-- 	C97_ORDER_HEADER_KEY,
-- 	C98_RETURN_BY_GIFT_RECIPIENT,
-- 	C99_ORDER_DATE,
-- 	C100_ORDER_NAME,
-- 	C101_SHIP_TO_KEY,
-- 	C102_MODIFYTS,
-- 	C103_NOTIFICATION_TYPE,
-- 	C104_AUTO_CANCEL_DATE,
-- 	C105_ALLOCATION_RULE_ID,
-- 	C106_EXTN_SPECIAL_INSTRUCTIONS,
-- 	C107_BUYER_MARK_FOR_NODE_ID,
-- 	C108_IS_LINE_SHIP_SINGLE_NODE,
-- 	C109_EXTN_COD_RELEASE_NO,
-- 	C110_CREATEUSERID,
-- 	C111_EXTN_VALUEPLUS,
-- 	C112_CHAIN_TYPE,
-- 	C113_TAXPAYER_ID,
-- 	C114_SOURCE_TYPE,
-- 	C115_EXTN_LINEN_TEXTURE,
-- 	C116_TAX_JURISDICTION,
-- 	C117_NOTIFICATION_REFERENCE,
-- 	C118_PRICING_CLASSIFICATION_CO,
-- 	C119_OTHER_CHARGES,
-- 	C120_ORDER_PURPOSE,
-- 	C121_ORIGINAL_TOTAL_AMOUNT,
-- 	C122_DRAFT_ORDER_FLAG,
-- 	C123_EXTN_ORDER_PROCESSING_LAB,
-- 	C124_HOLD_REASON_CODE,
-- 	C125_EXTN_EVENT_REF_ID,
-- 	C126_FOB,
-- 	C127_RECREATE_AUTHORIZATIONS,
-- 	C128_SELLER_ORGANIZATION_CODE,
-- 	C129_PENDING_TRANSFER_IN,
-- 	C130_ORIGINAL_CONTAINER_KEY,
-- 	C131_IS_SHIP_COMPLETE,
-- 	C132_ENTERPRISE_KEY,
-- 	C133_REQ_DELIVERY_DATE,
-- 	C134_CARRIER_SERVICE_CODE,
-- 	C135_DO_NOT_CONSOLIDATE,
-- 	C136_CANCEL_ORDER_ON_EXCP_FLAG,
-- 	C137_CUSTOMER_CUSTOMER_PO_NO,
-- 	C138_NEXT_ITER_SEQ_NO,
-- 	C139_EXTN_ORDER_ELECTRONIC_ORD,
-- 	C140_NEXT_ITER_DATE,
-- 	C141_PAYMENT_RULE_ID,
-- 	C142_LOCKID,
-- 	C143_IS_SHIP_SINGLE_NODE,
-- 	C144_SCAC,
-- 	C145_EXTN_LAST_USER_MODIFIED_D,
-- 	C146_EXTN_REQ_SHIP_DATE,
-- 	C147_EXTN_SUBJECT_GRADE,
-- 	C148_EXTN_ORDER_STATUS,
-- 	C149_EXTN_RETAKE_NO,
-- 	C150_EXTN_DONTRELEASEUNTIL_DAT,
-- 	C151_EXTN_PARENT_RETAKE_NO,
-- 	C152_EXTN_BATCHING_REQUIRED,
-- 	C153_EXTN_PRICE_PROGRAM,
-- 	C154_EXTN_PARENT_ORDER_HEADER_,
-- 	C155_EXTN_SHUTTERFLYNOTE_ELIGI,
-- 	C156_EXTN_CANCEL_COMMENT,
-- 	C157_EXTN_REPLAYED_WOB
-- )
-- values
-- (
-- 	:C1_TOTAL_AMOUNT,
-- 	:C2_IS_LINE_SHIP_COMPLETE,
-- 	:C3_HOLD_FLAG,
-- 	:C4_ENTERED_BY,
-- 	:C5_EXTN_ORDERS_SIT_TYPE,
-- 	:C6_MODIFYPROGID,
-- 	:C7_SHIP_NODE,
-- 	:C8_SEARCH_CRITERIA_1,
-- 	:C9_EXTN_EXTERNAL_REF_ID,
-- 	:C10_EXTN_SUBJECT_MIDDLENAME,
-- 	:C11_EXTN_SIT_PART_NUMBER,
-- 	:C12_ENTERPRISE_CURRENCY,
-- 	:C13_REQ_SHIP_DATE,
-- 	:C14_BUYER_RECEIVING_NODE_ID,
-- 	:C15_CHARGE_ACTUAL_FREIGHT,
-- 	:C16_INVOICE_COMPLETE,
-- 	:C17_PRIORITY_NUMBER,
-- 	:C18_EXTN_CSR_CODE,
-- 	:C19_EXTN_ORDER_SUBPROGRAM_TYPE,
-- 	:C20_ORIGINAL_TAX,
-- 	:C21_SEARCH_CRITERIA_2,
-- 	:C22_EXTN_PROMISED_BALANCE,
-- 	:C23_NEXT_ALERT_TS,
-- 	:C24_AUTHORIZATION_EXPIRATION_D,
-- 	:C25_PERSONALIZE_CODE,
-- 	:C26_EXTN_ORDER_PROGRAM_TYPE,
-- 	:C27_EXTN_ORDER_PART_NUMBER,
-- 	:C28_ORDER_CLOSED,
-- 	:C29_DIVISION,
-- 	:C30_REQ_CANCEL_DATE,
-- 	:C31_REPORTING_CONVERSION_RATE,
-- 	:C32_EXTN_VALUEPLUS_PAID,
-- 	:C33_SALE_VOIDED,
-- 	:C34_PRICE_PROGRAM_KEY,
-- 	:C35_EXTN_SESSION_ID,
-- 	:C36_EXTN_ORDER_STUDIO_CODE,
-- 	:C37_REPORTING_CONVERSION_DATE,
-- 	:C38_DEPARTMENT_CODE,
-- 	:C39_TOTAL_ADJUSTMENT_AMOUNT,
-- 	:C40_PURGE_HISTORY_DATE,
-- 	:C41_HRS_BEFORE_NEXT_ITER,
-- 	:C42_HAS_DERIVED_CHILD,
-- 	:C43_ORDER_TYPE,
-- 	:C44_SOURCE_KEY,
-- 	:C45_EXTN_RETOUCHING,
-- 	:C46_CUSTOMER_EMAILID,
-- 	:C47_HAS_DERIVED_PARENT,
-- 	:C48_PRIORITY_CODE,
-- 	:C49_PURPOSE,
-- 	:C50_BILL_TO_KEY,
-- 	:C51_TAX_EXEMPT_FLAG,
-- 	:C52_OPTIMIZATION_TYPE,
-- 	:C53_BUYER_ORGANIZATION_CODE,
-- 	:C54_BUYER_USER_ID,
-- 	:C55_DELIVERY_CODE,
-- 	:C56_CUSTCARRIER_ACCOUNT_NO,
-- 	:C57_EXTN_PROTECTIVE_FINISH,
-- 	:C58_CURRENCY,
-- 	:C59_EXTN_INSTALLMENT_PAYMENT_P,
-- 	:C60_EXTN_ORDER_APO_KEY,
-- 	:C61_SOURCING_CLASSIFICATION,
-- 	:C62_BILL_TO_ID,
-- 	:C63_EXTN_FOLIO_COUNTER,
-- 	:C64_CUSTOMER_PO_NO,
-- 	:C65_DOCUMENT_TYPE,
-- 	:C66_MODIFYUSERID,
-- 	:C67_EXTN_SUBJECT_KEY,
-- 	:C68_NOTIFY_AFTER_SHIPMENT_FLAG,
-- 	:C69_EXTN_SUBJECT_LASTNAME,
-- 	:C70_RETURN_OH_KEY_FOR_EXCHANGE,
-- 	:C71_EXTN_SHIP_ORDERS_TO,
-- 	:C72_VENDOR_ID,
-- 	:C73_CONTACT_KEY,
-- 	:C74_TAX,
-- 	:C75_RECEIVING_NODE,
-- 	:C76_TAX_EXEMPTION_CERTIFICATE,
-- 	:C77_CREATETS,
-- 	:C78_PAYMENT_STATUS,
-- 	:C79_EXTN_DIE_CUT,
-- 	:C80_EXCHANGE_TYPE,
-- 	:C81_CREATEPROGID,
-- 	:C82_EXTN_ORDER_ACCOUNT_NAME,
-- 	:C83_EXTN_OVERRIDE_1,
-- 	:C84_EXTN_SUBJECT_FIRSTNAME,
-- 	:C85_EXTN_BATCH_ID,
-- 	:C86_SOLD_TO_KEY,
-- 	:C87_MARK_FOR_KEY,
-- 	:C88_SHIP_TO_ID,
-- 	:C89_TERMS_CODE,
-- 	:C90_ADJUSTMENT_INVOICE_PENDING,
-- 	:C91_DEFAULT_TEMPLATE,
-- 	:C92_ENTRY_TYPE,
-- 	:C93_TEAM_CODE,
-- 	:C94_CREATED_AT_NODE,
-- 	:C95_ORDER_NO,
-- 	:C96_EXTN_PHOTOGRAPHY_LOCATION,
-- 	:C97_ORDER_HEADER_KEY,
-- 	:C98_RETURN_BY_GIFT_RECIPIENT,
-- 	:C99_ORDER_DATE,
-- 	:C100_ORDER_NAME,
-- 	:C101_SHIP_TO_KEY,
-- 	:C102_MODIFYTS,
-- 	:C103_NOTIFICATION_TYPE,
-- 	:C104_AUTO_CANCEL_DATE,
-- 	:C105_ALLOCATION_RULE_ID,
-- 	:C106_EXTN_SPECIAL_INSTRUCTIONS,
-- 	:C107_BUYER_MARK_FOR_NODE_ID,
-- 	:C108_IS_LINE_SHIP_SINGLE_NODE,
-- 	:C109_EXTN_COD_RELEASE_NO,
-- 	:C110_CREATEUSERID,
-- 	:C111_EXTN_VALUEPLUS,
-- 	:C112_CHAIN_TYPE,
-- 	:C113_TAXPAYER_ID,
-- 	:C114_SOURCE_TYPE,
-- 	:C115_EXTN_LINEN_TEXTURE,
-- 	:C116_TAX_JURISDICTION,
-- 	:C117_NOTIFICATION_REFERENCE,
-- 	:C118_PRICING_CLASSIFICATION_CO,
-- 	:C119_OTHER_CHARGES,
-- 	:C120_ORDER_PURPOSE,
-- 	:C121_ORIGINAL_TOTAL_AMOUNT,
-- 	:C122_DRAFT_ORDER_FLAG,
-- 	:C123_EXTN_ORDER_PROCESSING_LAB,
-- 	:C124_HOLD_REASON_CODE,
-- 	:C125_EXTN_EVENT_REF_ID,
-- 	:C126_FOB,
-- 	:C127_RECREATE_AUTHORIZATIONS,
-- 	:C128_SELLER_ORGANIZATION_CODE,
-- 	:C129_PENDING_TRANSFER_IN,
-- 	:C130_ORIGINAL_CONTAINER_KEY,
-- 	:C131_IS_SHIP_COMPLETE,
-- 	:C132_ENTERPRISE_KEY,
-- 	:C133_REQ_DELIVERY_DATE,
-- 	:C134_CARRIER_SERVICE_CODE,
-- 	:C135_DO_NOT_CONSOLIDATE,
-- 	:C136_CANCEL_ORDER_ON_EXCP_FLAG,
-- 	:C137_CUSTOMER_CUSTOMER_PO_NO,
-- 	:C138_NEXT_ITER_SEQ_NO,
-- 	:C139_EXTN_ORDER_ELECTRONIC_ORD,
-- 	:C140_NEXT_ITER_DATE,
-- 	:C141_PAYMENT_RULE_ID,
-- 	:C142_LOCKID,
-- 	:C143_IS_SHIP_SINGLE_NODE,
-- 	:C144_SCAC,
-- 	:C145_EXTN_LAST_USER_MODIFIED_D,
-- 	:C146_EXTN_REQ_SHIP_DATE,
-- 	:C147_EXTN_SUBJECT_GRADE,
-- 	:C148_EXTN_ORDER_STATUS,
-- 	:C149_EXTN_RETAKE_NO,
-- 	:C150_EXTN_DONTRELEASEUNTIL_DAT,
-- 	:C151_EXTN_PARENT_RETAKE_NO,
-- 	:C152_EXTN_BATCHING_REQUIRED,
-- 	:C153_EXTN_PRICE_PROGRAM,
-- 	:C154_EXTN_PARENT_ORDER_HEADER_,
-- 	:C155_EXTN_SHUTTERFLYNOTE_ELIGI,
-- 	:C156_EXTN_CANCEL_COMMENT,
-- 	:C157_EXTN_REPLAYED_WOB
-- )

-- &


/*-----------------------------------------------*/
/* TASK No. 27 */
/* Analyze work table */



BEGIN
DBMS_STATS.GATHER_TABLE_STATS (
    ownname =>	'RAX_APP_USER',
    tabname =>	'C$_0STG_ORDER_HEADER',
    estimate_percent =>	DBMS_STATS.AUTO_SAMPLE_SIZE
);
END;




&


/*-----------------------------------------------*/
/* TASK No. 29 */
/* Create target table  */

BEGIN  
   EXECUTE IMMEDIATE 'create table RAX_APP_USER.STG_ORDER_HEADER
                        (
                            TOTAL_AMOUNT	NUMBER(15,2) NULL,
                            IS_LINE_SHIP_COMPLETE	CHAR(1) NULL,
                            HOLD_FLAG	CHAR(1) NULL,
                            ENTERED_BY	VARCHAR2(254) NULL,
                            EXTN_ORDERS_SIT_TYPE	VARCHAR2(15) NULL,
                            MODIFYPROGID	VARCHAR2(40) NULL,
                            SHIP_NODE	CHAR(24) NULL,
                            SEARCH_CRITERIA_1	VARCHAR2(100) NULL,
                            EXTN_EXTERNAL_REF_ID	VARCHAR2(16) NULL,
                            EXTN_SUBJECT_MIDDLENAME	VARCHAR2(255) NULL,
                            EXTN_SIT_PART_NUMBER	VARCHAR2(20) NULL,
                            ENTERPRISE_CURRENCY	VARCHAR2(20) NULL,
                            REQ_SHIP_DATE	DATE NULL,
                            BUYER_RECEIVING_NODE_ID	CHAR(24) NULL,
                            CHARGE_ACTUAL_FREIGHT	CHAR(1) NULL,
                            INVOICE_COMPLETE	CHAR(1) NULL,
                            PRIORITY_NUMBER	NUMBER(10) NULL,
                            EXTN_CSR_CODE	VARCHAR2(20) NULL,
                            EXTN_ORDER_SUBPROGRAM_TYPE	VARCHAR2(20) NULL,
                            ORIGINAL_TAX	NUMBER(15,2) NULL,
                            SEARCH_CRITERIA_2	VARCHAR2(100) NULL,
                            EXTN_PROMISED_BALANCE	NUMBER(8,2) NULL,
                            NEXT_ALERT_TS	DATE NULL,
                            AUTHORIZATION_EXPIRATION_DATE	DATE NULL,
                            PERSONALIZE_CODE	VARCHAR2(20) NULL,
                            EXTN_ORDER_PROGRAM_TYPE	VARCHAR2(20) NULL,
                            EXTN_ORDER_PART_NUMBER	VARCHAR2(20) NULL,
                            ORDER_CLOSED	CHAR(1) NULL,
                            DIVISION	VARCHAR2(10) NULL,
                            REQ_CANCEL_DATE	DATE NULL,
                            REPORTING_CONVERSION_RATE	NUMBER(28,16) NULL,
                            EXTN_VALUEPLUS_PAID	CHAR(1) NULL,
                            SALE_VOIDED	CHAR(1) NULL,
                            PRICE_PROGRAM_KEY	CHAR(24) NULL,
                            EXTN_SESSION_ID	VARCHAR2(100) NULL,
                            EXTN_ORDER_STUDIO_CODE	VARCHAR2(24) NULL,
                            REPORTING_CONVERSION_DATE	DATE NULL,
                            DEPARTMENT_CODE	VARCHAR2(20) NULL,
                            TOTAL_ADJUSTMENT_AMOUNT	NUMBER(15,2) NULL,
                            PURGE_HISTORY_DATE	DATE NULL,
                            HRS_BEFORE_NEXT_ITER	NUMBER(14,4) NULL,
                            HAS_DERIVED_CHILD	CHAR(1) NULL,
                            ORDER_TYPE	VARCHAR2(20) NULL,
                            SOURCE_KEY	NUMBER(20) NULL,
                            EXTN_RETOUCHING	VARCHAR2(15) NULL,
                            CUSTOMER_EMAILID	VARCHAR2(150) NULL,
                            HAS_DERIVED_PARENT	CHAR(1) NULL,
                            PRIORITY_CODE	VARCHAR2(256) NULL,
                            PURPOSE	VARCHAR2(40) NULL,
                            BILL_TO_KEY	CHAR(24) NULL,
                            TAX_EXEMPT_FLAG	CHAR(1) NULL,
                            OPTIMIZATION_TYPE	CHAR(2) NULL,
                            BUYER_ORGANIZATION_CODE	CHAR(24) NULL,
                            BUYER_USER_ID	VARCHAR2(60) NULL,
                            DELIVERY_CODE	VARCHAR2(40) NULL,
                            CUSTCARRIER_ACCOUNT_NO	VARCHAR2(40) NULL,
                            EXTN_PROTECTIVE_FINISH	CHAR(1) NULL,
                            CURRENCY	VARCHAR2(20) NULL,
                            EXTN_INSTALLMENT_PAYMENT_PLAN	CHAR(1) NULL,
                            EXTN_ORDER_APO_KEY	VARCHAR2(24) NULL,
                            SOURCING_CLASSIFICATION	VARCHAR2(40) NULL,
                            BILL_TO_ID	VARCHAR2(40) NULL,
                            EXTN_FOLIO_COUNTER	NUMBER(5,2) NULL,
                            CUSTOMER_PO_NO	VARCHAR2(100) NULL,
                            DOCUMENT_TYPE	VARCHAR2(40) NULL,
                            MODIFYUSERID	VARCHAR2(40) NULL,
                            EXTN_SUBJECT_KEY	VARCHAR2(24) NULL,
                            NOTIFY_AFTER_SHIPMENT_FLAG	CHAR(1) NULL,
                            EXTN_SUBJECT_LASTNAME	VARCHAR2(255) NULL,
                            RETURN_OH_KEY_FOR_EXCHANGE	CHAR(24) NULL,
                            EXTN_SHIP_ORDERS_TO	VARCHAR2(15) NULL,
                            VENDOR_ID	CHAR(24) NULL,
                            CONTACT_KEY	CHAR(24) NULL,
                            TAX	NUMBER(15,2) NULL,
                            RECEIVING_NODE	CHAR(24) NULL,
                            TAX_EXEMPTION_CERTIFICATE	VARCHAR2(40) NULL,
                            CREATETS	DATE NULL,
                            PAYMENT_STATUS	CHAR(15) NULL,
                            EXTN_DIE_CUT	CHAR(1) NULL,
                            EXCHANGE_TYPE	VARCHAR2(40) NULL,
                            CREATEPROGID	VARCHAR2(40) NULL,
                            EXTN_ORDER_ACCOUNT_NAME	VARCHAR2(40) NULL,
                            EXTN_OVERRIDE_1	CHAR(1) NULL,
                            EXTN_SUBJECT_FIRSTNAME	VARCHAR2(255) NULL,
                            EXTN_BATCH_ID	VARCHAR2(40) NULL,
                            SOLD_TO_KEY	CHAR(24) NULL,
                            MARK_FOR_KEY	CHAR(24) NULL,
                            SHIP_TO_ID	VARCHAR2(40) NULL,
                            TERMS_CODE	VARCHAR2(20) NULL,
                            ADJUSTMENT_INVOICE_PENDING	CHAR(1) NULL,
                            DEFAULT_TEMPLATE	CHAR(1) NULL,
                            ENTRY_TYPE	VARCHAR2(20) NULL,
                            TEAM_CODE	VARCHAR2(40) NULL,
                            CREATED_AT_NODE	CHAR(1) NULL,
                            ORDER_NO	CHAR(40) NULL,
                            EXTN_PHOTOGRAPHY_LOCATION	VARCHAR2(15) NULL,
                            ORDER_HEADER_KEY	CHAR(24) NULL,
                            RETURN_BY_GIFT_RECIPIENT	CHAR(1) NULL,
                            ORDER_DATE	DATE NULL,
                            ORDER_NAME	VARCHAR2(100) NULL,
                            SHIP_TO_KEY	CHAR(24) NULL,
                            MODIFYTS	DATE NULL,
                            NOTIFICATION_TYPE	VARCHAR2(20) NULL,
                            AUTO_CANCEL_DATE	DATE NULL,
                            ALLOCATION_RULE_ID	CHAR(10) NULL,
                            EXTN_SPECIAL_INSTRUCTIONS	VARCHAR2(500) NULL,
                            BUYER_MARK_FOR_NODE_ID	CHAR(24) NULL,
                            IS_LINE_SHIP_SINGLE_NODE	CHAR(1) NULL,
                            EXTN_COD_RELEASE_NO	NUMBER(5) NULL,
                            CREATEUSERID	VARCHAR2(40) NULL,
                            EXTN_VALUEPLUS	CHAR(1) NULL,
                            CHAIN_TYPE	VARCHAR2(40) NULL,
                            TAXPAYER_ID	VARCHAR2(40) NULL,
                            SOURCE_TYPE	VARCHAR2(40) NULL,
                            EXTN_LINEN_TEXTURE	CHAR(1) NULL,
                            TAX_JURISDICTION	VARCHAR2(40) NULL,
                            NOTIFICATION_REFERENCE	VARCHAR2(100) NULL,
                            PRICING_CLASSIFICATION_CODE	NUMBER(20) NULL,
                            OTHER_CHARGES	NUMBER(15,2) NULL,
                            ORDER_PURPOSE	VARCHAR2(20) NULL,
                            ORIGINAL_TOTAL_AMOUNT	NUMBER(15,2) NULL,
                            DRAFT_ORDER_FLAG	CHAR(1) NULL,
                            EXTN_ORDER_PROCESSING_LAB	VARCHAR2(24) NULL,
                            HOLD_REASON_CODE	VARCHAR2(40) NULL,
                            EXTN_EVENT_REF_ID	VARCHAR2(10) NULL,
                            FOB	VARCHAR2(40) NULL,
                            RECREATE_AUTHORIZATIONS	CHAR(1) NULL,
                            SELLER_ORGANIZATION_CODE	CHAR(24) NULL,
                            PENDING_TRANSFER_IN	NUMBER(15,2) NULL,
                            ORIGINAL_CONTAINER_KEY	NUMBER(20) NULL,
                            IS_SHIP_COMPLETE	CHAR(1) NULL,
                            ENTERPRISE_KEY	CHAR(24) NULL,
                            REQ_DELIVERY_DATE	DATE NULL,
                            CARRIER_SERVICE_CODE	VARCHAR2(40) NULL,
                            DO_NOT_CONSOLIDATE	CHAR(1) NULL,
                            CANCEL_ORDER_ON_EXCP_FLAG	CHAR(1) NULL,
                            CUSTOMER_CUSTOMER_PO_NO	VARCHAR2(100) NULL,
                            NEXT_ITER_SEQ_NO	NUMBER(10) NULL,
                            EXTN_ORDER_ELECTRONIC_ORDER	CHAR(1) NULL,
                            NEXT_ITER_DATE	DATE NULL,
                            PAYMENT_RULE_ID	VARCHAR2(20) NULL,
                            LOCKID	NUMBER(5) NULL,
                            IS_SHIP_SINGLE_NODE	CHAR(1) NULL,
                            SCAC	VARCHAR2(40) NULL,
                            EXTN_LAST_USER_MODIFIED_DATE	DATE NULL,
                            EXTN_REQ_SHIP_DATE	DATE NULL,
                            EXTN_SUBJECT_GRADE	VARCHAR2(255) NULL,
                            EXTN_ORDER_STATUS	VARCHAR2(100) NULL,
                            EXTN_RETAKE_NO	VARCHAR2(100) NULL,
                            EXTN_DONTRELEASEUNTIL_DATE	DATE NULL,
                            EXTN_PARENT_RETAKE_NO	VARCHAR2(100) NULL,
                            EXTN_BATCHING_REQUIRED	CHAR(1) NULL,
                            EXTN_PRICE_PROGRAM	VARCHAR2(50) NULL,
                            EXTN_PARENT_ORDER_HEADER_KEY	VARCHAR2(40) NULL,
                            EXTN_SHUTTERFLYNOTE_ELIGIBLE	CHAR(1) NULL,
                            EXTN_CANCEL_COMMENT	VARCHAR2(300) NULL,
                            EXTN_REPLAYED_WOB	VARCHAR2(40) NULL
                        )';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 THEN  
         RAISE;  
      END IF;  
END;

&


/*-----------------------------------------------*/
/* TASK No. 30 */
/* Truncate target table */

truncate table RAX_APP_USER.STG_ORDER_HEADER


&


/*-----------------------------------------------*/
/* TASK No. 31 */
/* Insert new rows */

 
insert into	RAX_APP_USER.STG_ORDER_HEADER 
( 
	TOTAL_AMOUNT,
	IS_LINE_SHIP_COMPLETE,
	HOLD_FLAG,
	ENTERED_BY,
	EXTN_ORDERS_SIT_TYPE,
	MODIFYPROGID,
	SHIP_NODE,
	SEARCH_CRITERIA_1,
	EXTN_EXTERNAL_REF_ID,
	EXTN_SUBJECT_MIDDLENAME,
	EXTN_SIT_PART_NUMBER,
	ENTERPRISE_CURRENCY,
	REQ_SHIP_DATE,
	BUYER_RECEIVING_NODE_ID,
	CHARGE_ACTUAL_FREIGHT,
	INVOICE_COMPLETE,
	PRIORITY_NUMBER,
	EXTN_CSR_CODE,
	EXTN_ORDER_SUBPROGRAM_TYPE,
	ORIGINAL_TAX,
	SEARCH_CRITERIA_2,
	EXTN_PROMISED_BALANCE,
	NEXT_ALERT_TS,
	AUTHORIZATION_EXPIRATION_DATE,
	PERSONALIZE_CODE,
	EXTN_ORDER_PROGRAM_TYPE,
	EXTN_ORDER_PART_NUMBER,
	ORDER_CLOSED,
	DIVISION,
	REQ_CANCEL_DATE,
	REPORTING_CONVERSION_RATE,
	EXTN_VALUEPLUS_PAID,
	SALE_VOIDED,
	PRICE_PROGRAM_KEY,
	EXTN_SESSION_ID,
	EXTN_ORDER_STUDIO_CODE,
	REPORTING_CONVERSION_DATE,
	DEPARTMENT_CODE,
	TOTAL_ADJUSTMENT_AMOUNT,
	PURGE_HISTORY_DATE,
	HRS_BEFORE_NEXT_ITER,
	HAS_DERIVED_CHILD,
	ORDER_TYPE,
	SOURCE_KEY,
	EXTN_RETOUCHING,
	CUSTOMER_EMAILID,
	HAS_DERIVED_PARENT,
	PRIORITY_CODE,
	PURPOSE,
	BILL_TO_KEY,
	TAX_EXEMPT_FLAG,
	OPTIMIZATION_TYPE,
	BUYER_ORGANIZATION_CODE,
	BUYER_USER_ID,
	DELIVERY_CODE,
	CUSTCARRIER_ACCOUNT_NO,
	EXTN_PROTECTIVE_FINISH,
	CURRENCY,
	EXTN_INSTALLMENT_PAYMENT_PLAN,
	EXTN_ORDER_APO_KEY,
	SOURCING_CLASSIFICATION,
	BILL_TO_ID,
	EXTN_FOLIO_COUNTER,
	CUSTOMER_PO_NO,
	DOCUMENT_TYPE,
	MODIFYUSERID,
	EXTN_SUBJECT_KEY,
	NOTIFY_AFTER_SHIPMENT_FLAG,
	EXTN_SUBJECT_LASTNAME,
	RETURN_OH_KEY_FOR_EXCHANGE,
	EXTN_SHIP_ORDERS_TO,
	VENDOR_ID,
	CONTACT_KEY,
	TAX,
	RECEIVING_NODE,
	TAX_EXEMPTION_CERTIFICATE,
	CREATETS,
	PAYMENT_STATUS,
	EXTN_DIE_CUT,
	EXCHANGE_TYPE,
	CREATEPROGID,
	EXTN_ORDER_ACCOUNT_NAME,
	EXTN_OVERRIDE_1,
	EXTN_SUBJECT_FIRSTNAME,
	EXTN_BATCH_ID,
	SOLD_TO_KEY,
	MARK_FOR_KEY,
	SHIP_TO_ID,
	TERMS_CODE,
	ADJUSTMENT_INVOICE_PENDING,
	DEFAULT_TEMPLATE,
	ENTRY_TYPE,
	TEAM_CODE,
	CREATED_AT_NODE,
	ORDER_NO,
	EXTN_PHOTOGRAPHY_LOCATION,
	ORDER_HEADER_KEY,
	RETURN_BY_GIFT_RECIPIENT,
	ORDER_DATE,
	ORDER_NAME,
	SHIP_TO_KEY,
	MODIFYTS,
	NOTIFICATION_TYPE,
	AUTO_CANCEL_DATE,
	ALLOCATION_RULE_ID,
	EXTN_SPECIAL_INSTRUCTIONS,
	BUYER_MARK_FOR_NODE_ID,
	IS_LINE_SHIP_SINGLE_NODE,
	EXTN_COD_RELEASE_NO,
	CREATEUSERID,
	EXTN_VALUEPLUS,
	CHAIN_TYPE,
	TAXPAYER_ID,
	SOURCE_TYPE,
	EXTN_LINEN_TEXTURE,
	TAX_JURISDICTION,
	NOTIFICATION_REFERENCE,
	PRICING_CLASSIFICATION_CODE,
	OTHER_CHARGES,
	ORDER_PURPOSE,
	ORIGINAL_TOTAL_AMOUNT,
	DRAFT_ORDER_FLAG,
	EXTN_ORDER_PROCESSING_LAB,
	HOLD_REASON_CODE,
	EXTN_EVENT_REF_ID,
	FOB,
	RECREATE_AUTHORIZATIONS,
	SELLER_ORGANIZATION_CODE,
	PENDING_TRANSFER_IN,
	ORIGINAL_CONTAINER_KEY,
	IS_SHIP_COMPLETE,
	ENTERPRISE_KEY,
	REQ_DELIVERY_DATE,
	CARRIER_SERVICE_CODE,
	DO_NOT_CONSOLIDATE,
	CANCEL_ORDER_ON_EXCP_FLAG,
	CUSTOMER_CUSTOMER_PO_NO,
	NEXT_ITER_SEQ_NO,
	EXTN_ORDER_ELECTRONIC_ORDER,
	NEXT_ITER_DATE,
	PAYMENT_RULE_ID,
	LOCKID,
	IS_SHIP_SINGLE_NODE,
	SCAC,
	EXTN_LAST_USER_MODIFIED_DATE,
	EXTN_REQ_SHIP_DATE,
	EXTN_SUBJECT_GRADE,
	EXTN_ORDER_STATUS,
	EXTN_RETAKE_NO,
	EXTN_DONTRELEASEUNTIL_DATE,
	EXTN_PARENT_RETAKE_NO,
	EXTN_BATCHING_REQUIRED,
	EXTN_PRICE_PROGRAM,
	EXTN_PARENT_ORDER_HEADER_KEY,
	EXTN_SHUTTERFLYNOTE_ELIGIBLE,
	EXTN_CANCEL_COMMENT,
	EXTN_REPLAYED_WOB 
	 
) 

select
    TOTAL_AMOUNT,
	IS_LINE_SHIP_COMPLETE,
	HOLD_FLAG,
	ENTERED_BY,
	EXTN_ORDERS_SIT_TYPE,
	MODIFYPROGID,
	SHIP_NODE,
	SEARCH_CRITERIA_1,
	EXTN_EXTERNAL_REF_ID,
	EXTN_SUBJECT_MIDDLENAME,
	EXTN_SIT_PART_NUMBER,
	ENTERPRISE_CURRENCY,
	REQ_SHIP_DATE,
	BUYER_RECEIVING_NODE_ID,
	CHARGE_ACTUAL_FREIGHT,
	INVOICE_COMPLETE,
	PRIORITY_NUMBER,
	EXTN_CSR_CODE,
	EXTN_ORDER_SUBPROGRAM_TYPE,
	ORIGINAL_TAX,
	SEARCH_CRITERIA_2,
	EXTN_PROMISED_BALANCE,
	NEXT_ALERT_TS,
	AUTHORIZATION_EXPIRATION_DATE,
	PERSONALIZE_CODE,
	EXTN_ORDER_PROGRAM_TYPE,
	EXTN_ORDER_PART_NUMBER,
	ORDER_CLOSED,
	DIVISION,
	REQ_CANCEL_DATE,
	REPORTING_CONVERSION_RATE,
	EXTN_VALUEPLUS_PAID,
	SALE_VOIDED,
	PRICE_PROGRAM_KEY,
	EXTN_SESSION_ID,
	EXTN_ORDER_STUDIO_CODE,
	REPORTING_CONVERSION_DATE,
	DEPARTMENT_CODE,
	TOTAL_ADJUSTMENT_AMOUNT,
	PURGE_HISTORY_DATE,
	HRS_BEFORE_NEXT_ITER,
	HAS_DERIVED_CHILD,
	ORDER_TYPE,
	SOURCE_KEY,
	EXTN_RETOUCHING,
	CUSTOMER_EMAILID,
	HAS_DERIVED_PARENT,
	PRIORITY_CODE,
	PURPOSE,
	BILL_TO_KEY,
	TAX_EXEMPT_FLAG,
	OPTIMIZATION_TYPE,
	BUYER_ORGANIZATION_CODE,
	BUYER_USER_ID,
	DELIVERY_CODE,
	CUSTCARRIER_ACCOUNT_NO,
	EXTN_PROTECTIVE_FINISH,
	CURRENCY,
	EXTN_INSTALLMENT_PAYMENT_PLAN,
	EXTN_ORDER_APO_KEY,
	SOURCING_CLASSIFICATION,
	BILL_TO_ID,
	EXTN_FOLIO_COUNTER,
	CUSTOMER_PO_NO,
	DOCUMENT_TYPE,
	MODIFYUSERID,
	EXTN_SUBJECT_KEY,
	NOTIFY_AFTER_SHIPMENT_FLAG,
	EXTN_SUBJECT_LASTNAME,
	RETURN_OH_KEY_FOR_EXCHANGE,
	EXTN_SHIP_ORDERS_TO,
	VENDOR_ID,
	CONTACT_KEY,
	TAX,
	RECEIVING_NODE,
	TAX_EXEMPTION_CERTIFICATE,
	CREATETS,
	PAYMENT_STATUS,
	EXTN_DIE_CUT,
	EXCHANGE_TYPE,
	CREATEPROGID,
	EXTN_ORDER_ACCOUNT_NAME,
	EXTN_OVERRIDE_1,
	EXTN_SUBJECT_FIRSTNAME,
	EXTN_BATCH_ID,
	SOLD_TO_KEY,
	MARK_FOR_KEY,
	SHIP_TO_ID,
	TERMS_CODE,
	ADJUSTMENT_INVOICE_PENDING,
	DEFAULT_TEMPLATE,
	ENTRY_TYPE,
	TEAM_CODE,
	CREATED_AT_NODE,
	ORDER_NO,
	EXTN_PHOTOGRAPHY_LOCATION,
	ORDER_HEADER_KEY,
	RETURN_BY_GIFT_RECIPIENT,
	ORDER_DATE,
	ORDER_NAME,
	SHIP_TO_KEY,
	MODIFYTS,
	NOTIFICATION_TYPE,
	AUTO_CANCEL_DATE,
	ALLOCATION_RULE_ID,
	EXTN_SPECIAL_INSTRUCTIONS,
	BUYER_MARK_FOR_NODE_ID,
	IS_LINE_SHIP_SINGLE_NODE,
	EXTN_COD_RELEASE_NO,
	CREATEUSERID,
	EXTN_VALUEPLUS,
	CHAIN_TYPE,
	TAXPAYER_ID,
	SOURCE_TYPE,
	EXTN_LINEN_TEXTURE,
	TAX_JURISDICTION,
	NOTIFICATION_REFERENCE,
	PRICING_CLASSIFICATION_CODE,
	OTHER_CHARGES,
	ORDER_PURPOSE,
	ORIGINAL_TOTAL_AMOUNT,
	DRAFT_ORDER_FLAG,
	EXTN_ORDER_PROCESSING_LAB,
	HOLD_REASON_CODE,
	EXTN_EVENT_REF_ID,
	FOB,
	RECREATE_AUTHORIZATIONS,
	SELLER_ORGANIZATION_CODE,
	PENDING_TRANSFER_IN,
	ORIGINAL_CONTAINER_KEY,
	IS_SHIP_COMPLETE,
	ENTERPRISE_KEY,
	REQ_DELIVERY_DATE,
	CARRIER_SERVICE_CODE,
	DO_NOT_CONSOLIDATE,
	CANCEL_ORDER_ON_EXCP_FLAG,
	CUSTOMER_CUSTOMER_PO_NO,
	NEXT_ITER_SEQ_NO,
	EXTN_ORDER_ELECTRONIC_ORDER,
	NEXT_ITER_DATE,
	PAYMENT_RULE_ID,
	LOCKID,
	IS_SHIP_SINGLE_NODE,
	SCAC,
	EXTN_LAST_USER_MODIFIED_DATE,
	EXTN_REQ_SHIP_DATE,
	EXTN_SUBJECT_GRADE,
	EXTN_ORDER_STATUS,
	EXTN_RETAKE_NO,
	EXTN_DONTRELEASEUNTIL_DATE,
	EXTN_PARENT_RETAKE_NO,
	EXTN_BATCHING_REQUIRED,
	EXTN_PRICE_PROGRAM,
	EXTN_PARENT_ORDER_HEADER_KEY,
	EXTN_SHUTTERFLYNOTE_ELIGIBLE,
	EXTN_CANCEL_COMMENT,
	EXTN_REPLAYED_WOB   
   
FROM (	


select 	
	C1_TOTAL_AMOUNT TOTAL_AMOUNT,
	C2_IS_LINE_SHIP_COMPLETE IS_LINE_SHIP_COMPLETE,
	C3_HOLD_FLAG HOLD_FLAG,
	C4_ENTERED_BY ENTERED_BY,
	C5_EXTN_ORDERS_SIT_TYPE EXTN_ORDERS_SIT_TYPE,
	C6_MODIFYPROGID MODIFYPROGID,
	C7_SHIP_NODE SHIP_NODE,
	C8_SEARCH_CRITERIA_1 SEARCH_CRITERIA_1,
	C9_EXTN_EXTERNAL_REF_ID EXTN_EXTERNAL_REF_ID,
	C10_EXTN_SUBJECT_MIDDLENAME EXTN_SUBJECT_MIDDLENAME,
	C11_EXTN_SIT_PART_NUMBER EXTN_SIT_PART_NUMBER,
	C12_ENTERPRISE_CURRENCY ENTERPRISE_CURRENCY,
	C13_REQ_SHIP_DATE REQ_SHIP_DATE,
	C14_BUYER_RECEIVING_NODE_ID BUYER_RECEIVING_NODE_ID,
	C15_CHARGE_ACTUAL_FREIGHT CHARGE_ACTUAL_FREIGHT,
	C16_INVOICE_COMPLETE INVOICE_COMPLETE,
	C17_PRIORITY_NUMBER PRIORITY_NUMBER,
	C18_EXTN_CSR_CODE EXTN_CSR_CODE,
	C19_EXTN_ORDER_SUBPROGRAM_TYPE EXTN_ORDER_SUBPROGRAM_TYPE,
	C20_ORIGINAL_TAX ORIGINAL_TAX,
	C21_SEARCH_CRITERIA_2 SEARCH_CRITERIA_2,
	C22_EXTN_PROMISED_BALANCE EXTN_PROMISED_BALANCE,
	C23_NEXT_ALERT_TS NEXT_ALERT_TS,
	C24_AUTHORIZATION_EXPIRATION_D AUTHORIZATION_EXPIRATION_DATE,
	C25_PERSONALIZE_CODE PERSONALIZE_CODE,
	C26_EXTN_ORDER_PROGRAM_TYPE EXTN_ORDER_PROGRAM_TYPE,
	C27_EXTN_ORDER_PART_NUMBER EXTN_ORDER_PART_NUMBER,
	C28_ORDER_CLOSED ORDER_CLOSED,
	C29_DIVISION DIVISION,
	C30_REQ_CANCEL_DATE REQ_CANCEL_DATE,
	C31_REPORTING_CONVERSION_RATE REPORTING_CONVERSION_RATE,
	C32_EXTN_VALUEPLUS_PAID EXTN_VALUEPLUS_PAID,
	C33_SALE_VOIDED SALE_VOIDED,
	C34_PRICE_PROGRAM_KEY PRICE_PROGRAM_KEY,
	C35_EXTN_SESSION_ID EXTN_SESSION_ID,
	C36_EXTN_ORDER_STUDIO_CODE EXTN_ORDER_STUDIO_CODE,
	C37_REPORTING_CONVERSION_DATE REPORTING_CONVERSION_DATE,
	C38_DEPARTMENT_CODE DEPARTMENT_CODE,
	C39_TOTAL_ADJUSTMENT_AMOUNT TOTAL_ADJUSTMENT_AMOUNT,
	C40_PURGE_HISTORY_DATE PURGE_HISTORY_DATE,
	C41_HRS_BEFORE_NEXT_ITER HRS_BEFORE_NEXT_ITER,
	C42_HAS_DERIVED_CHILD HAS_DERIVED_CHILD,
	C43_ORDER_TYPE ORDER_TYPE,
	C44_SOURCE_KEY SOURCE_KEY,
	C45_EXTN_RETOUCHING EXTN_RETOUCHING,
	C46_CUSTOMER_EMAILID CUSTOMER_EMAILID,
	C47_HAS_DERIVED_PARENT HAS_DERIVED_PARENT,
	C48_PRIORITY_CODE PRIORITY_CODE,
	C49_PURPOSE PURPOSE,
	C50_BILL_TO_KEY BILL_TO_KEY,
	C51_TAX_EXEMPT_FLAG TAX_EXEMPT_FLAG,
	C52_OPTIMIZATION_TYPE OPTIMIZATION_TYPE,
	C53_BUYER_ORGANIZATION_CODE BUYER_ORGANIZATION_CODE,
	C54_BUYER_USER_ID BUYER_USER_ID,
	C55_DELIVERY_CODE DELIVERY_CODE,
	C56_CUSTCARRIER_ACCOUNT_NO CUSTCARRIER_ACCOUNT_NO,
	C57_EXTN_PROTECTIVE_FINISH EXTN_PROTECTIVE_FINISH,
	C58_CURRENCY CURRENCY,
	C59_EXTN_INSTALLMENT_PAYMENT_P EXTN_INSTALLMENT_PAYMENT_PLAN,
	C60_EXTN_ORDER_APO_KEY EXTN_ORDER_APO_KEY,
	C61_SOURCING_CLASSIFICATION SOURCING_CLASSIFICATION,
	C62_BILL_TO_ID BILL_TO_ID,
	C63_EXTN_FOLIO_COUNTER EXTN_FOLIO_COUNTER,
	C64_CUSTOMER_PO_NO CUSTOMER_PO_NO,
	C65_DOCUMENT_TYPE DOCUMENT_TYPE,
	C66_MODIFYUSERID MODIFYUSERID,
	C67_EXTN_SUBJECT_KEY EXTN_SUBJECT_KEY,
	C68_NOTIFY_AFTER_SHIPMENT_FLAG NOTIFY_AFTER_SHIPMENT_FLAG,
	C69_EXTN_SUBJECT_LASTNAME EXTN_SUBJECT_LASTNAME,
	C70_RETURN_OH_KEY_FOR_EXCHANGE RETURN_OH_KEY_FOR_EXCHANGE,
	C71_EXTN_SHIP_ORDERS_TO EXTN_SHIP_ORDERS_TO,
	C72_VENDOR_ID VENDOR_ID,
	C73_CONTACT_KEY CONTACT_KEY,
	C74_TAX TAX,
	C75_RECEIVING_NODE RECEIVING_NODE,
	C76_TAX_EXEMPTION_CERTIFICATE TAX_EXEMPTION_CERTIFICATE,
	C77_CREATETS CREATETS,
	C78_PAYMENT_STATUS PAYMENT_STATUS,
	C79_EXTN_DIE_CUT EXTN_DIE_CUT,
	C80_EXCHANGE_TYPE EXCHANGE_TYPE,
	C81_CREATEPROGID CREATEPROGID,
	C82_EXTN_ORDER_ACCOUNT_NAME EXTN_ORDER_ACCOUNT_NAME,
	C83_EXTN_OVERRIDE_1 EXTN_OVERRIDE_1,
	C84_EXTN_SUBJECT_FIRSTNAME EXTN_SUBJECT_FIRSTNAME,
	C85_EXTN_BATCH_ID EXTN_BATCH_ID,
	C86_SOLD_TO_KEY SOLD_TO_KEY,
	C87_MARK_FOR_KEY MARK_FOR_KEY,
	C88_SHIP_TO_ID SHIP_TO_ID,
	C89_TERMS_CODE TERMS_CODE,
	C90_ADJUSTMENT_INVOICE_PENDING ADJUSTMENT_INVOICE_PENDING,
	C91_DEFAULT_TEMPLATE DEFAULT_TEMPLATE,
	C92_ENTRY_TYPE ENTRY_TYPE,
	C93_TEAM_CODE TEAM_CODE,
	C94_CREATED_AT_NODE CREATED_AT_NODE,
	C95_ORDER_NO ORDER_NO,
	C96_EXTN_PHOTOGRAPHY_LOCATION EXTN_PHOTOGRAPHY_LOCATION,
	C97_ORDER_HEADER_KEY ORDER_HEADER_KEY,
	C98_RETURN_BY_GIFT_RECIPIENT RETURN_BY_GIFT_RECIPIENT,
	C99_ORDER_DATE ORDER_DATE,
	C100_ORDER_NAME ORDER_NAME,
	C101_SHIP_TO_KEY SHIP_TO_KEY,
	C102_MODIFYTS MODIFYTS,
	C103_NOTIFICATION_TYPE NOTIFICATION_TYPE,
	C104_AUTO_CANCEL_DATE AUTO_CANCEL_DATE,
	C105_ALLOCATION_RULE_ID ALLOCATION_RULE_ID,
	C106_EXTN_SPECIAL_INSTRUCTIONS EXTN_SPECIAL_INSTRUCTIONS,
	C107_BUYER_MARK_FOR_NODE_ID BUYER_MARK_FOR_NODE_ID,
	C108_IS_LINE_SHIP_SINGLE_NODE IS_LINE_SHIP_SINGLE_NODE,
	C109_EXTN_COD_RELEASE_NO EXTN_COD_RELEASE_NO,
	C110_CREATEUSERID CREATEUSERID,
	C111_EXTN_VALUEPLUS EXTN_VALUEPLUS,
	C112_CHAIN_TYPE CHAIN_TYPE,
	C113_TAXPAYER_ID TAXPAYER_ID,
	C114_SOURCE_TYPE SOURCE_TYPE,
	C115_EXTN_LINEN_TEXTURE EXTN_LINEN_TEXTURE,
	C116_TAX_JURISDICTION TAX_JURISDICTION,
	C117_NOTIFICATION_REFERENCE NOTIFICATION_REFERENCE,
	C118_PRICING_CLASSIFICATION_CO PRICING_CLASSIFICATION_CODE,
	C119_OTHER_CHARGES OTHER_CHARGES,
	C120_ORDER_PURPOSE ORDER_PURPOSE,
	C121_ORIGINAL_TOTAL_AMOUNT ORIGINAL_TOTAL_AMOUNT,
	C122_DRAFT_ORDER_FLAG DRAFT_ORDER_FLAG,
	C123_EXTN_ORDER_PROCESSING_LAB EXTN_ORDER_PROCESSING_LAB,
	C124_HOLD_REASON_CODE HOLD_REASON_CODE,
	C125_EXTN_EVENT_REF_ID EXTN_EVENT_REF_ID,
	C126_FOB FOB,
	C127_RECREATE_AUTHORIZATIONS RECREATE_AUTHORIZATIONS,
	C128_SELLER_ORGANIZATION_CODE SELLER_ORGANIZATION_CODE,
	C129_PENDING_TRANSFER_IN PENDING_TRANSFER_IN,
	C130_ORIGINAL_CONTAINER_KEY ORIGINAL_CONTAINER_KEY,
	C131_IS_SHIP_COMPLETE IS_SHIP_COMPLETE,
	C132_ENTERPRISE_KEY ENTERPRISE_KEY,
	C133_REQ_DELIVERY_DATE REQ_DELIVERY_DATE,
	C134_CARRIER_SERVICE_CODE CARRIER_SERVICE_CODE,
	C135_DO_NOT_CONSOLIDATE DO_NOT_CONSOLIDATE,
	C136_CANCEL_ORDER_ON_EXCP_FLAG CANCEL_ORDER_ON_EXCP_FLAG,
	C137_CUSTOMER_CUSTOMER_PO_NO CUSTOMER_CUSTOMER_PO_NO,
	C138_NEXT_ITER_SEQ_NO NEXT_ITER_SEQ_NO,
	C139_EXTN_ORDER_ELECTRONIC_ORD EXTN_ORDER_ELECTRONIC_ORDER,
	C140_NEXT_ITER_DATE NEXT_ITER_DATE,
	C141_PAYMENT_RULE_ID PAYMENT_RULE_ID,
	C142_LOCKID LOCKID,
	C143_IS_SHIP_SINGLE_NODE IS_SHIP_SINGLE_NODE,
	C144_SCAC SCAC,
	C145_EXTN_LAST_USER_MODIFIED_D EXTN_LAST_USER_MODIFIED_DATE,
	C146_EXTN_REQ_SHIP_DATE EXTN_REQ_SHIP_DATE,
	C147_EXTN_SUBJECT_GRADE EXTN_SUBJECT_GRADE,
	C148_EXTN_ORDER_STATUS EXTN_ORDER_STATUS,
	C149_EXTN_RETAKE_NO EXTN_RETAKE_NO,
	C150_EXTN_DONTRELEASEUNTIL_DAT EXTN_DONTRELEASEUNTIL_DATE,
	C151_EXTN_PARENT_RETAKE_NO EXTN_PARENT_RETAKE_NO,
	C152_EXTN_BATCHING_REQUIRED EXTN_BATCHING_REQUIRED,
	C153_EXTN_PRICE_PROGRAM EXTN_PRICE_PROGRAM,
	C154_EXTN_PARENT_ORDER_HEADER_ EXTN_PARENT_ORDER_HEADER_KEY,
	C155_EXTN_SHUTTERFLYNOTE_ELIGI EXTN_SHUTTERFLYNOTE_ELIGIBLE,
	C156_EXTN_CANCEL_COMMENT EXTN_CANCEL_COMMENT,
	C157_EXTN_REPLAYED_WOB EXTN_REPLAYED_WOB 
from	RAX_APP_USER.C$_0STG_ORDER_HEADER
where		(1=1)	






)    ODI_GET_FROM




&


/*-----------------------------------------------*/
/* TASK No. 32 */
/* Commit transaction */

/* commit */


/*-----------------------------------------------*/
/* TASK No. 1000028 */
/* Drop work table */

drop table RAX_APP_USER.C$_0STG_ORDER_HEADER 

&


/*-----------------------------------------------*/
/* TASK No. 33 */
/* Insert new rows */

 
insert into	ODS_OWN.ORDER_CHANNEL 
( 
	CHANNEL_NAME,
	SOURCE_SYSTEM_OID 
	,ORDER_CHANNEL_OID,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE 
) 

select
    CHANNEL_NAME,
	SOURCE_SYSTEM_OID   
  ,ODS_STAGE.ORDER_CHANNEL_OID_SEQ.nextval,
	SYSDATE,
	SYSDATE 
FROM (	


select 	DISTINCT
	TRIM(OH.ENTRY_TYPE) CHANNEL_NAME,
	SOURCE_SYSTEM.SOURCE_SYSTEM_OID SOURCE_SYSTEM_OID 
from	RAX_APP_USER.STG_ORDER_HEADER   OH, ODS_OWN.SOURCE_SYSTEM   SOURCE_SYSTEM, ODS_OWN.ORDER_CHANNEL   ORDER_CHANNEL
where		(1=1)	
 And (trim(OH.ENTRY_TYPE)=ORDER_CHANNEL.CHANNEL_NAME (+) AND ORDER_CHANNEL.CHANNEL_NAME IS NULL and trim(OH.ENTRY_TYPE) IS NOT NULL)
And (SOURCE_SYSTEM.SOURCE_SYSTEM_SHORT_NAME='OMS')
 And (trim(OH.ENTRY_TYPE) is not null)




)    ODI_GET_FROM




&


/*-----------------------------------------------*/
/* TASK No. 34 */
/* Commit transaction */

/* commit */


/*-----------------------------------------------*/
/* TASK No. 35 */
/* Insert new rows */

 
insert into	ODS_OWN.ORDER_TYPE 
( 
	ORDER_TYPE,
	SOURCE_SYSTEM_OID 
	,ORDER_TYPE_OID,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE 
) 

select
    ORDER_TYPE,
	SOURCE_SYSTEM_OID   
  ,ODS_STAGE.ORDER_TYPE_OID_SEQ.nextval,
	SYSDATE,
	SYSDATE 
FROM (	


select 	DISTINCT
	TRIM(OH.ORDER_TYPE) ORDER_TYPE,
	SOURCE_SYSTEM.SOURCE_SYSTEM_OID SOURCE_SYSTEM_OID 
from	RAX_APP_USER.STG_ORDER_HEADER   OH, ODS_OWN.SOURCE_SYSTEM   SOURCE_SYSTEM, ODS_OWN.ORDER_TYPE   ORDER_TYPE
where		(1=1)	
 And (OH.ORDER_TYPE=ORDER_TYPE.ORDER_TYPE (+)
AND ORDER_TYPE.ORDER_TYPE IS NULL)
And (SOURCE_SYSTEM.SOURCE_SYSTEM_SHORT_NAME='OMS')




)    ODI_GET_FROM




&


/*-----------------------------------------------*/
/* TASK No. 36 */
/* Commit transaction */

/* commit */


/*-----------------------------------------------*/
/* TASK No. 37 */
/* Set vID */

/* NONE or SET VARIABLE STATEMENT FOUND, CHECK ODI TASK NO. 37 */




/*-----------------------------------------------*/
/* TASK No. 38 */
/* Drop flow table */

BEGIN  
   EXECUTE IMMEDIATE 'drop table RAX_APP_USER.I$_OMS_OH_XR63001';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -942 THEN  
         RAISE;  
      END IF;  
END;

&


/*-----------------------------------------------*/
/* TASK No. 39 */
/* Create flow table I$ */

create table RAX_APP_USER.I$_OMS_OH_XR63001
(
	ORDER_HEADER_OID	NUMBER NULL,
	ORDER_HEADER_KEY	VARCHAR2(24) NULL,
	ODS_CREATE_DATE	DATE NULL,
	EXTN_ORDER_APO_KEY	VARCHAR2(24) NULL,
	SHIP_TO_KEY	VARCHAR2(24) NULL,
	PRICE_PROGRAM_NAME	VARCHAR2(255) NULL,
	BILL_TO_KEY	VARCHAR2(24) NULL,
	ODS_MODIFY_DATE	DATE NULL
	,IND_UPDATE		char(1)
)
NOLOGGING

&


/*-----------------------------------------------*/
/* TASK No. 40 */
/* Insert flow into I$ table */

/* DETECTION_STRATEGY = NOT_EXISTS */
 


  


insert into	RAX_APP_USER.I$_OMS_OH_XR63001
(
	ORDER_HEADER_KEY,
	EXTN_ORDER_APO_KEY,
	SHIP_TO_KEY,
	PRICE_PROGRAM_NAME,
	BILL_TO_KEY,
	IND_UPDATE
)
select 
ORDER_HEADER_KEY,
	EXTN_ORDER_APO_KEY,
	SHIP_TO_KEY,
	PRICE_PROGRAM_NAME,
	BILL_TO_KEY,
	IND_UPDATE
 from (


select 	 
	DISTINCT
	TRIM(OH.ORDER_HEADER_KEY) ORDER_HEADER_KEY,
	TRIM(OH.EXTN_ORDER_APO_KEY) EXTN_ORDER_APO_KEY,
	TRIM(OH.SHIP_TO_KEY) SHIP_TO_KEY,
	TRIM(OH.EXTN_PRICE_PROGRAM) PRICE_PROGRAM_NAME,
	TRIM(OH.BILL_TO_KEY) BILL_TO_KEY,

	'I' IND_UPDATE

from	RAX_APP_USER.STG_ORDER_HEADER   OH, ODS_STAGE.OMS_ORDER_HEADER_XR   OMS_ORDER_HEADER_XR
where	(1=1)
 And (TRIM(OH.ORDER_HEADER_KEY)=OMS_ORDER_HEADER_XR.ORDER_HEADER_KEY (+)
/*AND OMS_ORDER_HEADER_XR.ORDER_HEADER_KEY IS NULL*/)





) S
where NOT EXISTS 
	( select 1 from ODS_STAGE.OMS_ORDER_HEADER_XR T
	where	T.ORDER_HEADER_KEY	= S.ORDER_HEADER_KEY 
		 and ((T.EXTN_ORDER_APO_KEY = S.EXTN_ORDER_APO_KEY) or (T.EXTN_ORDER_APO_KEY IS NULL and S.EXTN_ORDER_APO_KEY IS NULL)) and
		((T.SHIP_TO_KEY = S.SHIP_TO_KEY) or (T.SHIP_TO_KEY IS NULL and S.SHIP_TO_KEY IS NULL)) and
		((T.PRICE_PROGRAM_NAME = S.PRICE_PROGRAM_NAME) or (T.PRICE_PROGRAM_NAME IS NULL and S.PRICE_PROGRAM_NAME IS NULL)) and
		((T.BILL_TO_KEY = S.BILL_TO_KEY) or (T.BILL_TO_KEY IS NULL and S.BILL_TO_KEY IS NULL))
        )

  
  

  



&


/*-----------------------------------------------*/
/* TASK No. 41 */
/* Analyze integration table */



begin
    dbms_stats.gather_table_stats(
	ownname => 'RAX_APP_USER',
	tabname => 'I$_OMS_OH_XR63001',
	estimate_percent => dbms_stats.auto_sample_size
    );
end;



&


/*-----------------------------------------------*/
/* TASK No. 42 */
/* Create Index on flow table */

create index	RAX_APP_USER.I$_OMS_OH_XR_IDX63001
on		RAX_APP_USER.I$_OMS_OH_XR63001 (ORDER_HEADER_KEY)
NOLOGGING

&


/*-----------------------------------------------*/
/* TASK No. 43 */
/* Merge Rows */

merge into	ODS_STAGE.OMS_ORDER_HEADER_XR T
using	RAX_APP_USER.I$_OMS_OH_XR63001 S
on	(
		T.ORDER_HEADER_KEY=S.ORDER_HEADER_KEY
	)
when matched
then update set
	T.EXTN_ORDER_APO_KEY	= S.EXTN_ORDER_APO_KEY,
	T.SHIP_TO_KEY	= S.SHIP_TO_KEY,
	T.PRICE_PROGRAM_NAME	= S.PRICE_PROGRAM_NAME,
	T.BILL_TO_KEY	= S.BILL_TO_KEY
	,    T.ODS_MODIFY_DATE	= SYSDATE
when not matched
then insert
	(
	T.ORDER_HEADER_KEY,
	T.EXTN_ORDER_APO_KEY,
	T.SHIP_TO_KEY,
	T.PRICE_PROGRAM_NAME,
	T.BILL_TO_KEY
	,     T.ORDER_HEADER_OID,
	T.ODS_CREATE_DATE,
	T.ODS_MODIFY_DATE
	)
values
	(
	S.ORDER_HEADER_KEY,
	S.EXTN_ORDER_APO_KEY,
	S.SHIP_TO_KEY,
	S.PRICE_PROGRAM_NAME,
	S.BILL_TO_KEY
	,     ODS_STAGE.ORDER_HEADER_OID_SEQ.nextval,
	SYSDATE,
	SYSDATE
	)

&


/*-----------------------------------------------*/
/* TASK No. 44 */
/* Commit transaction */

/*commit*/


/*-----------------------------------------------*/
/* TASK No. 45 */
/* Drop flow table */

drop table RAX_APP_USER.I$_OMS_OH_XR63001 

&


/*-----------------------------------------------*/
/* TASK No. 46 */
/* Drop flow table */

BEGIN  
   EXECUTE IMMEDIATE 'drop table RAX_APP_USER.I$_ORDER_HEADER';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -942 THEN  
         RAISE;  
      END IF;  
END;

&


/*-----------------------------------------------*/
/* TASK No. 47 */
/* Create flow table I$ */

create table RAX_APP_USER.I$_ORDER_HEADER
(
	ORDER_HEADER_OID		NUMBER NULL,
	ORDER_NO		VARCHAR2(40) NULL,
	ORDER_FORM_ID		VARCHAR2(20) NULL,
	MATCHED_CAPTURE_SESSION_ID		VARCHAR2(100) NULL,
	EVENT_REF_ID		VARCHAR2(10) NULL,
	BATCH_ID		VARCHAR2(40) NULL,
	TOTAL_AMOUNT		NUMBER NULL,
	APO_OID		NUMBER NULL,
	ORDER_TYPE_OID		NUMBER NULL,
	ORDER_CHANNEL_OID		NUMBER NULL,
	PRICE_PROGRAM_OID		NUMBER NULL,
	EVENT_OID		NUMBER NULL,
	SHIP_NODE		VARCHAR2(50) NULL,
	DRAFT_ORDER_FLAG		VARCHAR2(1) NULL,
	HOLD_FLAG		VARCHAR2(1) NULL,
	HOLD_REASON_CODE		VARCHAR2(50) NULL,
	INVOICE_COMPLETE		VARCHAR2(1) NULL,
	IS_SHIP_COMPLETE		VARCHAR2(1) NULL,
	ORDER_CLOSED		VARCHAR2(1) NULL,
	ORDER_DATE		DATE NULL,
	ORDER_TYPE		VARCHAR2(50) NULL,
	PAYMENT_STATUS		VARCHAR2(15) NULL,
	TAX		NUMBER NULL,
	TAX_EXEMPTION_CERTIFICATE		VARCHAR2(50) NULL,
	TAX_EXEMPT_FLAG		VARCHAR2(1) NULL,
	TAX_JURISDICTION		VARCHAR2(50) NULL,
	SHIP_ORDERS_TO		VARCHAR2(15) NULL,
	ODS_CREATE_DATE		DATE NULL,
	ODS_MODIFY_DATE		DATE NULL,
	SOURCE_SYSTEM_OID		NUMBER NULL,
	CURRENCY		VARCHAR2(20) NULL,
	TERRITORY_CODE		VARCHAR2(24) NULL,
	PERSON_INFO_OID		NUMBER NULL,
	LAST_USER_MODIFIED_DATE		DATE NULL,
	REQUESTED_DELIVERY_DATE		DATE NULL,
	SCAC		VARCHAR2(40) NULL,
	CARRIER_SERVICE_CODE		VARCHAR2(40) NULL,
	REQUESTED_SHIP_DATE		DATE NULL,
	SUBJECT_FIRST_NAME		VARCHAR2(255) NULL,
	SUBJECT_MIDDLE_NAME		VARCHAR2(255) NULL,
	SUBJECT_LAST_NAME		VARCHAR2(255) NULL,
	SUBJECT_GRADE		VARCHAR2(255) NULL,
	RETAKE_NO		VARCHAR2(100) NULL,
	PARENT_RETAKE_NO		VARCHAR2(100) NULL,
	DONT_RELEASE_UNTIL_DATE		DATE NULL,
	ORDER_STATUS		VARCHAR2(100) NULL,
	BATCHING_REQUIRED		CHAR(1) NULL,
	CUSTOMER_EMAILID		VARCHAR2(150) NULL,
	OMS_CREATETS		DATE NULL,
	CUSTOMER_PO_NO		VARCHAR2(100) NULL,
	BILL_TO_PERSON_INFO_OID		NUMBER NULL,
	SHIP_TO_PERSON_INFO_OID		NUMBER NULL,
	ORDER_STATUS_OID		NUMBER NULL,
	PARENT_ORDER_HEADER_OID		NUMBER NULL,
	DOCUMENT_TYPE		VARCHAR2(40) NULL,
	OMS_TAX		NUMBER NULL,
	CANCEL_COMMENT		VARCHAR2(300) NULL,
	SHUTTERFLY_NOTE_ELIGIBLE		CHAR(1) NULL,
	REPLAYED_WOB		VARCHAR2(40) NULL,
	IND_UPDATE		CHAR(1)
)
NOLOGGING

&


/*-----------------------------------------------*/
/* TASK No. 48 */
/* Insert flow into I$ table */

/* DETECTION_STRATEGY = NOT_EXISTS */
 


  


insert into	RAX_APP_USER.I$_ORDER_HEADER
(
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB,
	IND_UPDATE
)
select 
ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB,
	IND_UPDATE
 from (


select 	 
	
	OH_XR.ORDER_HEADER_OID ORDER_HEADER_OID,
	TRIM(OH.ORDER_NO) ORDER_NO,
	OH.EXTN_EXTERNAL_REF_ID ORDER_FORM_ID,
	OH.EXTN_SESSION_ID MATCHED_CAPTURE_SESSION_ID,
	OH.EXTN_EVENT_REF_ID EVENT_REF_ID,
	OH.EXTN_BATCH_ID BATCH_ID,
	OH.TOTAL_AMOUNT TOTAL_AMOUNT,
	EVENT.APO_OID APO_OID,
	OT.ORDER_TYPE_OID ORDER_TYPE_OID,
	OC.ORDER_CHANNEL_OID ORDER_CHANNEL_OID,
	PP.PRICE_PROGRAM_OID PRICE_PROGRAM_OID,
	EVENT.EVENT_OID EVENT_OID,
	trim(OH.SHIP_NODE) SHIP_NODE,
	OH.DRAFT_ORDER_FLAG DRAFT_ORDER_FLAG,
	OH.HOLD_FLAG HOLD_FLAG,
	OH.HOLD_REASON_CODE HOLD_REASON_CODE,
	OH.INVOICE_COMPLETE INVOICE_COMPLETE,
	OH.IS_SHIP_COMPLETE IS_SHIP_COMPLETE,
	OH.ORDER_CLOSED ORDER_CLOSED,
	OH.ORDER_DATE ORDER_DATE,
	OH.ORDER_TYPE ORDER_TYPE,
	trim(OH.PAYMENT_STATUS) PAYMENT_STATUS,
	OH.TAX TAX,
	OH.TAX_EXEMPTION_CERTIFICATE TAX_EXEMPTION_CERTIFICATE,
	OH.TAX_EXEMPT_FLAG TAX_EXEMPT_FLAG,
	OH.TAX_JURISDICTION TAX_JURISDICTION,
	OH.EXTN_SHIP_ORDERS_TO SHIP_ORDERS_TO,
	SOURCE_SYSTEM.SOURCE_SYSTEM_OID SOURCE_SYSTEM_OID,
	OH.CURRENCY CURRENCY,
	trim(OH.ENTERPRISE_KEY) TERRITORY_CODE,
	SHIP_TO_PI.PERSON_INFO_OID PERSON_INFO_OID,
	OH.EXTN_LAST_USER_MODIFIED_DATE LAST_USER_MODIFIED_DATE,
	OH.REQ_DELIVERY_DATE REQUESTED_DELIVERY_DATE,
	OH.SCAC SCAC,
	OH.CARRIER_SERVICE_CODE CARRIER_SERVICE_CODE,
	OH.EXTN_REQ_SHIP_DATE REQUESTED_SHIP_DATE,
	OH.EXTN_SUBJECT_FIRSTNAME SUBJECT_FIRST_NAME,
	OH.EXTN_SUBJECT_MIDDLENAME SUBJECT_MIDDLE_NAME,
	OH.EXTN_SUBJECT_LASTNAME SUBJECT_LAST_NAME,
	OH.EXTN_SUBJECT_GRADE SUBJECT_GRADE,
	OH.EXTN_RETAKE_NO RETAKE_NO,
	OH.EXTN_PARENT_RETAKE_NO PARENT_RETAKE_NO,
	OH.EXTN_DONTRELEASEUNTIL_DATE DONT_RELEASE_UNTIL_DATE,
	OS.ORDER_STATUS ORDER_STATUS,
	OH.EXTN_BATCHING_REQUIRED BATCHING_REQUIRED,
	OH.CUSTOMER_EMAILID CUSTOMER_EMAILID,
	OH.CREATETS OMS_CREATETS,
	OH.CUSTOMER_PO_NO CUSTOMER_PO_NO,
	BILL_TO_PI.PERSON_INFO_OID BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PI.PERSON_INFO_OID SHIP_TO_PERSON_INFO_OID,
	OS.ORDER_STATUS_OID ORDER_STATUS_OID,
	PARENT_OH_XR.ORDER_HEADER_OID PARENT_ORDER_HEADER_OID,
	OH.DOCUMENT_TYPE DOCUMENT_TYPE,
	OH.TAX OMS_TAX,
	OH.EXTN_CANCEL_COMMENT CANCEL_COMMENT,
	OH.EXTN_SHUTTERFLYNOTE_ELIGIBLE SHUTTERFLY_NOTE_ELIGIBLE,
	trim(OH.EXTN_REPLAYED_WOB) REPLAYED_WOB,

	'I' IND_UPDATE

from	RAX_APP_USER.STG_ORDER_HEADER   OH, ODS_OWN.SOURCE_SYSTEM   SOURCE_SYSTEM, ODS_STAGE.OMS_PERSON_INFO_XR   BILL_TO_PI, ODS_OWN.ORDER_STATUS   OS, ODS_STAGE.OMS_ORDER_HEADER_XR   PARENT_OH_XR, ODS_STAGE.OMS_ORDER_HEADER_XR   OH_XR, ODS_OWN.PRICE_PROGRAM   PP, ODS_OWN.ORDER_CHANNEL   OC, ODS_OWN.APO   APO, ODS_OWN.ORDER_TYPE   OT, ODS_OWN.EVENT   EVENT, ODS_STAGE.OMS_PERSON_INFO_XR   SHIP_TO_PI, ODS_STAGE.OMS3_LT_APO_STG   LT_APO2
where	(1=1)
 And (OH_XR.BILL_TO_KEY=TRIM(BILL_TO_PI.PERSON_INFO_KEY (+)))
AND (OH.EXTN_ORDER_STATUS=OS.ORDER_STATUS_CODE (+))
AND (TRIM(OH.EXTN_PARENT_ORDER_HEADER_KEY)=PARENT_OH_XR.ORDER_HEADER_KEY (+))
AND (TRIM(OH.ORDER_HEADER_KEY)=OH_XR.ORDER_HEADER_KEY)
AND (OH_XR.PRICE_PROGRAM_NAME=PP.PRICE_PROGRAM_NAME (+))
AND (OH.ENTRY_TYPE=OC.CHANNEL_NAME (+))
AND (TRIM(OH.ORDER_TYPE)=OT.ORDER_TYPE (+))
AND (OH.EXTN_EVENT_REF_ID=EVENT.EVENT_REF_ID (+))
AND (OH_XR.SHIP_TO_KEY=TRIM(SHIP_TO_PI.PERSON_INFO_KEY (+)))
AND (OH_XR.EXTN_ORDER_APO_KEY=LT_APO2.APO_KEY (+))
AND (LT_APO2.APO_ID=APO.APO_ID (+))
And (SOURCE_SYSTEM.SOURCE_SYSTEM_SHORT_NAME='OMS')




) S
where NOT EXISTS 
	( select 1 from ODS_OWN.ORDER_HEADER T
	where	T.ORDER_HEADER_OID	= S.ORDER_HEADER_OID 
		 and ((T.ORDER_NO = S.ORDER_NO) or (T.ORDER_NO IS NULL and S.ORDER_NO IS NULL)) and
		((T.ORDER_FORM_ID = S.ORDER_FORM_ID) or (T.ORDER_FORM_ID IS NULL and S.ORDER_FORM_ID IS NULL)) and
		((T.MATCHED_CAPTURE_SESSION_ID = S.MATCHED_CAPTURE_SESSION_ID) or (T.MATCHED_CAPTURE_SESSION_ID IS NULL and S.MATCHED_CAPTURE_SESSION_ID IS NULL)) and
		((T.EVENT_REF_ID = S.EVENT_REF_ID) or (T.EVENT_REF_ID IS NULL and S.EVENT_REF_ID IS NULL)) and
		((T.BATCH_ID = S.BATCH_ID) or (T.BATCH_ID IS NULL and S.BATCH_ID IS NULL)) and
		((T.TOTAL_AMOUNT = S.TOTAL_AMOUNT) or (T.TOTAL_AMOUNT IS NULL and S.TOTAL_AMOUNT IS NULL)) and
		((T.APO_OID = S.APO_OID) or (T.APO_OID IS NULL and S.APO_OID IS NULL)) and
		((T.ORDER_TYPE_OID = S.ORDER_TYPE_OID) or (T.ORDER_TYPE_OID IS NULL and S.ORDER_TYPE_OID IS NULL)) and
		((T.ORDER_CHANNEL_OID = S.ORDER_CHANNEL_OID) or (T.ORDER_CHANNEL_OID IS NULL and S.ORDER_CHANNEL_OID IS NULL)) and
		((T.PRICE_PROGRAM_OID = S.PRICE_PROGRAM_OID) or (T.PRICE_PROGRAM_OID IS NULL and S.PRICE_PROGRAM_OID IS NULL)) and
		((T.EVENT_OID = S.EVENT_OID) or (T.EVENT_OID IS NULL and S.EVENT_OID IS NULL)) and
		((T.SHIP_NODE = S.SHIP_NODE) or (T.SHIP_NODE IS NULL and S.SHIP_NODE IS NULL)) and
		((T.DRAFT_ORDER_FLAG = S.DRAFT_ORDER_FLAG) or (T.DRAFT_ORDER_FLAG IS NULL and S.DRAFT_ORDER_FLAG IS NULL)) and
		((T.HOLD_FLAG = S.HOLD_FLAG) or (T.HOLD_FLAG IS NULL and S.HOLD_FLAG IS NULL)) and
		((T.HOLD_REASON_CODE = S.HOLD_REASON_CODE) or (T.HOLD_REASON_CODE IS NULL and S.HOLD_REASON_CODE IS NULL)) and
		((T.INVOICE_COMPLETE = S.INVOICE_COMPLETE) or (T.INVOICE_COMPLETE IS NULL and S.INVOICE_COMPLETE IS NULL)) and
		((T.IS_SHIP_COMPLETE = S.IS_SHIP_COMPLETE) or (T.IS_SHIP_COMPLETE IS NULL and S.IS_SHIP_COMPLETE IS NULL)) and
		((T.ORDER_CLOSED = S.ORDER_CLOSED) or (T.ORDER_CLOSED IS NULL and S.ORDER_CLOSED IS NULL)) and
		((T.ORDER_DATE = S.ORDER_DATE) or (T.ORDER_DATE IS NULL and S.ORDER_DATE IS NULL)) and
		((T.ORDER_TYPE = S.ORDER_TYPE) or (T.ORDER_TYPE IS NULL and S.ORDER_TYPE IS NULL)) and
		((T.PAYMENT_STATUS = S.PAYMENT_STATUS) or (T.PAYMENT_STATUS IS NULL and S.PAYMENT_STATUS IS NULL)) and
		((T.TAX = S.TAX) or (T.TAX IS NULL and S.TAX IS NULL)) and
		((T.TAX_EXEMPTION_CERTIFICATE = S.TAX_EXEMPTION_CERTIFICATE) or (T.TAX_EXEMPTION_CERTIFICATE IS NULL and S.TAX_EXEMPTION_CERTIFICATE IS NULL)) and
		((T.TAX_EXEMPT_FLAG = S.TAX_EXEMPT_FLAG) or (T.TAX_EXEMPT_FLAG IS NULL and S.TAX_EXEMPT_FLAG IS NULL)) and
		((T.TAX_JURISDICTION = S.TAX_JURISDICTION) or (T.TAX_JURISDICTION IS NULL and S.TAX_JURISDICTION IS NULL)) and
		((T.SHIP_ORDERS_TO = S.SHIP_ORDERS_TO) or (T.SHIP_ORDERS_TO IS NULL and S.SHIP_ORDERS_TO IS NULL)) and
		((T.SOURCE_SYSTEM_OID = S.SOURCE_SYSTEM_OID) or (T.SOURCE_SYSTEM_OID IS NULL and S.SOURCE_SYSTEM_OID IS NULL)) and
		((T.CURRENCY = S.CURRENCY) or (T.CURRENCY IS NULL and S.CURRENCY IS NULL)) and
		((T.TERRITORY_CODE = S.TERRITORY_CODE) or (T.TERRITORY_CODE IS NULL and S.TERRITORY_CODE IS NULL)) and
		((T.PERSON_INFO_OID = S.PERSON_INFO_OID) or (T.PERSON_INFO_OID IS NULL and S.PERSON_INFO_OID IS NULL)) and
		((T.LAST_USER_MODIFIED_DATE = S.LAST_USER_MODIFIED_DATE) or (T.LAST_USER_MODIFIED_DATE IS NULL and S.LAST_USER_MODIFIED_DATE IS NULL)) and
		((T.REQUESTED_DELIVERY_DATE = S.REQUESTED_DELIVERY_DATE) or (T.REQUESTED_DELIVERY_DATE IS NULL and S.REQUESTED_DELIVERY_DATE IS NULL)) and
		((T.SCAC = S.SCAC) or (T.SCAC IS NULL and S.SCAC IS NULL)) and
		((T.CARRIER_SERVICE_CODE = S.CARRIER_SERVICE_CODE) or (T.CARRIER_SERVICE_CODE IS NULL and S.CARRIER_SERVICE_CODE IS NULL)) and
		((T.REQUESTED_SHIP_DATE = S.REQUESTED_SHIP_DATE) or (T.REQUESTED_SHIP_DATE IS NULL and S.REQUESTED_SHIP_DATE IS NULL)) and
		((T.SUBJECT_FIRST_NAME = S.SUBJECT_FIRST_NAME) or (T.SUBJECT_FIRST_NAME IS NULL and S.SUBJECT_FIRST_NAME IS NULL)) and
		((T.SUBJECT_MIDDLE_NAME = S.SUBJECT_MIDDLE_NAME) or (T.SUBJECT_MIDDLE_NAME IS NULL and S.SUBJECT_MIDDLE_NAME IS NULL)) and
		((T.SUBJECT_LAST_NAME = S.SUBJECT_LAST_NAME) or (T.SUBJECT_LAST_NAME IS NULL and S.SUBJECT_LAST_NAME IS NULL)) and
		((T.SUBJECT_GRADE = S.SUBJECT_GRADE) or (T.SUBJECT_GRADE IS NULL and S.SUBJECT_GRADE IS NULL)) and
		((T.RETAKE_NO = S.RETAKE_NO) or (T.RETAKE_NO IS NULL and S.RETAKE_NO IS NULL)) and
		((T.PARENT_RETAKE_NO = S.PARENT_RETAKE_NO) or (T.PARENT_RETAKE_NO IS NULL and S.PARENT_RETAKE_NO IS NULL)) and
		((T.DONT_RELEASE_UNTIL_DATE = S.DONT_RELEASE_UNTIL_DATE) or (T.DONT_RELEASE_UNTIL_DATE IS NULL and S.DONT_RELEASE_UNTIL_DATE IS NULL)) and
		((T.ORDER_STATUS = S.ORDER_STATUS) or (T.ORDER_STATUS IS NULL and S.ORDER_STATUS IS NULL)) and
		((T.BATCHING_REQUIRED = S.BATCHING_REQUIRED) or (T.BATCHING_REQUIRED IS NULL and S.BATCHING_REQUIRED IS NULL)) and
		((T.CUSTOMER_EMAILID = S.CUSTOMER_EMAILID) or (T.CUSTOMER_EMAILID IS NULL and S.CUSTOMER_EMAILID IS NULL)) and
		((T.OMS_CREATETS = S.OMS_CREATETS) or (T.OMS_CREATETS IS NULL and S.OMS_CREATETS IS NULL)) and
		((T.CUSTOMER_PO_NO = S.CUSTOMER_PO_NO) or (T.CUSTOMER_PO_NO IS NULL and S.CUSTOMER_PO_NO IS NULL)) and
		((T.BILL_TO_PERSON_INFO_OID = S.BILL_TO_PERSON_INFO_OID) or (T.BILL_TO_PERSON_INFO_OID IS NULL and S.BILL_TO_PERSON_INFO_OID IS NULL)) and
		((T.SHIP_TO_PERSON_INFO_OID = S.SHIP_TO_PERSON_INFO_OID) or (T.SHIP_TO_PERSON_INFO_OID IS NULL and S.SHIP_TO_PERSON_INFO_OID IS NULL)) and
		((T.ORDER_STATUS_OID = S.ORDER_STATUS_OID) or (T.ORDER_STATUS_OID IS NULL and S.ORDER_STATUS_OID IS NULL)) and
		((T.PARENT_ORDER_HEADER_OID = S.PARENT_ORDER_HEADER_OID) or (T.PARENT_ORDER_HEADER_OID IS NULL and S.PARENT_ORDER_HEADER_OID IS NULL)) and
		((T.DOCUMENT_TYPE = S.DOCUMENT_TYPE) or (T.DOCUMENT_TYPE IS NULL and S.DOCUMENT_TYPE IS NULL)) and
		((T.OMS_TAX = S.OMS_TAX) or (T.OMS_TAX IS NULL and S.OMS_TAX IS NULL)) and
		((T.CANCEL_COMMENT = S.CANCEL_COMMENT) or (T.CANCEL_COMMENT IS NULL and S.CANCEL_COMMENT IS NULL)) and
		((T.SHUTTERFLY_NOTE_ELIGIBLE = S.SHUTTERFLY_NOTE_ELIGIBLE) or (T.SHUTTERFLY_NOTE_ELIGIBLE IS NULL and S.SHUTTERFLY_NOTE_ELIGIBLE IS NULL)) and
		((T.REPLAYED_WOB = S.REPLAYED_WOB) or (T.REPLAYED_WOB IS NULL and S.REPLAYED_WOB IS NULL))
        )

  
  

  

 


&


/*-----------------------------------------------*/
/* TASK No. 49 */
/* Recycle previous errors */
BEGIN
   EXECUTE IMMEDIATE 'insert into RAX_APP_USER.I$_ORDER_HEADER
(
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB,
	IND_UPDATE
)
select 	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB,
	''I''	IND_UPDATE
from 	RAX_APP_USER.E$_ORDER_HEADER
where 	(ORDER_HEADER_OID, ROWID)  in ( 
		select	ORDER_HEADER_OID,MAX(ROWID)
		from RAX_APP_USER.E$_ORDER_HEADER E
		where not exists (select 1  
			from	RAX_APP_USER.I$_ORDER_HEADER T
			where	T.ORDER_HEADER_OID = E.ORDER_HEADER_OID)
		and	E.ODI_ORIGIN	= ''(19300)ODS_Project.LOAD_ORDER_HEADER_INT''
		and	E.ODI_ERR_TYPE	= ''F''
		group by E.ORDER_HEADER_OID
		)';
EXCEPTION
   WHEN OTHERS THEN
      IF SQLCODE != -942 THEN
         RAISE;
      END IF;
END;


&


/*-----------------------------------------------*/
/* TASK No. 50 */
/* Create Index on flow table */

create index	RAX_APP_USER.I$_ORDER_HEADER_IDX
on		RAX_APP_USER.I$_ORDER_HEADER (ORDER_HEADER_OID)
NOLOGGING

&


/*-----------------------------------------------*/
/* TASK No. 51 */
/* Analyze integration table */



begin
    dbms_stats.gather_table_stats(
	ownname => 'RAX_APP_USER',
	tabname => 'I$_ORDER_HEADER',
	estimate_percent => dbms_stats.auto_sample_size
    );
end;



&


/*-----------------------------------------------*/
/* TASK No. 52 */
/* create check table */


BEGIN  
   EXECUTE IMMEDIATE 'create table RAX_APP_USER.SNP_CHECK_TAB
                        (
                            CATALOG_NAME	VARCHAR2(100 CHAR) NULL ,
                            SCHEMA_NAME	VARCHAR2(100 CHAR) NULL ,
                            RESOURCE_NAME	VARCHAR2(100 CHAR) NULL,
                            FULL_RES_NAME	VARCHAR2(100 CHAR) NULL,
                            ERR_TYPE		VARCHAR2(1 CHAR) NULL,
                            ERR_MESS		VARCHAR2(250 CHAR) NULL ,
                            CHECK_DATE	DATE NULL,
                            ORIGIN		VARCHAR2(100 CHAR) NULL,
                            CONS_NAME	VARCHAR2(35 CHAR) NULL,
                            CONS_TYPE		VARCHAR2(2 CHAR) NULL,
                            ERR_COUNT		NUMBER(10) NULL
                        )';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 THEN  
         RAISE;  
      END IF;  
END;
	

&


/*-----------------------------------------------*/
/* TASK No. 53 */
/* delete previous check sum */

delete from	RAX_APP_USER.SNP_CHECK_TAB
where	SCHEMA_NAME	= 'ODS_OWN'
and	ORIGIN 		= '(19300)ODS_Project.LOAD_ORDER_HEADER_INT'
and	ERR_TYPE 		= 'F'


&


/*-----------------------------------------------*/
/* TASK No. 54 */
/* drop error table */


BEGIN  
   EXECUTE IMMEDIATE 'drop table RAX_APP_USER.E$_ORDER_HEADER';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -942 THEN  
         RAISE;  
      END IF;  
END;


&


/*-----------------------------------------------*/
/* TASK No. 55 */
/* create error table */


create table RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_ROW_ID 		UROWID,
	ODI_ERR_TYPE		VARCHAR2(1 CHAR) NULL, 
	ODI_ERR_MESS		VARCHAR2(250 CHAR) NULL,
	ODI_CHECK_DATE	DATE NULL, 
	ORDER_HEADER_OID	NUMBER NULL,
	ORDER_NO	VARCHAR2(40) NULL,
	ORDER_FORM_ID	VARCHAR2(20) NULL,
	MATCHED_CAPTURE_SESSION_ID	VARCHAR2(100) NULL,
	EVENT_REF_ID	VARCHAR2(10) NULL,
	BATCH_ID	VARCHAR2(40) NULL,
	TOTAL_AMOUNT	NUMBER NULL,
	APO_OID	NUMBER NULL,
	ORDER_TYPE_OID	NUMBER NULL,
	ORDER_CHANNEL_OID	NUMBER NULL,
	PRICE_PROGRAM_OID	NUMBER NULL,
	EVENT_OID	NUMBER NULL,
	SHIP_NODE	VARCHAR2(50) NULL,
	DRAFT_ORDER_FLAG	VARCHAR2(1) NULL,
	HOLD_FLAG	VARCHAR2(1) NULL,
	HOLD_REASON_CODE	VARCHAR2(50) NULL,
	INVOICE_COMPLETE	VARCHAR2(1) NULL,
	IS_SHIP_COMPLETE	VARCHAR2(1) NULL,
	ORDER_CLOSED	VARCHAR2(1) NULL,
	ORDER_DATE	DATE NULL,
	ORDER_TYPE	VARCHAR2(50) NULL,
	PAYMENT_STATUS	VARCHAR2(15) NULL,
	TAX	NUMBER NULL,
	TAX_EXEMPTION_CERTIFICATE	VARCHAR2(50) NULL,
	TAX_EXEMPT_FLAG	VARCHAR2(1) NULL,
	TAX_JURISDICTION	VARCHAR2(50) NULL,
	SHIP_ORDERS_TO	VARCHAR2(15) NULL,
	ODS_CREATE_DATE	DATE NULL,
	ODS_MODIFY_DATE	DATE NULL,
	SOURCE_SYSTEM_OID	NUMBER NULL,
	STAFF_FLAG	VARCHAR2(1) NULL,
	CAPTURE_SESSION_QUANTITY	NUMBER NULL,
	ROOM_QUANTITY	NUMBER NULL,
	STAFF_QUANTITY	NUMBER NULL,
	CURRENCY	VARCHAR2(20) NULL,
	TERRITORY_CODE	VARCHAR2(24) NULL,
	ORDER_SHIP_COMPLETE_IND	VARCHAR2(1) NULL,
	PERSON_INFO_OID	NUMBER NULL,
	CYOP_IND	VARCHAR2(1) NULL,
	IMAGE_PREVIEW_ORDER_TYPE	VARCHAR2(40) NULL,
	ORDER_SHIP_DATE	DATE NULL,
	ORDER_BUCKET	VARCHAR2(20) NULL,
	LAST_USER_MODIFIED_DATE	DATE NULL,
	REQUESTED_DELIVERY_DATE	DATE NULL,
	SCAC	VARCHAR2(40) NULL,
	CARRIER_SERVICE_CODE	VARCHAR2(40) NULL,
	REQUESTED_SHIP_DATE	DATE NULL,
	SUBJECT_FIRST_NAME	VARCHAR2(255) NULL,
	SUBJECT_MIDDLE_NAME	VARCHAR2(255) NULL,
	SUBJECT_LAST_NAME	VARCHAR2(255) NULL,
	SUBJECT_GRADE	VARCHAR2(255) NULL,
	RETAKE_NO	VARCHAR2(100) NULL,
	PARENT_RETAKE_NO	VARCHAR2(100) NULL,
	DONT_RELEASE_UNTIL_DATE	DATE NULL,
	ORDER_STATUS	VARCHAR2(100) NULL,
	BATCHING_REQUIRED	CHAR(1) NULL,
	CUSTOMER_EMAILID	VARCHAR2(150) NULL,
	ORDER_BATCH_OID	NUMBER NULL,
	OMS_CREATETS	DATE NULL,
	CUSTOMER_PO_NO	VARCHAR2(100) NULL,
	BILL_TO_PERSON_INFO_OID	NUMBER NULL,
	SHIP_TO_PERSON_INFO_OID	NUMBER NULL,
	AUTOPACK_CODE	VARCHAR2(16) NULL,
	ORDER_STATUS_OID	NUMBER NULL,
	USER_PROFILE_OID	NUMBER NULL,
	PARENT_ORDER_HEADER_OID	NUMBER NULL,
	DOCUMENT_TYPE	VARCHAR2(40) NULL,
	OMS_TAX	NUMBER NULL,
	SUBJECT_OID	NUMBER NULL,
	CANCEL_COMMENT	VARCHAR2(300) NULL,
	SHUTTERFLY_NOTE_ELIGIBLE	CHAR(1) NULL,
	REPLAYED_WOB	VARCHAR2(40) NULL,
	ODI_ORIGIN		VARCHAR2(100 CHAR) NULL,
	ODI_CONS_NAME	VARCHAR2(35 CHAR) NULL,
	ODI_CONS_TYPE		VARCHAR2(2 CHAR) NULL,
	ODI_PK			VARCHAR2(32 CHAR) PRIMARY KEY,
	ODI_SESS_NO		VARCHAR2(19 CHAR)
)



&


/*-----------------------------------------------*/
/* TASK No. 56 */
/* delete previous errors */

delete from 	RAX_APP_USER.E$_ORDER_HEADER
where	(ODI_ERR_TYPE = 'S'	and 'F' = 'S')
or	(ODI_ERR_TYPE = 'F'	and ODI_ORIGIN = '(19300)ODS_Project.LOAD_ORDER_HEADER_INT')


&


/*-----------------------------------------------*/
/* TASK No. 57 */
/* Create index on PK */

 
/* FLOW CONTROL CREATE THE iNDEX ON THE I$TABLE */
BEGIN  
   EXECUTE IMMEDIATE 'create index 	RAX_APP_USER.I$_ORDER_HEADER_IDX on	RAX_APP_USER.I$_ORDER_HEADER (ORDER_HEADER_OID)';  
EXCEPTION  
   WHEN OTHERS THEN  
      IF SQLCODE != -955 and SQLCODE != -01408 THEN  
         RAISE;  
      END IF;  
END;


&


/*-----------------------------------------------*/
/* TASK No. 58 */
/* insert PK errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_ORIGIN,
	ODI_CHECK_DATE,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15064: The primary key ORDER_HEADER_PK is not unique.',
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	sysdate,
	'ORDER_HEADER_PK',
	'PK',	
	ORDER_HEADER.ORDER_HEADER_OID,
	ORDER_HEADER.ORDER_NO,
	ORDER_HEADER.ORDER_FORM_ID,
	ORDER_HEADER.MATCHED_CAPTURE_SESSION_ID,
	ORDER_HEADER.EVENT_REF_ID,
	ORDER_HEADER.BATCH_ID,
	ORDER_HEADER.TOTAL_AMOUNT,
	ORDER_HEADER.APO_OID,
	ORDER_HEADER.ORDER_TYPE_OID,
	ORDER_HEADER.ORDER_CHANNEL_OID,
	ORDER_HEADER.PRICE_PROGRAM_OID,
	ORDER_HEADER.EVENT_OID,
	ORDER_HEADER.SHIP_NODE,
	ORDER_HEADER.DRAFT_ORDER_FLAG,
	ORDER_HEADER.HOLD_FLAG,
	ORDER_HEADER.HOLD_REASON_CODE,
	ORDER_HEADER.INVOICE_COMPLETE,
	ORDER_HEADER.IS_SHIP_COMPLETE,
	ORDER_HEADER.ORDER_CLOSED,
	ORDER_HEADER.ORDER_DATE,
	ORDER_HEADER.ORDER_TYPE,
	ORDER_HEADER.PAYMENT_STATUS,
	ORDER_HEADER.TAX,
	ORDER_HEADER.TAX_EXEMPTION_CERTIFICATE,
	ORDER_HEADER.TAX_EXEMPT_FLAG,
	ORDER_HEADER.TAX_JURISDICTION,
	ORDER_HEADER.SHIP_ORDERS_TO,
	ORDER_HEADER.ODS_CREATE_DATE,
	ORDER_HEADER.ODS_MODIFY_DATE,
	ORDER_HEADER.SOURCE_SYSTEM_OID,
	ORDER_HEADER.CURRENCY,
	ORDER_HEADER.TERRITORY_CODE,
	ORDER_HEADER.PERSON_INFO_OID,
	ORDER_HEADER.LAST_USER_MODIFIED_DATE,
	ORDER_HEADER.REQUESTED_DELIVERY_DATE,
	ORDER_HEADER.SCAC,
	ORDER_HEADER.CARRIER_SERVICE_CODE,
	ORDER_HEADER.REQUESTED_SHIP_DATE,
	ORDER_HEADER.SUBJECT_FIRST_NAME,
	ORDER_HEADER.SUBJECT_MIDDLE_NAME,
	ORDER_HEADER.SUBJECT_LAST_NAME,
	ORDER_HEADER.SUBJECT_GRADE,
	ORDER_HEADER.RETAKE_NO,
	ORDER_HEADER.PARENT_RETAKE_NO,
	ORDER_HEADER.DONT_RELEASE_UNTIL_DATE,
	ORDER_HEADER.ORDER_STATUS,
	ORDER_HEADER.BATCHING_REQUIRED,
	ORDER_HEADER.CUSTOMER_EMAILID,
	ORDER_HEADER.OMS_CREATETS,
	ORDER_HEADER.CUSTOMER_PO_NO,
	ORDER_HEADER.BILL_TO_PERSON_INFO_OID,
	ORDER_HEADER.SHIP_TO_PERSON_INFO_OID,
	ORDER_HEADER.ORDER_STATUS_OID,
	ORDER_HEADER.PARENT_ORDER_HEADER_OID,
	ORDER_HEADER.DOCUMENT_TYPE,
	ORDER_HEADER.OMS_TAX,
	ORDER_HEADER.CANCEL_COMMENT,
	ORDER_HEADER.SHUTTERFLY_NOTE_ELIGIBLE,
	ORDER_HEADER.REPLAYED_WOB
from	RAX_APP_USER.I$_ORDER_HEADER   ORDER_HEADER
where	exists  (
		select	SUB.ORDER_HEADER_OID
		from 	RAX_APP_USER.I$_ORDER_HEADER SUB
		where 	SUB.ORDER_HEADER_OID=ORDER_HEADER.ORDER_HEADER_OID
		group by 	SUB.ORDER_HEADER_OID
		having 	count(1) > 1
		)



&


/*-----------------------------------------------*/
/* TASK No. 59 */
/* insert FK errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15065: Join error (OH_PERSON_INFO) between the table ORDER_HEADER and the table PERSON_INFO.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'OH_PERSON_INFO',
	'FK',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB

from	RAX_APP_USER.I$_ORDER_HEADER ORDER_HEADER 
where 	(
		ORDER_HEADER.PERSON_INFO_OID 
	) not in 	(
		select 	PERSON_INFO_OID
		from 	ODS_OWN.PERSON_INFO
		)
and	(
		ORDER_HEADER.PERSON_INFO_OID is not null 
	)




&


/*-----------------------------------------------*/
/* TASK No. 60 */
/* insert FK errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15065: Join error (OH_APO) between the table ORDER_HEADER and the table APO.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'OH_APO',
	'FK',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB

from	RAX_APP_USER.I$_ORDER_HEADER ORDER_HEADER 
where 	(
		ORDER_HEADER.APO_OID 
	) not in 	(
		select 	APO_OID
		from 	ODS_OWN.APO
		)
and	(
		ORDER_HEADER.APO_OID is not null 
	)




&


/*-----------------------------------------------*/
/* TASK No. 61 */
/* insert FK errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15065: Join error (OH_EVENT) between the table ORDER_HEADER and the table EVENT.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'OH_EVENT',
	'FK',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB

from	RAX_APP_USER.I$_ORDER_HEADER ORDER_HEADER 
where 	(
		ORDER_HEADER.EVENT_OID 
	) not in 	(
		select 	EVENT_OID
		from 	ODS_OWN.EVENT
		)
and	(
		ORDER_HEADER.EVENT_OID is not null 
	)




&


/*-----------------------------------------------*/
/* TASK No. 62 */
/* insert FK errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15065: Join error (OH_ORDER_CHANNEL) between the table ORDER_HEADER and the table ORDER_CHANNEL.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'OH_ORDER_CHANNEL',
	'FK',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB

from	RAX_APP_USER.I$_ORDER_HEADER ORDER_HEADER 
where 	(
		ORDER_HEADER.ORDER_CHANNEL_OID 
	) not in 	(
		select 	ORDER_CHANNEL_OID
		from 	ODS_OWN.ORDER_CHANNEL
		)
and	(
		ORDER_HEADER.ORDER_CHANNEL_OID is not null 
	)




&


/*-----------------------------------------------*/
/* TASK No. 63 */
/* insert FK errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15065: Join error (OH_ORDER_TYPE) between the table ORDER_HEADER and the table ORDER_TYPE.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'OH_ORDER_TYPE',
	'FK',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB

from	RAX_APP_USER.I$_ORDER_HEADER ORDER_HEADER 
where 	(
		ORDER_HEADER.ORDER_TYPE_OID 
	) not in 	(
		select 	ORDER_TYPE_OID
		from 	ODS_OWN.ORDER_TYPE
		)
and	(
		ORDER_HEADER.ORDER_TYPE_OID is not null 
	)




&


/*-----------------------------------------------*/
/* TASK No. 64 */
/* insert FK errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15065: Join error (OH_PRICE_PROGRAM) between the table ORDER_HEADER and the table PRICE_PROGRAM.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'OH_PRICE_PROGRAM',
	'FK',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB

from	RAX_APP_USER.I$_ORDER_HEADER ORDER_HEADER 
where 	(
		ORDER_HEADER.PRICE_PROGRAM_OID 
	) not in 	(
		select 	PRICE_PROGRAM_OID
		from 	ODS_OWN.PRICE_PROGRAM
		)
and	(
		ORDER_HEADER.PRICE_PROGRAM_OID is not null 
	)




&


/*-----------------------------------------------*/
/* TASK No. 65 */
/* insert Not Null errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select
	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15066: The column ORDER_HEADER_OID cannot be null.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'ORDER_HEADER_OID',
	'NN',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
from	RAX_APP_USER.I$_ORDER_HEADER
where	ORDER_HEADER_OID is null



&


/*-----------------------------------------------*/
/* TASK No. 66 */
/* insert Not Null errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select
	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15066: The column ORDER_NO cannot be null.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'ORDER_NO',
	'NN',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
from	RAX_APP_USER.I$_ORDER_HEADER
where	ORDER_NO is null



&


/*-----------------------------------------------*/
/* TASK No. 67 */
/* insert Not Null errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select
	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15066: The column APO_OID cannot be null.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'APO_OID',
	'NN',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
from	RAX_APP_USER.I$_ORDER_HEADER
where	APO_OID is null



&


/*-----------------------------------------------*/
/* TASK No. 68 */
/* insert Not Null errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select
	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15066: The column EVENT_OID cannot be null.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'EVENT_OID',
	'NN',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
from	RAX_APP_USER.I$_ORDER_HEADER
where	EVENT_OID is null



&


/*-----------------------------------------------*/
/* TASK No. 69 */
/* insert Not Null errors */

insert into RAX_APP_USER.E$_ORDER_HEADER
(
	ODI_PK,
	ODI_SESS_NO,
	ODI_ROW_ID,
	ODI_ERR_TYPE,
	ODI_ERR_MESS,
	ODI_CHECK_DATE,
	ODI_ORIGIN,
	ODI_CONS_NAME,
	ODI_CONS_TYPE,
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
)
select
	SYS_GUID(),
	:v_sess_no, 
	rowid,
	'F', 
	'ODI-15066: The column PERSON_INFO_OID cannot be null.',
	sysdate,
	'(19300)ODS_Project.LOAD_ORDER_HEADER_INT',
	'PERSON_INFO_OID',
	'NN',	
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	ODS_CREATE_DATE,
	ODS_MODIFY_DATE,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
from	RAX_APP_USER.I$_ORDER_HEADER
where	PERSON_INFO_OID is null



&


/*-----------------------------------------------*/
/* TASK No. 70 */
/* create index on error table */

 
/* FLOW CONTROL CREATE INDEX ON THE E$TABLE */
create index 	RAX_APP_USER.E$_ORDER_HEADER_IDX
on	RAX_APP_USER.E$_ORDER_HEADER (ODI_ROW_ID)


&


/*-----------------------------------------------*/
/* TASK No. 71 */
/* delete errors from controlled table */

delete from	RAX_APP_USER.I$_ORDER_HEADER  T
where	exists 	(
		select	1
		from	RAX_APP_USER.E$_ORDER_HEADER E
		where ODI_SESS_NO = :v_sess_no
		and T.rowid = E.ODI_ROW_ID
		)


&


/*-----------------------------------------------*/
/* TASK No. 72 */
/* insert check sum into check table */

insert into RAX_APP_USER.SNP_CHECK_TAB
(
	SCHEMA_NAME,
	RESOURCE_NAME,
	FULL_RES_NAME,
	ERR_TYPE,
	ERR_MESS,
	CHECK_DATE,
	ORIGIN,
	CONS_NAME,
	CONS_TYPE,
	ERR_COUNT
)
select	
	'ODS_OWN',
	'ORDER_HEADER',
	'ODS_OWN.ORDER_HEADER',
	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE,
	count(1) 
from	RAX_APP_USER.E$_ORDER_HEADER E
where	E.ODI_ERR_TYPE	= 'F'
and	E.ODI_ORIGIN 	= '(19300)ODS_Project.LOAD_ORDER_HEADER_INT'
group by	E.ODI_ERR_TYPE,
	E.ODI_ERR_MESS,
	E.ODI_CHECK_DATE,
	E.ODI_ORIGIN,
	E.ODI_CONS_NAME,
	E.ODI_CONS_TYPE


&


/*-----------------------------------------------*/
/* TASK No. 73 */
/* Flag rows for update */

/* DETECTION_STRATEGY = NOT_EXISTS */


update	RAX_APP_USER.I$_ORDER_HEADER
set	IND_UPDATE = 'U'
where	(ORDER_HEADER_OID)
	in	(
		select	ORDER_HEADER_OID
		from	ODS_OWN.ORDER_HEADER
		)



&


/*-----------------------------------------------*/
/* TASK No. 74 */
/* Flag useless rows */

/* DETECTION_STRATEGY = NOT_EXISTS */

/* Command skipped due to chosen DETECTION_STRATEGY */



/*-----------------------------------------------*/
/* TASK No. 75 */
/* Update existing rows */

/* DETECTION_STRATEGY = NOT_EXISTS */
update	ODS_OWN.ORDER_HEADER T
set 	
	(
	T.ORDER_NO,
	T.ORDER_FORM_ID,
	T.MATCHED_CAPTURE_SESSION_ID,
	T.EVENT_REF_ID,
	T.BATCH_ID,
	T.TOTAL_AMOUNT,
	T.APO_OID,
	T.ORDER_TYPE_OID,
	T.ORDER_CHANNEL_OID,
	T.PRICE_PROGRAM_OID,
	T.EVENT_OID,
	T.SHIP_NODE,
	T.DRAFT_ORDER_FLAG,
	T.HOLD_FLAG,
	T.HOLD_REASON_CODE,
	T.INVOICE_COMPLETE,
	T.IS_SHIP_COMPLETE,
	T.ORDER_CLOSED,
	T.ORDER_DATE,
	T.ORDER_TYPE,
	T.PAYMENT_STATUS,
	T.TAX,
	T.TAX_EXEMPTION_CERTIFICATE,
	T.TAX_EXEMPT_FLAG,
	T.TAX_JURISDICTION,
	T.SHIP_ORDERS_TO,
	T.SOURCE_SYSTEM_OID,
	T.CURRENCY,
	T.TERRITORY_CODE,
	T.PERSON_INFO_OID,
	T.LAST_USER_MODIFIED_DATE,
	T.REQUESTED_DELIVERY_DATE,
	T.SCAC,
	T.CARRIER_SERVICE_CODE,
	T.REQUESTED_SHIP_DATE,
	T.SUBJECT_FIRST_NAME,
	T.SUBJECT_MIDDLE_NAME,
	T.SUBJECT_LAST_NAME,
	T.SUBJECT_GRADE,
	T.RETAKE_NO,
	T.PARENT_RETAKE_NO,
	T.DONT_RELEASE_UNTIL_DATE,
	T.ORDER_STATUS,
	T.BATCHING_REQUIRED,
	T.CUSTOMER_EMAILID,
	T.OMS_CREATETS,
	T.CUSTOMER_PO_NO,
	T.BILL_TO_PERSON_INFO_OID,
	T.SHIP_TO_PERSON_INFO_OID,
	T.ORDER_STATUS_OID,
	T.PARENT_ORDER_HEADER_OID,
	T.DOCUMENT_TYPE,
	T.OMS_TAX,
	T.CANCEL_COMMENT,
	T.SHUTTERFLY_NOTE_ELIGIBLE,
	T.REPLAYED_WOB
	) =
		(
		select	S.ORDER_NO,
			S.ORDER_FORM_ID,
			S.MATCHED_CAPTURE_SESSION_ID,
			S.EVENT_REF_ID,
			S.BATCH_ID,
			S.TOTAL_AMOUNT,
			S.APO_OID,
			S.ORDER_TYPE_OID,
			S.ORDER_CHANNEL_OID,
			S.PRICE_PROGRAM_OID,
			S.EVENT_OID,
			S.SHIP_NODE,
			S.DRAFT_ORDER_FLAG,
			S.HOLD_FLAG,
			S.HOLD_REASON_CODE,
			S.INVOICE_COMPLETE,
			S.IS_SHIP_COMPLETE,
			S.ORDER_CLOSED,
			S.ORDER_DATE,
			S.ORDER_TYPE,
			S.PAYMENT_STATUS,
			S.TAX,
			S.TAX_EXEMPTION_CERTIFICATE,
			S.TAX_EXEMPT_FLAG,
			S.TAX_JURISDICTION,
			S.SHIP_ORDERS_TO,
			S.SOURCE_SYSTEM_OID,
			S.CURRENCY,
			S.TERRITORY_CODE,
			S.PERSON_INFO_OID,
			S.LAST_USER_MODIFIED_DATE,
			S.REQUESTED_DELIVERY_DATE,
			S.SCAC,
			S.CARRIER_SERVICE_CODE,
			S.REQUESTED_SHIP_DATE,
			S.SUBJECT_FIRST_NAME,
			S.SUBJECT_MIDDLE_NAME,
			S.SUBJECT_LAST_NAME,
			S.SUBJECT_GRADE,
			S.RETAKE_NO,
			S.PARENT_RETAKE_NO,
			S.DONT_RELEASE_UNTIL_DATE,
			S.ORDER_STATUS,
			S.BATCHING_REQUIRED,
			S.CUSTOMER_EMAILID,
			S.OMS_CREATETS,
			S.CUSTOMER_PO_NO,
			S.BILL_TO_PERSON_INFO_OID,
			S.SHIP_TO_PERSON_INFO_OID,
			S.ORDER_STATUS_OID,
			S.PARENT_ORDER_HEADER_OID,
			S.DOCUMENT_TYPE,
			S.OMS_TAX,
			S.CANCEL_COMMENT,
			S.SHUTTERFLY_NOTE_ELIGIBLE,
			S.REPLAYED_WOB
		from	RAX_APP_USER.I$_ORDER_HEADER S
		where	T.ORDER_HEADER_OID	=S.ORDER_HEADER_OID
	    	 )
	,                                                        T.ODS_MODIFY_DATE = SYSDATE

where	(ORDER_HEADER_OID)
	in	(
		select	ORDER_HEADER_OID
		from	RAX_APP_USER.I$_ORDER_HEADER
		where	IND_UPDATE = 'U'
		)




&


/*-----------------------------------------------*/
/* TASK No. 76 */
/* Insert new rows */

/* DETECTION_STRATEGY = NOT_EXISTS */
insert into 	ODS_OWN.ORDER_HEADER T
	(
	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
	,                                                         ODS_CREATE_DATE,
	ODS_MODIFY_DATE
	)
select 	ORDER_HEADER_OID,
	ORDER_NO,
	ORDER_FORM_ID,
	MATCHED_CAPTURE_SESSION_ID,
	EVENT_REF_ID,
	BATCH_ID,
	TOTAL_AMOUNT,
	APO_OID,
	ORDER_TYPE_OID,
	ORDER_CHANNEL_OID,
	PRICE_PROGRAM_OID,
	EVENT_OID,
	SHIP_NODE,
	DRAFT_ORDER_FLAG,
	HOLD_FLAG,
	HOLD_REASON_CODE,
	INVOICE_COMPLETE,
	IS_SHIP_COMPLETE,
	ORDER_CLOSED,
	ORDER_DATE,
	ORDER_TYPE,
	PAYMENT_STATUS,
	TAX,
	TAX_EXEMPTION_CERTIFICATE,
	TAX_EXEMPT_FLAG,
	TAX_JURISDICTION,
	SHIP_ORDERS_TO,
	SOURCE_SYSTEM_OID,
	CURRENCY,
	TERRITORY_CODE,
	PERSON_INFO_OID,
	LAST_USER_MODIFIED_DATE,
	REQUESTED_DELIVERY_DATE,
	SCAC,
	CARRIER_SERVICE_CODE,
	REQUESTED_SHIP_DATE,
	SUBJECT_FIRST_NAME,
	SUBJECT_MIDDLE_NAME,
	SUBJECT_LAST_NAME,
	SUBJECT_GRADE,
	RETAKE_NO,
	PARENT_RETAKE_NO,
	DONT_RELEASE_UNTIL_DATE,
	ORDER_STATUS,
	BATCHING_REQUIRED,
	CUSTOMER_EMAILID,
	OMS_CREATETS,
	CUSTOMER_PO_NO,
	BILL_TO_PERSON_INFO_OID,
	SHIP_TO_PERSON_INFO_OID,
	ORDER_STATUS_OID,
	PARENT_ORDER_HEADER_OID,
	DOCUMENT_TYPE,
	OMS_TAX,
	CANCEL_COMMENT,
	SHUTTERFLY_NOTE_ELIGIBLE,
	REPLAYED_WOB
	,                                                         SYSDATE,
	SYSDATE
from	RAX_APP_USER.I$_ORDER_HEADER S



where	IND_UPDATE = 'I'



&


/*-----------------------------------------------*/
/* TASK No. 77 */
/* Commit transaction */

/*commit*/


/*-----------------------------------------------*/
/* TASK No. 78 */
/* Drop flow table */

drop table RAX_APP_USER.I$_ORDER_HEADER 

&


/*-----------------------------------------------*/
/* TASK No. 79 */
/* Update CDC Load Status */

UPDATE ODS_OWN.ODS_CDC_LOAD_STATUS
SET LAST_CDC_COMPLETION_DATE=TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
+ nvl((TIMEZONE_OFFSET/24), 0) 
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env

/*
UPDATE ODS_OWN.ODS_CDC_LOAD_STATUS
SET LAST_CDC_COMPLETION_DATE=TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env
*/

&


/*-----------------------------------------------*/
/* TASK No. 80 */
/* Insert CDC Audit Record */

INSERT INTO RAX_APP_USER.ODS_CDC_LOAD_STATUS_AUDIT
(TABLE_NAME,
SESS_NO,                      
SESS_NAME,                    
SCEN_VERSION,                 
SESS_BEG,                     
ORIG_LAST_CDC_COMPLETION_DATE,
OVERLAP,
CREATE_DATE,
CONTEXT_NAME,
TIMEZONE_OFFSET              
)
select 
:v_cdc_load_table_name
,:v_sess_no
,'LOAD_ORDER_HEADER_PKG'
,'047'
,TO_DATE(SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
,TO_DATE (SUBSTR(:v_cdc_load_date, 1, 19),'YYYY-MM-DD HH24:MI:SS')
,:v_cdc_overlap
,SYSDATE
,:v_env
,TIMEZONE_OFFSET
from 
ODS_OWN.ODS_CDC_LOAD_STATUS
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env

/*
INSERT INTO RAX_APP_USER.ODS_CDC_LOAD_STATUS_AUDIT
(TABLE_NAME,
SESS_NO,                      
SESS_NAME,                    
SCEN_VERSION,                 
SESS_BEG,                     
ORIG_LAST_CDC_COMPLETION_DATE,
OVERLAP,
CREATE_DATE,
CONTEXT_NAME              
)
values (
:v_cdc_load_table_name,
:v_sess_no,
'LOAD_ORDER_HEADER_PKG',
'047',
TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS'),
TO_DATE (SUBSTR (:v_cdc_load_date, 1, 19),
                           'YYYY-MM-DD HH24:MI:SS'
                          )
,:v_cdc_overlap,
SYSDATE,
 :v_env)
*/


&


/*-----------------------------------------------*/
/* TASK No. 81 */

/* NONE or SET VARIABLE STATEMENT FOUND, CHECK ODI TASK NO. 81 */




/*-----------------------------------------------*/
/* TASK No. 82 */
/* Update CDC Load Status */

UPDATE ODS_OWN.ODS_CDC_LOAD_STATUS
SET LAST_CDC_COMPLETION_DATE=TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
+ nvl((TIMEZONE_OFFSET/24), 0) 
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env

/*
UPDATE ODS_OWN.ODS_CDC_LOAD_STATUS
SET LAST_CDC_COMPLETION_DATE=TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env
*/

&


/*-----------------------------------------------*/
/* TASK No. 83 */
/* Insert CDC Audit Record */

INSERT INTO RAX_APP_USER.ODS_CDC_LOAD_STATUS_AUDIT
(TABLE_NAME,
SESS_NO,                      
SESS_NAME,                    
SCEN_VERSION,                 
SESS_BEG,                     
ORIG_LAST_CDC_COMPLETION_DATE,
OVERLAP,
CREATE_DATE,
CONTEXT_NAME,
TIMEZONE_OFFSET              
)
select 
:v_cdc_load_table_name
,:v_sess_no
,'LOAD_ORDER_HEADER_PKG'
,'047'
,TO_DATE(SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
,TO_DATE (SUBSTR(:v_cdc_load_date, 1, 19),'YYYY-MM-DD HH24:MI:SS')
,:v_cdc_overlap
,SYSDATE
,:v_env
,TIMEZONE_OFFSET
from 
ODS_OWN.ODS_CDC_LOAD_STATUS
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env

/*
INSERT INTO RAX_APP_USER.ODS_CDC_LOAD_STATUS_AUDIT
(TABLE_NAME,
SESS_NO,                      
SESS_NAME,                    
SCEN_VERSION,                 
SESS_BEG,                     
ORIG_LAST_CDC_COMPLETION_DATE,
OVERLAP,
CREATE_DATE,
CONTEXT_NAME              
)
values (
:v_cdc_load_table_name,
:v_sess_no,
'LOAD_ORDER_HEADER_PKG',
'047',
TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS'),
TO_DATE (SUBSTR (:v_cdc_load_date, 1, 19),
                           'YYYY-MM-DD HH24:MI:SS'
                          )
,:v_cdc_overlap,
SYSDATE,
 :v_env)
*/


&


/*-----------------------------------------------*/
/* TASK No. 84 */

/* NONE or SET VARIABLE STATEMENT FOUND, CHECK ODI TASK NO. 84 */




/*-----------------------------------------------*/
/* TASK No. 85 */
/* Update CDC Load Status */

UPDATE ODS_OWN.ODS_CDC_LOAD_STATUS
SET LAST_CDC_COMPLETION_DATE=TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
+ nvl((TIMEZONE_OFFSET/24), 0) 
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env

/*
UPDATE ODS_OWN.ODS_CDC_LOAD_STATUS
SET LAST_CDC_COMPLETION_DATE=TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env
*/

&


/*-----------------------------------------------*/
/* TASK No. 86 */
/* Insert CDC Audit Record */

INSERT INTO RAX_APP_USER.ODS_CDC_LOAD_STATUS_AUDIT
(TABLE_NAME,
SESS_NO,                      
SESS_NAME,                    
SCEN_VERSION,                 
SESS_BEG,                     
ORIG_LAST_CDC_COMPLETION_DATE,
OVERLAP,
CREATE_DATE,
CONTEXT_NAME,
TIMEZONE_OFFSET              
)
select 
:v_cdc_load_table_name
,:v_sess_no
,'LOAD_ORDER_HEADER_PKG'
,'047'
,TO_DATE(SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS')
,TO_DATE (SUBSTR(:v_cdc_load_date, 1, 19),'YYYY-MM-DD HH24:MI:SS')
,:v_cdc_overlap
,SYSDATE
,:v_env
,TIMEZONE_OFFSET
from 
ODS_OWN.ODS_CDC_LOAD_STATUS
WHERE ODS_TABLE_NAME=:v_cdc_load_table_name
AND CONTEXT_NAME = :v_env

/*
INSERT INTO RAX_APP_USER.ODS_CDC_LOAD_STATUS_AUDIT
(TABLE_NAME,
SESS_NO,                      
SESS_NAME,                    
SCEN_VERSION,                 
SESS_BEG,                     
ORIG_LAST_CDC_COMPLETION_DATE,
OVERLAP,
CREATE_DATE,
CONTEXT_NAME              
)
values (
:v_cdc_load_table_name,
:v_sess_no,
'LOAD_ORDER_HEADER_PKG',
'047',
TO_DATE(
             SUBSTR(:v_sess_beg, 1, 19), 'RRRR-MM-DD HH24:MI:SS'),
TO_DATE (SUBSTR (:v_cdc_load_date, 1, 19),
                           'YYYY-MM-DD HH24:MI:SS'
                          )
,:v_cdc_overlap,
SYSDATE,
 :v_env)
*/


&


/*-----------------------------------------------*/
