select
to_char(my_t2.CALENDAR_MONTH_BEGIN,'YYYYMMDD') CALENDAR_MONTH_BEGIN
 from
MART.TIME my_t
,MART.TIME my_t2
where (1=1) and my_t.DATE_KEY= trunc(sysdate)
and case when my_t.MONTH_NUMBER = 1 then 12 else my_t.MONTH_NUMBER -1 end = my_t2.MONTH_NUMBER
and case when my_t.MONTH_NUMBER = 1 then my_t.CALENDAR_YEAR -1 else my_t.CALENDAR_YEAR end  = my_t2.CALENDAR_YEAR
and my_t2.MONTH_DAY_NUMBER=1

select
to_char(my_t2.CALENDAR_MONTH_END,'YYYYMMDD') CALENDAR_MONTH_END
from
MART.TIME my_t
,MART.TIME my_t2
where (1=1) and my_t.DATE_KEY= trunc(sysdate)
and case when my_t.MONTH_NUMBER = 1 then 12 else my_t.MONTH_NUMBER -1 end = my_t2.MONTH_NUMBER
and case when my_t.MONTH_NUMBER = 1 then my_t.CALENDAR_YEAR -1 else my_t.CALENDAR_YEAR end  = my_t2.CALENDAR_YEAR
and my_t2.MONTH_DAY_NUMBER=1


select
	count(*)
from	RAX_APP_USER.POSTED_UNPOSTED_BATCHES   PB
where
	(1=1)
ORDER BY  SOURCE_SYSTEM
, PAYMENT_TYPE
, PAYMENT_DATE
, PAYMENT_ID
--COUNT(*)|
----------+
--      46|


--BEGIN_DATE,END_DATE,PAYMENT_TYPE,PAYMENT_ID,LAST_MODIFIED,LAST_MODIFIED_BY,DATE_CREATED,CREATED_BY,AMOUNT,PAYMENT_DATE,PAYMENT_BATCH_ID,CUSTOMER_ORDER_ID,PAYMENT_STATUS,JOB_NUMBER,CURRENCY_CODE,SOURCE_SYSTEM
--07/01/2024,07/31/2024,CASH,281140,07/04/2024,csp.sysadmin,07/04/2024,csp.sysadmin,104.68,07/05/2024,,128266,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281143,07/04/2024,csp.sysadmin,07/04/2024,csp.sysadmin,104.68,07/05/2024,,128273,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281147,07/04/2024,csp.sysadmin,07/04/2024,csp.sysadmin,163.53,07/05/2024,,128280,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281150,07/04/2024,csp.sysadmin,07/04/2024,csp.sysadmin,163.53,07/05/2024,,128285,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281223,07/04/2024,csp.sysadmin,07/04/2024,csp.sysadmin,32.55,07/05/2024,,128412,SUBMITTED,EVTDZ3ZJ4,USD,CSP
--07/01/2024,07/31/2024,CASH,281294,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,104.68,07/12/2024,,128582,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281299,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,104.68,07/12/2024,,128593,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281303,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,163.53,07/12/2024,,128598,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281306,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,163.53,07/12/2024,,128602,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281373,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,32.55,07/12/2024,,128744,SUBMITTED,EVTDZ3ZJ4,USD,CSP
--07/01/2024,07/31/2024,CASH,281412,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,8.51,07/12/2024,,128814,SUBMITTED,EVTHF84G9,USD,CSP
--07/01/2024,07/31/2024,CASH,281413,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,23.73,07/12/2024,,128821,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281414,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,12.93,07/12/2024,,128820,SUBMITTED,EVTZFX7W7,USD,CSP
--07/01/2024,07/31/2024,CASH,281441,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,104.68,07/12/2024,,128887,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281445,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,104.68,07/12/2024,,128898,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281449,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,163.53,07/13/2024,,128904,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281452,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,163.53,07/13/2024,,128910,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281515,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,32.55,07/13/2024,,129042,SUBMITTED,EVTDZ3ZJ4,USD,CSP
--07/01/2024,07/31/2024,CASH,281536,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,132.23,07/13/2024,,129094,SUBMITTED,EVTTNQV46,USD,CSP
--07/01/2024,07/31/2024,CASH,281537,07/11/2024,csp.sysadmin,07/11/2024,csp.sysadmin,11.94,07/13/2024,,129093,SUBMITTED,LN569029Q0,USD,CSP
--07/01/2024,07/31/2024,CASH,281562,07/12/2024,csp.sysadmin,07/12/2024,csp.sysadmin,104.68,07/13/2024,,129166,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281567,07/12/2024,csp.sysadmin,07/12/2024,csp.sysadmin,104.68,07/13/2024,,129175,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281573,07/12/2024,csp.sysadmin,07/12/2024,csp.sysadmin,163.53,07/13/2024,,129184,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281576,07/12/2024,csp.sysadmin,07/12/2024,csp.sysadmin,163.53,07/13/2024,,129188,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281644,07/12/2024,csp.sysadmin,07/12/2024,csp.sysadmin,32.55,07/13/2024,,129335,SUBMITTED,EVTDZ3ZJ4,USD,CSP
--07/01/2024,07/31/2024,CASH,281713,07/18/2024,csp.sysadmin,07/18/2024,csp.sysadmin,44.5,07/19/2024,,129463,SUBMITTED,EVT9W286Z,USD,CSP
--07/01/2024,07/31/2024,CASH,281714,07/18/2024,csp.sysadmin,07/18/2024,csp.sysadmin,32.55,07/19/2024,,129477,SUBMITTED,EVTDZ3ZJ4,USD,CSP
--07/01/2024,07/31/2024,CASH,281755,07/22/2024,csp.sysadmin,07/22/2024,csp.sysadmin,104.68,07/23/2024,,129561,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281760,07/22/2024,csp.sysadmin,07/22/2024,csp.sysadmin,104.68,07/23/2024,,129569,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281762,07/22/2024,csp.sysadmin,07/22/2024,csp.sysadmin,163.53,07/23/2024,,129579,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281767,07/22/2024,csp.sysadmin,07/22/2024,csp.sysadmin,163.53,07/23/2024,,129584,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281834,07/22/2024,csp.sysadmin,07/22/2024,csp.sysadmin,32.55,07/23/2024,,129731,SUBMITTED,EVTDZ3ZJ4,USD,CSP
--07/01/2024,07/31/2024,CASH,281885,07/24/2024,csp.sysadmin,07/24/2024,csp.sysadmin,43.17,07/25/2024,,129819,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281886,07/24/2024,csp.sysadmin,07/24/2024,csp.sysadmin,39.85,07/25/2024,,129820,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281892,07/24/2024,csp.sysadmin,07/24/2024,csp.sysadmin,213.41,07/25/2024,,129828,SUBMITTED,EVTKTZTGF,USD,CSP
--07/01/2024,07/31/2024,CASH,281923,07/25/2024,csp.sysadmin,07/25/2024,csp.sysadmin,104.68,07/26/2024,,129906,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281927,07/25/2024,csp.sysadmin,07/25/2024,csp.sysadmin,104.68,07/26/2024,,129910,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281932,07/25/2024,csp.sysadmin,07/25/2024,csp.sysadmin,163.53,07/26/2024,,129919,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CASH,281984,07/25/2024,csp.sysadmin,07/25/2024,csp.sysadmin,32.55,07/26/2024,,130030,SUBMITTED,EVTDZ3ZJ4,USD,CSP
--07/01/2024,07/31/2024,CHECK,281745,07/22/2024,csp.sysadmin,07/22/2024,csp.sysadmin,26.93,07/23/2024,,129538,SUBMITTED,EVT7R28G8,USD,CSP
--07/01/2024,07/31/2024,CHECK,281884,07/24/2024,csp.sysadmin,07/24/2024,csp.sysadmin,56.01,07/25/2024,,129818,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CHECK,281887,07/24/2024,csp.sysadmin,07/24/2024,csp.sysadmin,56.01,07/25/2024,,129821,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CHECK,281888,07/24/2024,csp.sysadmin,07/24/2024,csp.sysadmin,39.85,07/25/2024,,129822,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CHECK,281889,07/24/2024,csp.sysadmin,07/24/2024,csp.sysadmin,34.46,07/25/2024,,129823,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CHECK,281890,07/24/2024,csp.sysadmin,07/24/2024,csp.sysadmin,66.78,07/25/2024,,129824,SUBMITTED,EVTH49Z7F,USD,CSP
--07/01/2024,07/31/2024,CHECK,281891,07/24/2024,csp.sysadmin,07/24/2024,csp.sysadmin,141.91,07/25/2024,,129827,SUBMITTED,EVTKTZTGF,USD,CSP

select
	PB.BEGIN_DATE	   BEGIN_DATE,
	PB.END_DATE	   END_DATE,
	PB.JOB_NUMBER	   JOB_NUMBER,
	PB.TERRITORY_ACCOUNT_TYPE	   TERRITORY_ACCOUNT_TYPE,
	PB.AMT	   AMT,
	PB.DEPOSIT_DATE	   DEPOSIT_DATE,
	PB.BANK_ACCOUNT_CODE	   BANK_ACCOUNT_CODE,
	PB.SOURCE_SYSTEM	   SOURCE_SYSTEM,
	PB.VENDOR	   VENDOR,
	PB.ENTRY_TYPE	   ENTRY_TYPE,
	PB.ERROR_MESSAGE	   ERROR_MESSAGE,
	PB.POSTED_DATE	   POSTED_DATE
from	RAX_APP_USER.POSTED_BATCHES   PB
where
	(1=1)
ORDER BY  SOURCE_SYSTEM
, JOB_NUMBER
, DEPOSIT_DATE
, AMT