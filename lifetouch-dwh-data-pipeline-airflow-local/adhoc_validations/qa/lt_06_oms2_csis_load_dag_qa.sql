select * FROM ODS_STAGE.OMS2_LT_SUBJECT_APO_SESS_STG
ORDER BY ods_modify_date DESC FETCH FIRST 10 ROWS ONLY

--SESSION_KEY|SUBJECT_KEY            |APO_KEY                |SIT_TYPE|LOCATION|EXECUTION_DATE     |CREATETS           |MODIFYTS           |CREATEUSERID     |MODIFYUSERID|CREATEPROGID|MODIFYPROGID|LOCKID|ODS_CREATE_DATE    |ODS_MODIFY_DATE    |
-------------+-----------------------+-----------------------+--------+--------+-------------------+-------------------+-------------------+-----------------+------------+------------+------------+------+-------------------+-------------------+
--112990536  |20240906004243527640186|20240906003917527638074|        |        |2024-09-06 00:00:00|2024-09-06 00:47:09|2024-09-06 00:51:20|CUSTOM           |spec.dev-all|CUSTOM      |Console     |     1|2024-09-06 01:43:01|2024-09-06 01:43:01|
--112990544  |20240906004409527640201|20240906003917527638074|        |        |2024-09-06 00:00:00|2024-09-06 00:47:09|2024-09-06 00:51:55|CUSTOM           |spec.dev-all|CUSTOM      |Console     |     1|2024-09-06 01:43:01|2024-09-06 01:43:01|
--112981196  |20240508111748514224069|20240417045650511909520|        |        |2024-09-16 00:00:00|2024-05-23 12:18:16|2024-09-05 06:03:39|BurnsvilleProShip|spec.dev-all|            |Console     |     1|2024-05-23 12:39:13|2024-09-05 07:37:34|
--112826771  |20230404152511466941062|20230404122120466929302|        |        |2024-09-16 00:00:00|2023-04-05 15:09:02|2024-09-05 03:52:05|BurnsvilleProShip|spec.dev-all|            |Console     |     1|2023-04-05 15:58:41|2024-09-05 04:43:51|
--112981030  |20240508111747514223973|20240417045650511909520|        |        |2024-09-16 00:00:00|2024-05-23 12:18:16|2024-09-05 04:09:38|BurnsvilleProShip|spec.dev-all|            |Console     |     1|2024-05-23 12:39:13|2024-09-05 04:43:51|
--112826318  |20230404151721466940931|20230404121453466927131|        |        |2500-02-07 00:00:00|2023-04-05 10:43:15|2024-09-05 01:16:03|BurnsvilleProShip|spec.dev-all|            |Console     |     1|2023-04-05 10:45:36|2024-09-05 01:42:54|
--112950654  |20230508092629470898391|20230505120921470567491|        |        |2500-02-07 00:00:00|2023-05-08 09:47:12|2024-09-05 01:27:34|BurnsvilleProShip|spec.dev-all|            |Console     |     1|2023-05-08 10:40:34|2024-09-05 01:42:54|
--112990528  |20240830110428527251306|20240830110030527251294|        |        |2024-08-30 00:00:00|2024-08-30 11:06:40|2024-08-30 11:08:55|CUSTOM           |spec.dev-all|CUSTOM      |Console     |     1|2024-08-30 11:38:46|2024-08-30 11:38:46|
--112990502  |20240828145408527024043|20240828144453527023918|        |        |2024-08-28 00:00:00|2024-08-28 14:55:38|2024-08-28 14:57:33|CUSTOM           |spec.dev-all|CUSTOM      |Console     |     1|2024-08-28 15:40:07|2024-08-28 15:40:07|
--112990510  |20240828150431527027767|20240828145844527024078|        |        |2024-08-28 00:00:00|2024-08-28 15:11:29|2024-08-28 15:15:11|CUSTOM           |spec.dev-all|CUSTOM      |Console     |     1|2024-08-28 15:40:07|2024-08-28 15:40:07|


select * FROM ODS_STAGE.OMS2_LT_SUBJECT_APO_SESS_STG WHERE SESSION_KEY = '112990536'
--SESSION_KEY|SUBJECT_KEY            |APO_KEY                |SIT_TYPE|LOCATION|EXECUTION_DATE     |CREATETS           |MODIFYTS           |CREATEUSERID|MODIFYUSERID|CREATEPROGID|MODIFYPROGID|LOCKID|ODS_CREATE_DATE    |ODS_MODIFY_DATE    |
-------------+-----------------------+-----------------------+--------+--------+-------------------+-------------------+-------------------+------------+------------+------------+------------+------+-------------------+-------------------+
--112990536  |20240906004243527640186|20240906003917527638074|        |        |2024-09-06 00:00:00|2024-09-06 00:47:09|2024-09-06 00:51:20|CUSTOM      |spec.dev-all|CUSTOM      |Console     |     1|2024-09-06 01:43:01|2024-09-06 01:43:01|

delete FROM ODS_STAGE.OMS2_LT_SUBJECT_APO_SESS_STG WHERE SESSION_KEY = '112990536'

UPDATE ods_own.ods_cdc_load_status
SET last_cdc_completion_date = TO_DATE(SUBSTR('2024-09-01 00:00:00', 1, 19), 'YYYY-MM-DD HH24:MI:SS')
WHERE ods_table_name= 'OMS2_LT_SUBJECT_APO_SESS_STG'


-- run the dag

select * FROM ODS_STAGE.OMS2_LT_SUBJECT_APO_SESS_STG WHERE SESSION_KEY = '112990536'
--SESSION_KEY|SUBJECT_KEY            |APO_KEY                |SIT_TYPE|LOCATION|EXECUTION_DATE     |CREATETS           |MODIFYTS           |CREATEUSERID|MODIFYUSERID|CREATEPROGID|MODIFYPROGID|LOCKID|ODS_CREATE_DATE    |ODS_MODIFY_DATE    |
-------------+-----------------------+-----------------------+--------+--------+-------------------+-------------------+-------------------+------------+------------+------------+------------+------+-------------------+-------------------+
--112990536  |20240906004243527640186|20240906003917527638074|        |        |2024-09-06 00:00:00|2024-09-06 00:47:09|2024-09-06 00:51:20|CUSTOM      |spec.dev-all|CUSTOM      |Console     |     1|2024-09-17 05:14:28|2024-09-17 05:14:28|